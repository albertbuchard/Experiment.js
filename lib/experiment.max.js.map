{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 3bc8620d376b122a822b","webpack:///./src/framework/utilities.js","webpack:///external {\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\",\"root\":\"_\"}","webpack:///./~/bluebird/js/browser/bluebird.js","webpack:///./src/framework/EventData.js","webpack:///external {\"commonjs\":\"experiment-babylon-js\",\"commonjs2\":\"experiment-babylon-js\",\"amd\":\"experiment-babylon-js\",\"root\":\"BABYLON\"}","webpack:///./src/framework/DataManager.js","webpack:///./src/framework/RessourceManager.js","webpack:///./src/framework/State.js","webpack:///external {\"commonjs\":\"jQuery\",\"commonjs2\":\"jQuery\",\"amd\":\"jQuery\",\"root\":\"jQuery\"}","webpack:///./src/framework/StateManager.js","webpack:///./~/process/browser.js","webpack:///(webpack)/buildin/global.js","webpack:///external {\"commonjs\":\"experiment-boxes\",\"commonjs2\":\"experiment-boxes\",\"amd\":\"experiment-boxes\",\"root\":\"experimentBoxes\"}","webpack:///external {\"commonjs\":\"experiment-mathjs\",\"commonjs2\":\"experiment-mathjs\",\"amd\":\"experiment-mathjs\",\"root\":\"math\"}","webpack:///./src/framework/TaskObject.js","webpack:///./src/framework/objects/Loader.js","webpack:///./builder.js","webpack:///./src/config.js","webpack:///./~/js-yaml/dist/js-yaml.js","webpack:///./~/setimmediate/setImmediate.js","webpack:///./~/timers-browserify/main.js"],"names":["config","warnings","longStackTraces","cancellation","monitoring","noop","debuglog","console","log","bind","debugWarn","warn","debugError","error","mandatory","param","Error","mustBeDefined","args","i","length","spreadToObject","object","defaultValue","TargetClass","constructor","Array","mustHaveConstructor","constructorObject","allHaveConstructor","hasConstructor","looksLikeAPromise","o","then","catch","delay","ms","resolve","setTimeout","jitter","min","max","randomDuration","random","recurse","promiseGenerator","amount","target","concatOnArray","next","apply","r","concat","Deferred","reject","resolved","rejected","pending","status","promise","data","e","rep","content","count","result","samplePermutation","sequence","repetition","n","copy","slice","permutation","add","index","Math","floor","splice","preloadImages","imgArray","promiseArray","images","image","String","deferred","img","Image","src","push","complete","addEventListener","all","matrix","rows","cols","fill","matrixObject","j","getRow","rowIndex","size","row","subset","range","rowSum","rowSumArray","sum","diag","setTo","diagonalValues","sizeToVec","Size","Vector2","width","height","scaleSize","scale","floatScale","parseFloat","isNaN","getQueryString","queryString","query","window","location","search","substring","vars","split","pair","decodeURIComponent","arr","Number","prototype","boundTo","indicesOf","needle","haystack","indices","substr","hasNeighbouringRepeat","previousElement","toCsv","lineArray","forEach","array","line","join","csvContent","uniqueValues","u","a","hasOwnProperty","minValue","NaN","maxValue","multisplice","sort","b","spliced","getXY","x","xyArray","y","average","type","windowAverages","endIndex","windowArray","bins","position","undefined","total","integrate","cumulativeArray","equals","value","resultVector","l","ntrue","resultSum","nEquals","exclude","values","addit","includes","Set","indexOf","Object","defineProperty","observe","attribute","lookForValue","rate","checkForValue","enumerable","isSuperset","elem","has","union","setB","sample","repeat","from","unite","intersection","intersect","remove","difference","delete","EventData","flag","happenedAt","timeInMs","BASE_DATA_FIELDS","belongsTo","handledAt","storedAt","extend","forState","toStore","handled","stored","dataKeys","keys","JSON","stringify","specificData","Date","getTime","DataManager","parent","subjectID","_parent","_subjectID","automaticID","VALUE_FOR_NA","FLAG_EVENT_NOFLAG","logs","dataTables","tablesLastIndex","toPush","waitForPush","GLOBAL_LOG_FIELDS","addTable","INTERFACE_REST","INTERFACE_GRAPHQL","INTERFACE_WEBSOCKET","QUERY_LOGIN","QUERY_ADD","QUERY_GET_CHECKPOINT","QUERY_SET_CHECKPOINT","MAX_NUMBER_OF_RETRY","useLocalStorageCredentials","connections","addRate","loginDeferred","isCurrentlySigningIn","authorize_manual_login","isNode","module","exports","name","fields","id","tableNames","toDataObject","isValidRows","columnNamesRows","columnNamesDataTableWithoutId","generateIds","field","firstField","nrows","prepareToPush","numberOfIds","startId","emptyTable","columnNamesDataTable","previousLenght","newLenght","dataObject","numRows","dataArray","format","hasTable","toDataArray","restURL","formGenerator","message","form","Function","userId","constraints","authorizedValues","title","password","options","html","prepend","buttonText","connection","variables","login","errorMessage","lastErrorMessage","formDeferred","signInForm","credentials","interface","ajax","url","endpoint","contentType","done","loggedIn","local","fail","xhr","json","responseJSON","tooMuchTry","modal","shouldLog","variable","localStorage","parse","names","pushDeferred","table","returned","dataTable","fieldNames","lastIndex","toPushSize","pushed","checkIfPushed","getStagedData","defaultVariables","checkpoint","QUERY_CHECKPOINT","_globalLog","globalLog","_customNextID","yaml","require","RessourceManager","defaultLanguage","currentLanguage","overwrite","useAjax","filepaths","addFiles","concatFilepaths","files","promises","isOfValidFormat","getFormat","path","loaded","validated","added","raw","loadFile","fileIndex","deffered","thisObject","crossDomain","textStatus","jqXHR","parseRaw","file","parser","arg","csv","toObjects","DOMParser","parseFromString","ActiveXObject","async","loadXML","safeLoad","processParsed","addDataFamilly","familly","toAdd","toLowerCase","oldOverwrite","addByName","filepath","lastIndexOf","validFormats","ressourceManager","currentFamillies","famillies","mergingFamillies","lookFor","extended","deep","toString","call","merge","obj","prop","Proxy","get","pathString","lookForLanguage","lookForFamilly","lookForVariable","couldSwapForVariable","State","stateManager","stateKey","_stateManager","_dataManager","_eventFunctions","_nextEventFunctions","_awakeningFunctions","_endingFunctions","_updateFunctions","_frozenEvents","_frozenAt","FREEZE_DELAY","reload","stateWasUnfreezed","unfreeze","sceneKey","calledFunctions","method","context","_eventHeap","nextEvent","events","spliceEventsForState","handleEvent","event","hasEventFunction","eventFunctions","functionName","eventClone","cloneDeep","handlingFunction","stateHasFinishedHandlingEvent","eventFunction","eventFlag","handlingFunctions","key","except","baseOptions","f","keyCode","onNext","getAllEvents","stateWasFrozen","frozenEvents","addTimeTriggerEvent","addEvent","cycle","arrayName","registerEventFunctions","registerCycleFunctions","getGlobal","setGlobal","_taskObject","getContext","taskObject","dataManager","scene","state","R","StateManager","parentTaskObject","_timeTriggerEvents","errorLog","states","idle","pause","active","timestampThreshold","unfrozen","states_idle","states_active","states_pause","_currentStateKey","frozenState","globals","globalFunctions","toSplice","currentState","update","storedInErrorLog","addRows","formatted","storeInErrorLog","returnedStates","stateKeys","end","awake","Scene","canvasOptions","backgroundFill","Canvas2D","GetSolidColorBrush","Color4","backgroundRoundRadius","zOrder","GUI","ScreenSpaceCanvas2D","levelVisible","set","replace","spaced","text","fontName","duration","events_tooltipDismissed","background","fontColor","guiCanvas","brownColor","tooltips","tooltip","temptool","box","disposed","tempPosition","brush","defaultFontColor","nextPos","subtract","sizeDefault","fontSuperSample","fontSignedDistanceField","tooltipBox","Rectangle2D","tooltipText","Text2D","marginAlignment","hideTooltip","allTooltips","addDefaultDesign","pauseState","freeze","goToState","forcePause","unPause","keydown","registerEventFunction","events_pause","addDefaultPauseDesign","awakePause","pauseBackground2D","canvas","screenCanvas","customSized","roundRadius","children","endPause","registerAwakeningFunction","registerEndingFunction","emptyEventHeap","emptyTimeTriggerEvents","newEvent","events_unfrozen","time","eventOptions","values_timestampThreshold","without","byState","currentStateKey","storeEvent","eventHeapIsFrozen","frozenEventHeap","storeFrozenEvents","resolveOnKey","resolveOnClick","func","functions","registerGlobalFunction","results","recurseOnGlobalFunction","setDefault","scripts","document","getElementsByTagName","assetsFolderFullpath","delimiterIndices","TaskObject","assetsFolder","engine","_target","Engine","innerHeight","innerWidth","babylonCanvasHeight","babylonCanvasWidth","globalLogFields","taskStatusFields","statusFlagsFields","checkpointFields","ASSETS_FOLDER","ASSETS_FLARE_PATH","assetsToLoad","folders","flags","keyState","shouldShowDebug","DEBUG_MODE_ONE","setupGlobalEvents","currentModal","parameters","shouldSeeInformation","scenes","sceneGenerators","functionsOptions","loading","default2dSceneGenerator","loadingOptions","shouldLoadAssets","_currentSceneKey","_paramBox","sceneGenerator","clone","loadingSceneGenerator","registerSceneGenerator","sceneOptions","generator","functionKeys","callSceneGenerator","assets","assetsArray","_scene","Mesh","material","subMaterials","addMesh","assetObject","assetFolder","textureFormats","soundFormats","assetManager","AssetsManager","binaryPromises","assetManagerTask","addTextureTask","onSuccess","task","textures","textureName","texture","addBinaryFileTask","isReady","sounds","soundName","Sound","loadDeferred","load","onFinish","tasks","asset","cloneAssetsIntoScene","resize","loadingScene","loadingPromise","currentScene","flags_hasLoaded","runRenderLoop","render","generateScenes","hasLoaded","sceneStarts","sceneEnds","mouseMove","click","pick","keyup","windowFocus","windowBlur","wasHandled","beingHandled","modalDismissed","tooltipDismissed","evt","keyfunction","eventData","events_keydown","currentSceneObject","events_click","clientX","clientY","engineX","renderSize","engineY","events_resize","outerHeight","outerWidth","addEventToCurrentScene","updateContentFrame","checkFocus","events_windowBlur","hasFocus","events_windowFocus","visibilityChange","hidden","mozHidden","msHidden","webkitHidden","dCode","shiftCode","altCode","toggleDebugLayer","preventDefault","optionsBase","canvasBackground","clearColor","canvasPercentWidth","canvasPercentHeight","minWidth","NEGATIVE_INFINITY","minHeight","maxWidth","POSITIVE_INFINITY","maxHeight","getCanvasDimensions","noNull","pWidth","pHeight","addStateManager","camera","ArcRotateCamera","PI","Vector3","Zero","borderThickness","initialCanvas","initialCamera","lastResize","initialGui","addGuiCanvas","resizeAt","onResize","registerBeforeRender","setConnection","code","baseContext","extendWith","debugLayer","show","createCanvasProfileInfoCanvas","hide","_profilingCanvas","dispose","events_modalDismissed","dismissModal","modalBox","dismissed","callThenDestroy","property","to","frame","animation","Animation","ANIMATIONTYPE_FLOAT","ANIMATIONLOOPMODE_CONSTANT","setKeys","stopAnimation","animations","beginAnimation","frameTotal","ANIMATIONTYPE_VECTOR3","ANIMATIONTYPE_COLOR3","toAlpha","toBeta","animCamAlpha","activeCamera","keysAlpha","overPI","alpha","firstStop","secondStop","animCamBeta","keysBeta","beta","mesh","capacity","minEmitBox","maxEmitBox","color1","color2","colorDead","minSize","maxSize","minLifeTime","maxLifeTime","emitRate","blendMode","ParticleSystem","BLENDMODE_ONEONE","gravity","direction1","direction2","minAngularSpeed","maxAngularSpeed","minEmitPower","maxEmitPower","updateSpeed","startIt","particleSystem","particleTexture","Texture","emitter","start","sceneObject","paramBox","getRenderWidth","getRenderHeight","mode","level","create2DScene","logo","loadAssets","textures_logo","hasAlpha","Sprite2D","origin","radians","offset","sign","abs","baseAngle","checkedAngle","borderPI","signedAngle","currentAngleArc","signedAngleArc","angleA","angleB","sound","currentVolume","step","threshold","delayInMs","getVolume","decrement","setVolume","fadeOut","stop","len","inclination","azimuth","z","sin","cos","round","getRandomArbitrary","Loader","border","centered","masks","bottom","right","top","left","drawRectangles","_value","lastUpdatedValue","updateMasks","updateRectangles","fullWeight","residual","residualBottom","residualTop","residualLeft","rectangles","rectangle","margin","rightPixels","leftPixels","bottomPixels","topPixels","val","DEBUG_MODE_ON"],"mappings":"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A;AACA;AACA,0BAA0B,WAAW;AACrC;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,CAAC,EAAE,yCAAyC;AAC5C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,CAAC,GAAG;AACJ;AACA;AACA;AACA;AACA,SAAS,yCAAyC;AAClD;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,eAAe;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA,kCAAkC;AAClC,4CAA4C;AAC5C,yBAAyB;AACzB,uDAAuD;AACvD,gEAAgE;AAChE,yEAAyE;AACzE,gDAAgD;AAChD;AACA,2DAA2D;AAC3D,aAAa;AACb,UAAU;AACV;AACA;;AAEA;AACA;AACA,qBAAqB;AACrB,gCAAgC;AAChC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,SAAS;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,YAAY;AACf;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,CAAC,EAAE,YAAY;AACf;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sCAAsC,sBAAsB;AAC5D;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb;AACA,+BAA+B,iBAAiB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,CAAC,EAAE,uBAAuB;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;AAC5C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,GAAG;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,SAAS;AACT;AACA,oEAAoE;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB,KAAK;AACL;AACA,gBAAgB;AAChB,KAAK;AACL;AACA,gBAAgB;AAChB,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA,6BAA6B,cAAc;;AAE3C;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,qDAAqD,EAAE;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,QAAQ;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,+BAA+B,uBAAuB;;AAEtD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;;AAEA,qCAAqC,QAAQ;AAC7C;AACA;AACA;AACA;AACA;;AAEA,yCAAyC,QAAQ;AACjD;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,+BAA+B,cAAc;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,4BAA4B;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,2BAA2B;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,gCAAgC,oBAAoB;AACpD;AACA;AACA;AACA;AACA,4BAA4B,QAAQ;AACpC;AACA;AACA;AACA;AACA;AACA,mBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,+BAA+B,QAAQ;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,SAAS,mBAAmB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,mBAAmB;AACpC,sBAAsB,mBAAmB;AACzC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,0BAA0B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yCAAyC,aAAa;AACtD;;AAEA;AACA;AACA;AACA,wCAAwC,eAAe;AACvD;;AAEA;AACA;AACA;AACA,4CAA4C,eAAe;AAC3D,KAAK;AACL;AACA,kCAAkC;AAClC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6CAA6C,aAAa;AAC1D,KAAK;AACL;AACA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;;AAEA,CAAC,GAAG;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA,CAAC,GAAG;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;;AAEA,eAAe,oBAAoB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,uBAAuB;AAC1B;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,gBAAgB;AAChB,gBAAgB;AAChB,kBAAkB;;AAElB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB;AAChB;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,GAAG;AACJ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,CAAC,GAAG;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,mBAAmB,aAAa;AAChC;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,CAAC,EAAE,+BAA+B;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,0BAA0B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,0BAA0B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,kCAAkC;AAClC,0CAA0C;AAC1C;AACA;;AAEA;AACA;AACA,yBAAyB;AACzB,oCAAoC;AACpC;AACA;;AAEA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA,sDAAsD;AACtD,2CAA2C;AAC3C;AACA,uCAAuC;AACvC,iDAAiD;AACjD,qCAAqC;AACrC,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;;;AAGA,yEAAyE;AACzE,yBAAyB;AACzB,oCAAoC;AACpC;AACA,6BAA6B;AAC7B,wCAAwC;AACxC,6BAA6B;AAC7B,aAAa;AACb;AACA,mEAAmE;AACnE,uCAAuC;AACvC,kEAAkE;AAClE,sCAAsC;AACtC,uCAAuC;AACvC,0DAA0D;AAC1D,iBAAiB,OAAO;AACxB,kDAAkD;AAClD,iBAAiB;AACjB,cAAc;AACd;AACA,sEAAsE;AACtE,qCAAqC;AACrC,yCAAyC;AACzC,2CAA2C;AAC3C,wEAAwE;AACxE,qBAAqB,OAAO;AAC5B,oDAAoD;AACpD,qBAAqB;AACrB;AACA,iBAAiB;AACjB,cAAc;AACd;AACA,+DAA+D;AAC/D;AACA,cAAc;AACd;AACA,6BAA6B;AAC7B,SAAS,qCAAqC;AAC9C;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,+BAA+B,UAAU;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC,EAAE,YAAY;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;;AAEA,CAAC,EAAE,YAAY;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA,CAAC,EAAE,YAAY;AACf;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC,EAAE,qCAAqC;AACxC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,YAAY;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uCAAuC,aAAa;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAmB,aAAa;AAChC;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA,0BAA0B;AAC1B,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mC;AACA,6C;AACA,+B;AACA,sC;AACA,uC;AACA,qC;AACA,4B;AACA,6B;AACA,K;AACA;AACA;AACA,eAAe,KAAK,E;AACpB,eAAe,KAAK,E;AACpB,eAAe,KAAK,E;AACpB,iB;AACA,0BAA0B,E;AAC1B,yB;AACA,qB;AACA,qC;AACA,8D;AACA,mB;;AAEA;;AAEA,CAAC,EAAE,0gBAA0gB;AAC7gB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,SAAS;AAC5B;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,CAAC,EAAE,YAAY;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA,2BAA2B,gBAAgB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wCAAwC,UAAU;AAClD;AACA;AACA,wCAAwC,QAAQ;AAChD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+CAA+C,MAAM,YAAY,OAAO;AACxE,SAAS;AACT;AACA,oCAAoC,MAAM,YAAY,OAAO;AAC7D,mDAAmD,MAAM,YAAY,OAAO;AAC5E;AACA,8BAA8B,MAAM;AACpC;;AAEA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;;AAEA;AACA;AACA,0CAA0C;AAC1C,sBAAsB;AACtB,2BAA2B,SAAS,OAAO;AAC3C,sCAAsC;AACtC,aAAa;AACb,+BAA+B;AAC/B;AACA,kBAAkB;AAClB;AACA,oEAAoE;AACpE,wEAAwE;AACxE;AACA;;AAEA;AACA;AACA;AACA,6BAA6B;AAC7B,yCAAyC;AACzC,yBAAyB;AACzB,uCAAuC;AACvC,gDAAgD;AAChD,yCAAyC;AACzC,0EAA0E;AAC1E,oBAAoB;AACpB,uDAAuD;AACvD,yBAAyB;AACzB;AACA,aAAa;AACb,mCAAmC;AACnC,6EAA6E;AAC7E,aAAa;AACb,wEAAwE;AACxE,2BAA2B;AAC3B,UAAU;AACV,0DAA0D;AAC1D,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mCAAmC,aAAa;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,yCAAyC,SAAS;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA,CAAC,EAAE,0CAA0C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,mBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,uBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,gDAAgD,SAAS;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,uBAAuB;AAC1B;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC,GAAG;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,CAAC,EAAE,YAAY;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA,cAAc,YAAY;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,YAAY;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,qCAAqC;AACrE,gCAAgC,mCAAmC;AACnE,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,KAAK;AACL,CAAC;AACD;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA,CAAC,EAAE,YAAY;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,YAAY;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mCAAmC,yBAAyB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,CAAC,EAAE,0BAA0B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,CAAC,GAAG;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA,gBAAgB;AAChB;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,CAAC,EAAE,YAAY;AACf;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,kCAAkC,uCAAuC;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,wCAAwC,gBAAgB,EAAE;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,CAAC,EAAE,YAAY;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8BAA8B,SAAS;AACvC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,uBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;;AAEA;AACA,uBAAuB,+BAA+B;AACtD;AACA;;AAEA;AACA;AACA,+BAA+B,wBAAwB;AACvD;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC,EAAE,0BAA0B;AAC7B;AACA;AACA;;AAEA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB;;AAEpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,iBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uBAAuB,+BAA+B;AACtD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,+BAA+B,iBAAiB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,wBAAwB;AACxB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,mCAAmC,+BAA+B;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,WAAW;AAC7B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,wBAAwB;AACxB;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,aAAa;AACb;;AAEA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,kDAAkD;AAClD,kBAAkB;AAClB;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC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,EAAO;AACtB,UAAI,OAAOA,MAAMtB,GAAb,KAAqB,WAAzB,EAAsC;AACpC,aAAK2H,eAAL,GAAuBrG,MAAMtB,GAA7B;AACD,OAFD,MAEO;AACL,mCAAW,2DAAX;AACD;AACF;;;wBAEe;AACd,aAAQ,KAAKhB,UAAb;AACD,K;sBAEa/P,K,EAAO;AAAE;AACrB,iCAAW,4EAAX;AACD;;;wBAEgB;AACf,UAAI,KAAK+P,UAAL,CAAgB3Z,MAApB,EAA4B;AAC1B,eAAQ,KAAK2Z,UAAL,CAAgB,CAAhB,CAAR;AACD;AACD,aAAOpQ,SAAP;AACD,K;sBAEcK,K,EAAO;AACpB;AACA,iCAAW,uCAAX;AACD;;AAED;;;;wBAEW;AACT,aAAQ,KAAKqC,QAAb;AACD;;;wBAEe;AACd,aAAQ,IAAIe,IAAJ,GAAWC,OAAX,KAAuB,IAA/B;AACD;;;wBAEc;AACb,aAAQ,IAAID,IAAJ,GAAWC,OAAX,EAAR;AACD;;;;;;kBAljCkBkP,Y;;;;;;ACtBrB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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CrC,qCAAqC;AACrC,qCAAqC;AACrC,qCAAqC;AACrC,qCAAqC;AACrC,qCAAqC;AACrC,qCAAqC;AACrC,qCAAqC;AACrC,qCAAqC;AACrC,qCAAqC;AACrC,qCAAqC;AACrC,qCAAqC,KAAK;AAC1C,qCAAqC;AACrC,qCAAqC,KAAK;;AAE1C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA,uCAAuC,gBAAgB;AACvD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,sDAAsD,gBAAgB;AACtE;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,MAAM;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B;AAC9B;AACA,6BAA6B;AAC7B;AACA;;AAEA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,eAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mDAAmD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA,sBAAsB;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA,yBAAyB;AACzB;;AAEA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,mBAAmB;AACpC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,yCAAyC,gBAAgB;AACzD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,yCAAyC,gBAAgB;AACzD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;;AAEA;AACA,+BAA+B;AAC/B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gDAAgD,gBAAgB;AAChE;;AAEA;;AAEA;AACA;;AAEA;AACA,eAAe;AACf;;AAEA;;AAEA;;AAEA;AACA,eAAe;AACf;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,iBAAiB,gBAAgB;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA,gDAAgD,gBAAgB;AAChE;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,eAAe;AACf;;AAEA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,eAAe;AACf;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,6BAA6B,EAAE;AAC/B;;AAEA;AACA;;AAEA;;AAEA,2CAA2C,gBAAgB;AAC3D;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,oDAAoD,gBAAgB;AACpE;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA,+CAA+C,gBAAgB;AAC/D;AACA;AACA,OAAO;AACP;;AAEA,sDAAsD,gBAAgB;AACtE;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA,oCAAoC,8BAA8B;AAClE;;AAEA;AACA;;AAEA,CAAC,EAAE,kFAAkF;AACrF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA,CAAC,GAAG;AACJ;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA,6CAA6C,EAAE;AAC/C;AACA,oDAAoD,EAAE,eAAe,EAAE,YAAY;;;AAGnF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAuB;AACvB,uBAAuB;AACvB;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,0BAA0B,UAAU;AACpC,0BAA0B,UAAU;AACpC,0BAA0B,UAAU;AACpC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,uCAAuC;AACvC;AACA,eAAe,SAAS;AACxB;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;;AAEd;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,6CAA6C;AAC7C;;AAEA;;AAEA,+CAA+C,kBAAkB;AACjE;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kDAAkD,kBAAkB;AACpE;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA,KAAK;AACL;AACA;AACA;;AAEA,KAAK;AACL;;AAEA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA,OAAO;AACP;AACA;;AAEA,OAAO;AACP;AACA;;AAEA,cAAc,eAAe;AAC7B;;AAEA;AACA;;AAEA,WAAW;AACX;AACA;AACA;;AAEA;;AAEA;;AAEA,OAAO;AACP;AACA;;AAEA;;AAEA,KAAK;AACL;AACA;AACA;;AAEA,KAAK;AACL;;AAEA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;;AAEA;;AAEA;AACA,sBAAsB;AACtB;AACA;AACA,GAAG,yBAAyB;AAC5B,sBAAsB,IAAI;AAC1B;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA,KAAK;AACL;AACA,4EAA4E;AAC5E,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;;AAEA,KAAK;AACL;AACA;AACA;;AAEA;AACA,QAAQ,+CAA+C;AACvD;;AAEA;AACA,UAAU,+CAA+C;AACzD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP,6BAA6B;AAC7B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,OAAO;AACP;AACA;;AAEA;AACA,OAAO;AACP,6BAA6B;AAC7B;AACA;;AAEA;AACA,OAAO;AACP;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,uBAAuB;AACvB;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,OAAO;AACP;AACA;AACA;;AAEA,OAAO;AACP,4DAA4D;AAC5D;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,SAAS;AACT,mEAAmE;;AAEnE,SAAS;AACT;AACA;AACA,sBAAsB;AACtB;;AAEA,OAAO;AACP,8DAA8D;;AAE9D,OAAO;AACP;AACA;AACA,oBAAoB;AACpB;;AAEA,KAAK;AACL,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA,QAAQ,+CAA+C;AACvD;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,GAAG;AACH;;AAEA,GAAG;AACH;;AAEA,GAAG;AACH;;AAEA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA,SAAS;AACT;;AAEA;AACA;AACA;;AAEA,SAAS;AACT;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA,+EAA+E;AAC/E;;AAEA,wCAAwC;AACxC;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,YAAY,+CAA+C;AAC3D;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA,4CAA4C,gBAAgB;AAC5D;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;;AAGA;AACA,wCAAwC,8BAA8B;AACtE;;;AAGA;AACA,oCAAoC,8BAA8B;AAClE;;;AAGA;AACA;AACA;AACA;;AAEA,CAAC,EAAE,6FAA6F;AAChG;;;AAGA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA,CAAC,EAAE,aAAa;AAChB;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,GAAG;;AAEH;AACA;AACA,GAAG;AACH;;;AAGA;AACA;AACA,kBAAkB;AAClB,oBAAoB;AACpB,mBAAmB;AACnB;AACA,OAAO;;AAEP;AACA;AACA;;AAEA,4CAA4C,gBAAgB;AAC5D;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;;AAGA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,wCAAwC,iCAAiC,EAAE;AAC3E;AACA;;AAEA,oCAAoC,6BAA6B,EAAE;AACnE;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;;;AAGA;;AAEA,CAAC,EAAE,yCAAyC;AAC5C;AACA;AACA;AACA;AACA;;;AAGA;;;AAGA;;;AAGA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,0BAA0B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;;AAGA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,4GAA4G;AAC/G;AACA;AACA;AACA;AACA;;;AAGA;;;AAGA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,6IAA6I;AAChJ;AACA;;;AAGA;;;AAGA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,iEAAiE;AACpE;AACA;AACA;AACA;AACA;AACA;;;AAGA;;;AAGA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,sGAAsG;AACzG;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,8DAA8D,aAAa;AAC3E,kEAAkE,aAAa;AAC/E;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC,EAAE,gBAAgB;AACnB;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;;;AAGA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA,eAAe,WAAW;AAC1B;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,eAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,eAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,aAAa;AAChB;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,kCAAkC,EAAE;AACtE,kCAAkC,kCAAkC,EAAE;AACtE,kCAAkC,kCAAkC;AACpE,GAAG;AACH;AACA,CAAC;;AAED,CAAC,EAAE,aAAa;AAChB;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,GAAG;AACH;;AAEA,GAAG;AACH;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;;;AAGA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,2BAA2B;AAC9B;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,YAAY,aAAa;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA,YAAY,aAAa;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAU,aAAa;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,QAAQ,aAAa;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,kCAAkC,EAAE;AACxE,oCAAoC,kCAAkC,EAAE;AACxE,oCAAoC,mCAAmC,EAAE;AACzE,oCAAoC,iDAAiD;AACrF,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,2BAA2B;AAC9B;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,wCAAwC,cAAc;;AAEtD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA,sCAAsC,cAAc;AACpD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;;AAEA,0CAA0C,iBAAiB;AAC3D;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,gBAAgB;AACnB;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,gBAAgB;AACnB;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,gBAAgB;AACnB;;AAEA;;AAEA;AACA;AACA,8BAA8B,kCAAkC;AAChE,CAAC;;AAED,CAAC,EAAE,aAAa;AAChB;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,aAAa;AAChB;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,YAAY,KAAK;AAC7C,4BAA4B,eAAe,EAAE;AAC7C,4BAA4B,eAAe,EAAE;AAC7C,4BAA4B,eAAe;AAC3C,GAAG;AACH;AACA,CAAC;;AAED,CAAC,EAAE,aAAa;AAChB;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,yCAAyC,gBAAgB;AACzD;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,aAAa;AAChB;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA,yCAAyC,gBAAgB;AACzD;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA,yCAAyC,gBAAgB;AACzD;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,aAAa;AAChB;;AAEA;;AAEA;AACA;AACA,8BAA8B,kCAAkC;AAChE,CAAC;;AAED,CAAC,EAAE,aAAa;AAChB;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,aAAa;AAChB;;AAEA;;AAEA;AACA;AACA,8BAA8B,kCAAkC;AAChE,CAAC;;AAED,CAAC,EAAE,aAAa;AAChB;;AAEA;;AAEA;AACA;AACA;AACA,oBAAoB;;AAEpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;;AAE5B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA,0BAA0B;AAC1B;;AAEA,kBAAkB;AAClB;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED,CAAC,EAAE,aAAa;AAChB;;;AAGA;;;AAGA;;AAEA,CAAC,EAAE,qBAAqB,EAAE,GAAG;AAC7B,CAAC,E;;;;;;AC3yHD;AACA;;AAEA;AACA;AACA;;AAEA,uBAAuB;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,iBAAiB;AACtC;AACA;AACA;AACA,kBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAA0C,sBAAsB,EAAE;AAClE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAU;AACV;AACA;;AAEA,KAAK;AACL;AACA;;AAEA,KAAK;AACL;AACA;;AAEA,KAAK;AACL;AACA;;AAEA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,CAAC;;;;;;;;ACzLD;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA","file":"experiment.max.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"lodash\"), require(\"experiment-babylon-js\"), require(\"jQuery\"), require(\"experiment-boxes\"), require(\"experiment-mathjs\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"experiment\", [\"lodash\", \"experiment-babylon-js\", \"jQuery\", \"experiment-boxes\", \"experiment-mathjs\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"experiment\"] = factory(require(\"lodash\"), require(\"experiment-babylon-js\"), require(\"jQuery\"), require(\"experiment-boxes\"), require(\"experiment-mathjs\"));\n\telse\n\t\troot[\"experiment\"] = factory(root[\"_\"], root[\"BABYLON\"], root[\"jQuery\"], root[\"experimentBoxes\"], root[\"math\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_4__, __WEBPACK_EXTERNAL_MODULE_8__, __WEBPACK_EXTERNAL_MODULE_12__, __WEBPACK_EXTERNAL_MODULE_13__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 16);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3bc8620d376b122a822b","/**\n * This file should contain utility functions that are independant of the task.\n *\n *\n */\nimport $ from 'jquery'\nimport _ from 'lodash'\nimport math from 'experiment-mathjs'\nimport Promise from 'bluebird'\n\nimport BABYLON from 'experiment-babylon-js'\n\nimport { DEBUG_MODE_ON } from '../config'\n\nPromise.config({\n    // Enable warnings\n  warnings: false,\n    // Enable long stack traces\n  longStackTraces: false,\n    // Enable cancellation\n  cancellation: false,\n    // Enable monitoring\n  monitoring: false,\n})\n\n/**\n * noop - just your friendly empty function\n *\n * @returns {undefined}\n */\nfunction noop() {}\n\n\n/**\n * Debug functions\n */\nconst debuglog = DEBUG_MODE_ON ? console.log.bind(console) : noop\nconst debugWarn = DEBUG_MODE_ON ? console.warn.bind(console) : noop\nconst debugError = DEBUG_MODE_ON ? console.error.bind(console) : noop\n\n/**\n * Allows to return an error for missing parameters.\n * @param  {String} param Optional string to add after the error.\n */\nfunction mandatory(param = '') {\n  throw new Error(`Missing parameter ${param}`)\n}\n\n/**\n * Checks the type of all given parameters, return an error if one is undefined.\n * @param  {...object} args List of arguments to checks\n * @return {bool}      true if all arguments are defined\n */\n\nfunction mustBeDefined(...args) {\n  for (let i = 0; i < args.length; i++) {\n    if (typeof args[i] === 'undefined') {\n      throw new Error(`Argument ${i} is undefined.`) // TODO transform that into debugError...\n    }\n  }\n\n  return true\n}\n\n/**\n * Creates a new object of class TargetClass = defaultValue.constructor from the object parameter, only if the object is not\n * already an instance of TargetClass. If object is an array, the object is created like so new TargetClass(...object)\n * @method spreadToObject\n * @param  {Object|Array}       object      The object or array to be converted into TargetClass\n * @param  {Object}       defaultValue      If the object is undefined or null this value is returned.\n *                                          If not, the object is Transformed into the TargetClass which is defaultValue.constructor\n * @return {[type]}                         Object of class TargetClass\n */\nfunction spreadToObject(object, defaultValue) {\n  if ((typeof object === 'undefined') || (object === null)) {\n    return defaultValue\n  }\n\n  const TargetClass = defaultValue.constructor\n  if (object.constructor === TargetClass) {\n    return object\n  } else if (object.constructor === Array) {\n    return new TargetClass(...object)\n  }\n  debugWarn('spreadToObject: cannot spread to target class')\n  return defaultValue\n}\n\n/**\n * Checks the constructor of all given parameters, return an error if one is not as specified.\n * @param  {object} constructorObject constructor\n * @param  {...object} args         list of arguments to check\n * @return {bool}                   true if all arguments have specified constructorObject as constructor\n */\n\nfunction mustHaveConstructor(constructorObject, ...args) {\n  if (args.allHaveConstructor(constructorObject) === false) {\n    throw new Error('Wrong constructor in arguments.')\n  }\n\n  return true\n}\n\nfunction hasConstructor(constructorObject, ...args) {\n  if (args.allHaveConstructor(constructorObject) === false) {\n    return false\n  }\n\n  return true\n}\n\n/**\n * Returns true if o looks like a promise. From the es-promisify package.\n * https://github.com/digitaldesignlabs/es6-promisify/\n * @param  {object} o Object to test\n * @return {bool}   True if looks like a promise, false otherwise\n */\nfunction looksLikeAPromise(o) {\n  return o && typeof o.then === 'function' && typeof o.catch === 'function'\n}\n\n\n/**\n * From http://www.datchley.name/promise-patterns-anti-patterns/\n * @param  {int} ms delay in ms\n * @return {promise} promise which will resolve in delay ms\n */\nfunction delay(ms) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms)\n  })\n}\n\n/**\n * @param  {int} min min delay in ms\n * @param  {int} max max delay in ms\n * @return {promise} promise which will resolve in delay ms\n */\nfunction jitter(min = mandatory(), max = mandatory()) {\n  return new Promise((resolve) => {\n    const randomDuration = _.random(min, max)\n    setTimeout(resolve, randomDuration)\n  })\n}\n\n/**\n * Recurse on a given promise chain\n * @param  {Promise} promise Promise to recurse on\n * @param  {numeric} amount  amount of time to recurse\n * @return {Promise}         Promise\n */\nfunction recurse(promiseGenerator = mandatory(),\n  amount = mandatory(),\n  target = this, args = [],\n  concatOnArray = []) {\n  // Base case - just return the promisified result\n  if (amount === 0) {\n    return new Promise((resolve) => {\n      resolve(concatOnArray)\n    })\n  }\n\n\n  const next = promiseGenerator.apply(target, args).then((r) => {\n    concatOnArray = concatOnArray.concat(r)\n    return (recurse(promiseGenerator, amount - 1, target, args, concatOnArray))\n  })\n\n  return next\n}\n\n/**\n * Compatible helper to replace the now defunc Promise.defer()\n * @method Deferred\n */\nfunction Deferred() {\n  this.resolve = null\n  this.reject = null\n  this.resolved = false\n  this.rejected = false\n  this.pending = true\n  this.status = 0\n  /* A newly created Pomise object.\n   * Initially in pending state.\n   */\n  this.promise = new Promise((resolve, reject) => {\n    this.resolve = (data) => {\n      this.resolved = true\n      this.pending = false\n      resolve(data)\n    }\n    this.reject = (e) => {\n      this.rejected = true\n      this.pending = false\n      // if (e.constructor === String) {\n      //   e = new Error(e)\n      // }\n      reject(e)\n    }\n  })\n  // Object.freeze(this)\n}\n\n/**\n * From http://stackoverflow.com/questions/3751520/how-to-generate-sequence-of-numbers-chars-in-javascript\n * TODO Pull request math js\n * @param  {object} content Repeated sequence\n * @param  {int} count   Number of time the sequence must be repeat\n * @return {array}       Array with repeated sequence\n */\nfunction rep(content = mandatory(), count = mandatory()) {\n  let result = []\n  if (typeof (content) === 'function') {\n    for (let i = 0; i < count; i++) {\n      result = result.concat(content(i))\n    }\n  } else {\n    for (let i = 0; i < count; i++) {\n      result = result.concat(content)\n    }\n  }\n  return result\n}\n\nfunction samplePermutation(sequence = mandatory(), repetition = false, n = null) {\n  if (sequence.constructor !== Array) {\n    throw new Error('samplePermutation: sequence needs to be an array.')\n  }\n\n  if (n === null) {\n    n = sequence.length\n  }\n\n  const copy = sequence.slice(0)\n  let permutation = []\n  let add\n  while ((repetition && (permutation.length < n)) || ((!repetition) && (copy.length))) {\n    const index = Math.floor(Math.random() * copy.length)\n    if (repetition) {\n      add = copy[index]\n    } else {\n      add = copy.splice(index, 1)\n    }\n    permutation = permutation.concat(add)\n  }\n\n  return (permutation)\n}\n\n/* ======= Loading ======= */\nfunction preloadImages(...images) { // TODO make it a RessourceManager function\n  const imgArray = []\n  const promiseArray = []\n  for (const image of images) {\n    if (image.constructor === String) {\n      const deferred = new Deferred()\n      const img = new Image()\n      img.src = image\n      imgArray.push(img)\n\n      if (img.complete) {\n        deferred.resolve()\n      } else {\n        img.addEventListener('load', function () { this.resolve() }.bind(deferred))\n      }\n\n      // $(img).on('load', function () {\n      //   this.resolve()\n      //   debugError('THIS IS LOAD')\n      // }.bind(deferred))\n\n      promiseArray.push(deferred.promise)\n    } else {\n      debugError('preloadImages: invalid string url ', image)\n    }\n  }\n\n\n  return [Promise.all(promiseArray), imgArray]\n}\n\n/* =============== Personalized Matrix Functions =============== */\nfunction matrix(rows = mandatory(), cols = mandatory(), fill = 0) {\n  const matrixObject = []\n\n  for (let i = 0; i < rows; i++) {\n    matrixObject[i] = []\n    for (let j = 0; j < cols; j++) {\n      matrixObject[i][j] = fill\n    }\n  }\n\n  return (matrixObject)\n}\n\nfunction getRow(matrixObject = mandatory(), rowIndex = mandatory()) {\n  matrixObject = math.matrix(matrixObject)\n  const size = (matrixObject.size())[0]\n  const row = math.subset(matrixObject, math.index(rowIndex, math.range(0, size)))\n\n  return (row)\n}\n\nfunction rowSum(matrixObject = mandatory(), rows = null) {\n  matrixObject = math.matrix(matrixObject)\n  const size = (matrixObject.size())[0]\n  if (rows === null) {\n    rows = math.range(0, size - 1)\n  }\n  if (rows.constructor !== Array) {\n    rows = [rows]\n  }\n\n  const rowSumArray = []\n  for (let i = 0; i < rows.length; i++) {\n    rowSumArray.push(math.sum(getRow(matrixObject, rows[i])))\n  }\n\n  return (rowSumArray)\n}\n\n// set or get the diagonal of a matrix\nfunction diag(matrixObject = mandatory(), setTo = null): Array {\n  const rows = matrixObject.length\n  // const cols = matrixObject[0].length\n\n  const diagonalValues = []\n\n  for (let i = 0; i < rows; i++) {\n    if (setTo) {\n      matrixObject[i][i] = setTo\n    }\n    diagonalValues.push(matrixObject[i][i])\n  }\n\n  return ([diagonalValues, matrixObject])\n}\n\n/* ======= BABYLON HELPERS ======= */\n\nfunction sizeToVec(size = null) {\n  mustHaveConstructor(BABYLON.Size, size)\n  return (new BABYLON.Vector2(size.width, size.height))\n}\n\nfunction scaleSize(size = null, scale = 1) {\n  mustHaveConstructor(BABYLON.Size, size)\n\n  const floatScale = parseFloat(scale)\n  if (isNaN(floatScale)) {\n    throw new Error(`taskObject.scaleSize: scale is invalid ${scale}`)\n  }\n\n  return new BABYLON.Size(size.width * floatScale, size.height * floatScale)\n}\n\nfunction getQueryString() {\n    // This function is anonymous, is executed immediately and\n    // the return value is assigned to QueryString!\n  const queryString = {}\n  const query = window.location.search.substring(1)\n  const vars = query.split('&')\n  for (let i = 0; i < vars.length; i++) {\n    const pair = vars[i].split('=')\n      // If first entry with this name\n    if (typeof queryString[pair[0]] === 'undefined') {\n      queryString[pair[0]] = decodeURIComponent(pair[1])\n        // If second entry with this name\n    } else if (typeof queryString[pair[0]] === 'string') {\n      const arr = [queryString[pair[0]], decodeURIComponent(pair[1])]\n      queryString[pair[0]] = arr\n        // If third or later entry with this name\n    } else {\n      queryString[pair[0]].push(decodeURIComponent(pair[1]))\n    }\n  }\n  return queryString\n}\n\n/* ======= Number functions ======= */\nNumber.prototype.boundTo = function boundTo(min = mandatory(), max = mandatory()) {\n  mustHaveConstructor(Number, min, max)\n  return Math.max(Math.min(this, max), min)\n}\n\n\n/* =============== String functions =============== */\n\n/**\n * Find all the positions of a needle in a haystack string\n * @param  {string} needle   string to find\n * @param  {string} haystack string to scan\n * @return {Array}  Either -1 if no match is found or an array containing the indicies\n */\nString.prototype.indicesOf = function indicesOf(needle = mandatory()): Array<number> | -1 {\n  const haystack = this\n  const indices = []\n  for (let i = 0; i < haystack.length; i++) {\n    if ((haystack.substr(i, needle.length)) === needle) {\n      indices.push(i)\n    }\n  }\n\n  if (indices.length) {\n    return (indices)\n  }\n  return (-1)\n}\n\n/* =============== Array prototype overload =============== */\nArray.prototype.hasNeighbouringRepeat = function hasNeighbouringRepeat() {\n  let previousElement = null\n  for (let i = 0; i < this.length; i++) {\n    if (previousElement === this[i]) {\n      return true\n    }\n    previousElement = this[i]\n  }\n  return false\n}\n\nArray.prototype.toCsv = function toCsv() {\n  const lineArray = []\n  this.forEach((array, index) => {\n    const line = array.join(',')\n    lineArray.push(index === 0 ?\n      `data:text/csv;charset=utf-8,${line}` :\n      line)\n  })\n  const csvContent = lineArray.join('\\n')\n\n  return (csvContent)\n}\n\nArray.prototype.uniqueValues = function uniqueValues() {\n  const u = {}\n  const a = []\n\n  for (let i = 0; i < this.length; i++) {\n    if (!u.hasOwnProperty(this[i])) {\n      a.push(this[i])\n      u[this[i]] = 1\n    }\n  }\n  return a\n}\n\nArray.prototype.min = function min() {\n  const u = this.uniqueValues()\n\n  if (u.allHaveConstructor(Number)) {\n    let minValue = u[0]\n    for (let i = 0; i < u.length; i++) {\n      if (u[i] < minValue) { minValue = u[i] }\n    }\n    return minValue\n  }\n  return NaN\n}\n\nArray.prototype.max = function max() {\n  const u = this.uniqueValues()\n\n  if (u.allHaveConstructor(Number)) {\n    let maxValue = u[0]\n    for (let i = 0; i < u.length; i++) {\n      if (u[i] > maxValue) { maxValue = u[i] }\n    }\n    return maxValue\n  }\n  return NaN\n}\n\n\n/**\n * multisplice - from http://upshots.org/actionscript/javascript-splice-array-on-multiple-indices-multisplice\n * With some es6 magic\n *\n * @returns {Array}\n */\nArray.prototype.multisplice = function (...args) {\n  args.sort((a, b) => a - b)\n  const spliced = []\n  for (let i = 0; i < args.length; i++) {\n    const index = args[i] - i\n    spliced.push(this.splice(index, 1)[0])\n  }\n  return spliced\n}\n\n/**\n * Return an array of objects with x and y property. Y is taken as the values of the array, and x is either the index if null, or the values of the specified array.\n * @param  {?array} x X values, if null, the index is taken as x\n * @return {array}   Array of x and y [{x: x[i], y: this[i]},...]\n */\nArray.prototype.getXY = function getXY(x = null): Array {\n  if (x !== null) {\n    if (x.constructor !== Array) {\n      throw new Error('Array.getXY: x needs to be an array.')\n    }\n\n    if (x.length !== this.length) {\n      throw new Error('Array.getXY: x needs to be of the same length as array')\n    }\n  } else {\n    debuglog('Array.getXY: x === null, x will be taken as the index of each value.')\n  }\n\n  const xyArray = []\n  for (let i = 0; i < this.length; i++) {\n    if (x !== null) {\n      xyArray.push({\n        x: x[i],\n        y: this[i],\n      })\n    } else {\n      xyArray.push({\n        x: i,\n        y: this[i],\n      })\n    }\n  }\n\n  return (xyArray)\n}\n\nArray.prototype.average = function average(type = 'global', size = 5): ?Number {\n  if (type === 'global') {\n    const sum = this.sum()\n    if (!isNaN(sum)) {\n      return (sum / this.length)\n    }\n  } else if (type === 'sliding') {\n    const windowAverages = []\n    for (let i = 0; i < this.length; i++) {\n      let endIndex = i + size\n      if (endIndex > this.length) {\n        endIndex = this.length\n      }\n      const windowArray = this.slice(i, endIndex)\n\n      const sum = windowArray.sum()\n      if (!isNaN(sum)) {\n        windowAverages.push(sum / windowArray.length)\n      }\n    }\n    return (windowAverages)\n  } else if (type === 'bins') {\n    const bins = []\n    let position = 0\n    while (position < this.length) {\n      const endIndex = position + size\n      if (endIndex > this.length) {\n        break\n      }\n\n      const windowArray = this.slice(position, endIndex)\n\n      const sum = windowArray.sum()\n      if (!isNaN(sum)) {\n        bins.push(sum / windowArray.length)\n      }\n\n      position = endIndex\n    }\n\n    return (bins)\n  }\n\n  return undefined\n}\n\nArray.prototype.sum = function sum() {\n  let total = 0\n  for (let i = 0; i < this.length; i++) {\n    if (isNaN(this[i])) {\n      return (NaN)\n    }\n    total += this[i]\n  }\n  return (total)\n}\n\nArray.prototype.integrate = function integrate() {\n  let sum = 0\n  const cumulativeArray = []\n  for (let i = 0; i < this.length; i++) {\n    if (isNaN(this[i])) {\n      return (NaN)\n    }\n\n    sum += this[i]\n    cumulativeArray.push(sum)\n  }\n  return (cumulativeArray)\n}\n\nArray.prototype.equals = function equals(value) {\n  const resultVector = []\n  let result = null\n  for (let i = 0, l = this.length; i < l; ++i) {\n    result = (this[i] === value)\n    resultVector.push(result)\n  }\n  return resultVector\n}\n\nArray.prototype.ntrue = function ntrue() {\n  let resultSum = 0\n  let result = null\n  for (let i = 0, l = this.length; i < l; ++i) {\n    result = (this[i] === true) ?\n      1 :\n      0\n    resultSum += result\n  }\n  return resultSum\n}\n\nArray.prototype.nEquals = function nEquals(value) {\n  return this.equals(value).ntrue()\n}\n\nArray.prototype.indicesOf = function indicesOf(value) {\n  const resultVector = []\n  for (let i = 0, l = this.length; i < l; i++) {\n    if (this[i] === value) {\n      resultVector.push(i)\n    }\n  }\n  return resultVector\n}\n\nArray.prototype.exclude = function exclude(values) {\n  // returns an array without exluded values\n  const resultVector = []\n  for (let i = 0, l = this.length; i < l; ++i) {\n    let addit = true\n    for (let j = 0; j < values.length; ++j) {\n      if (this[i] === values[j]) {\n        addit = false\n      }\n    }\n    if (addit) {\n      resultVector.push(this[i])\n    }\n  }\n  return resultVector\n}\n\nArray.prototype.allHaveConstructor = function allHaveConstructor(constructorObject) {\n  for (let i = 0; i < this.length; i++) {\n    if ((typeof this[i] === 'undefined') || (this[i] === null) || (this[i].constructor !== constructorObject)) {\n      return false\n    }\n  }\n  return true\n}\n\nArray.prototype.includes = function includes(...array) {\n  if ((array.length === 1) && ((array[0].constructor === Set) || (array[0].constructor === Array))) {\n    array = array[0]\n  }\n  // returns a bool wether all value of specified array are in current array\n  for (let i = 0; i < array.length; i++) {\n    if (this.indexOf(array[i]) === -1) { return false }\n  }\n  return true\n}\n\n\n/**\n * observe - Starts a repeated check (default to every 500 millisecond) on the attribute of an object until it is set to a\n *           specified value. Returns a promise that will resolve when the value match.\n *           TODO maybe think of creating an _observedValues property somewhere... maybe in a global object\n *\n * @param {string} [attribute=string]   attribute to check\n * @param {boolean} [lookForValue=true] value to match\n * @param {number}  [rate=500]          how many milliseconds between two checks\n *\n * @returns {Promise} Promise will resolve when the attribute has the value lookForValue\n */\nObject.defineProperty(Object.prototype, 'observe', {\n  value: function observe(attribute = mandatory(), lookForValue = true, rate = 500): Promise {\n    const deferred = new Deferred()\n    debuglog('Started observing ', this, ' attribute ', attribute, ' for value ', lookForValue, ' current value ', this[attribute])\n    const checkForValue = () => {\n      if (this[attribute] === lookForValue) {\n        debuglog('Finished observing ', this, ' attribute ', attribute, ' for value ', lookForValue, ' current value ', this[attribute])\n        deferred.resolve(lookForValue)\n      } else {\n        debuglog('im still observing ', this, ' attribute ', attribute, ' for value ', lookForValue, ' current value ', this[attribute])\n        delay(rate).then(checkForValue)\n      }\n    }\n    checkForValue()\n    return deferred.promise\n  },\n  enumerable: false,\n})\n\n\n/**\n * isSuperset - Returns true if the set is a superset of the specified subset\n *\n * @param {Set} subset a set\n *\n * @returns {bool}\n */\nSet.prototype.isSuperset = function (subset) {\n  for (const elem of subset) {\n    if (!this.has(elem)) {\n      return false\n    }\n  }\n  return true\n}\n\nSet.prototype.union = function (setB) {\n  const union = new Set(this)\n  for (const elem of setB) {\n    union.add(elem)\n  }\n  return union\n}\n\nSet.prototype.sample = function (n = 1, repeat = true) {\n  const result = []\n  const array = Array.from(this)\n  for (let i = 0; i < n; i++) {\n    const index = _.random(0, array.length - 1)\n    result.push(array[index])\n    if (!repeat) {\n      array.splice(index, 1)\n    }\n  }\n  return result\n}\n\n/**\n * unite - Performs union in place. Replaces current set.\n *\n * @param {Set} setB\n *\n * @returns {undefined}\n */\nSet.prototype.unite = function (setB) {\n  for (const elem of setB) {\n    this.add(elem)\n  }\n  return undefined\n}\n\nSet.prototype.intersection = function (setB) {\n  const intersection = new Set()\n  for (const elem of setB) {\n    if (this.has(elem)) {\n      intersection.add(elem)\n    }\n  }\n  return intersection\n}\n\n\n/**\n * intersect - Performs an intersection in place (replace current set values)\n *\n * @param {Set} setB Description\n *\n * @returns {undefined}\n */\nSet.prototype.intersect = function (setB) {\n  for (const elem of this) {\n    if (!setB.has(elem)) {\n      this.remove(elem)\n    }\n  }\n  return undefined\n}\n\nSet.prototype.difference = function (setB) {\n  const difference = new Set(this)\n  for (const elem of setB) {\n    difference.delete(elem)\n  }\n  return difference\n}\n\nexport {\n  Array,\n  String,\n  Object,\n  Number,\n  Set,\n  diag,\n  rowSum,\n  getRow,\n  matrix,\n  samplePermutation,\n  rep,\n  Deferred,\n  recurse,\n  jitter,\n  delay,\n  looksLikeAPromise,\n  mustHaveConstructor,\n  mustBeDefined,\n  mandatory,\n  debuglog,\n  debugWarn,\n  debugError,\n  noop,\n  spreadToObject,\n  sizeToVec,\n  scaleSize,\n  hasConstructor,\n  preloadImages,\n  getQueryString,\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/framework/utilities.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"lodash\",\"commonjs2\":\"lodash\",\"amd\":\"lodash\",\"root\":\"_\"}\n// module id = 1\n// module chunks = 0","/* @preserve\n * The MIT License (MIT)\n * \n * Copyright (c) 2013-2017 Petka Antonov\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n * \n */\n/**\n * bluebird build version 3.5.0\n * Features enabled: core, race, call_get, generators, map, nodeify, promisify, props, reduce, settle, some, using, timers, filter, any, each\n*/\n!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var f;\"undefined\"!=typeof window?f=window:\"undefined\"!=typeof global?f=global:\"undefined\"!=typeof self&&(f=self),f.Promise=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof _dereq_==\"function\"&&_dereq_;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof _dereq_==\"function\"&&_dereq_;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nvar SomePromiseArray = Promise._SomePromiseArray;\nfunction any(promises) {\n    var ret = new SomePromiseArray(promises);\n    var promise = ret.promise();\n    ret.setHowMany(1);\n    ret.setUnwrap();\n    ret.init();\n    return promise;\n}\n\nPromise.any = function (promises) {\n    return any(promises);\n};\n\nPromise.prototype.any = function () {\n    return any(this);\n};\n\n};\n\n},{}],2:[function(_dereq_,module,exports){\n\"use strict\";\nvar firstLineError;\ntry {throw new Error(); } catch (e) {firstLineError = e;}\nvar schedule = _dereq_(\"./schedule\");\nvar Queue = _dereq_(\"./queue\");\nvar util = _dereq_(\"./util\");\n\nfunction Async() {\n    this._customScheduler = false;\n    this._isTickUsed = false;\n    this._lateQueue = new Queue(16);\n    this._normalQueue = new Queue(16);\n    this._haveDrainedQueues = false;\n    this._trampolineEnabled = true;\n    var self = this;\n    this.drainQueues = function () {\n        self._drainQueues();\n    };\n    this._schedule = schedule;\n}\n\nAsync.prototype.setScheduler = function(fn) {\n    var prev = this._schedule;\n    this._schedule = fn;\n    this._customScheduler = true;\n    return prev;\n};\n\nAsync.prototype.hasCustomScheduler = function() {\n    return this._customScheduler;\n};\n\nAsync.prototype.enableTrampoline = function() {\n    this._trampolineEnabled = true;\n};\n\nAsync.prototype.disableTrampolineIfNecessary = function() {\n    if (util.hasDevTools) {\n        this._trampolineEnabled = false;\n    }\n};\n\nAsync.prototype.haveItemsQueued = function () {\n    return this._isTickUsed || this._haveDrainedQueues;\n};\n\n\nAsync.prototype.fatalError = function(e, isNode) {\n    if (isNode) {\n        process.stderr.write(\"Fatal \" + (e instanceof Error ? e.stack : e) +\n            \"\\n\");\n        process.exit(2);\n    } else {\n        this.throwLater(e);\n    }\n};\n\nAsync.prototype.throwLater = function(fn, arg) {\n    if (arguments.length === 1) {\n        arg = fn;\n        fn = function () { throw arg; };\n    }\n    if (typeof setTimeout !== \"undefined\") {\n        setTimeout(function() {\n            fn(arg);\n        }, 0);\n    } else try {\n        this._schedule(function() {\n            fn(arg);\n        });\n    } catch (e) {\n        throw new Error(\"No async scheduler available\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n};\n\nfunction AsyncInvokeLater(fn, receiver, arg) {\n    this._lateQueue.push(fn, receiver, arg);\n    this._queueTick();\n}\n\nfunction AsyncInvoke(fn, receiver, arg) {\n    this._normalQueue.push(fn, receiver, arg);\n    this._queueTick();\n}\n\nfunction AsyncSettlePromises(promise) {\n    this._normalQueue._pushOne(promise);\n    this._queueTick();\n}\n\nif (!util.hasDevTools) {\n    Async.prototype.invokeLater = AsyncInvokeLater;\n    Async.prototype.invoke = AsyncInvoke;\n    Async.prototype.settlePromises = AsyncSettlePromises;\n} else {\n    Async.prototype.invokeLater = function (fn, receiver, arg) {\n        if (this._trampolineEnabled) {\n            AsyncInvokeLater.call(this, fn, receiver, arg);\n        } else {\n            this._schedule(function() {\n                setTimeout(function() {\n                    fn.call(receiver, arg);\n                }, 100);\n            });\n        }\n    };\n\n    Async.prototype.invoke = function (fn, receiver, arg) {\n        if (this._trampolineEnabled) {\n            AsyncInvoke.call(this, fn, receiver, arg);\n        } else {\n            this._schedule(function() {\n                fn.call(receiver, arg);\n            });\n        }\n    };\n\n    Async.prototype.settlePromises = function(promise) {\n        if (this._trampolineEnabled) {\n            AsyncSettlePromises.call(this, promise);\n        } else {\n            this._schedule(function() {\n                promise._settlePromises();\n            });\n        }\n    };\n}\n\nAsync.prototype._drainQueue = function(queue) {\n    while (queue.length() > 0) {\n        var fn = queue.shift();\n        if (typeof fn !== \"function\") {\n            fn._settlePromises();\n            continue;\n        }\n        var receiver = queue.shift();\n        var arg = queue.shift();\n        fn.call(receiver, arg);\n    }\n};\n\nAsync.prototype._drainQueues = function () {\n    this._drainQueue(this._normalQueue);\n    this._reset();\n    this._haveDrainedQueues = true;\n    this._drainQueue(this._lateQueue);\n};\n\nAsync.prototype._queueTick = function () {\n    if (!this._isTickUsed) {\n        this._isTickUsed = true;\n        this._schedule(this.drainQueues);\n    }\n};\n\nAsync.prototype._reset = function () {\n    this._isTickUsed = false;\n};\n\nmodule.exports = Async;\nmodule.exports.firstLineError = firstLineError;\n\n},{\"./queue\":26,\"./schedule\":29,\"./util\":36}],3:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL, tryConvertToPromise, debug) {\nvar calledBind = false;\nvar rejectThis = function(_, e) {\n    this._reject(e);\n};\n\nvar targetRejected = function(e, context) {\n    context.promiseRejectionQueued = true;\n    context.bindingPromise._then(rejectThis, rejectThis, null, this, e);\n};\n\nvar bindingResolved = function(thisArg, context) {\n    if (((this._bitField & 50397184) === 0)) {\n        this._resolveCallback(context.target);\n    }\n};\n\nvar bindingRejected = function(e, context) {\n    if (!context.promiseRejectionQueued) this._reject(e);\n};\n\nPromise.prototype.bind = function (thisArg) {\n    if (!calledBind) {\n        calledBind = true;\n        Promise.prototype._propagateFrom = debug.propagateFromFunction();\n        Promise.prototype._boundValue = debug.boundValueFunction();\n    }\n    var maybePromise = tryConvertToPromise(thisArg);\n    var ret = new Promise(INTERNAL);\n    ret._propagateFrom(this, 1);\n    var target = this._target();\n    ret._setBoundTo(maybePromise);\n    if (maybePromise instanceof Promise) {\n        var context = {\n            promiseRejectionQueued: false,\n            promise: ret,\n            target: target,\n            bindingPromise: maybePromise\n        };\n        target._then(INTERNAL, targetRejected, undefined, ret, context);\n        maybePromise._then(\n            bindingResolved, bindingRejected, undefined, ret, context);\n        ret._setOnCancel(maybePromise);\n    } else {\n        ret._resolveCallback(target);\n    }\n    return ret;\n};\n\nPromise.prototype._setBoundTo = function (obj) {\n    if (obj !== undefined) {\n        this._bitField = this._bitField | 2097152;\n        this._boundTo = obj;\n    } else {\n        this._bitField = this._bitField & (~2097152);\n    }\n};\n\nPromise.prototype._isBound = function () {\n    return (this._bitField & 2097152) === 2097152;\n};\n\nPromise.bind = function (thisArg, value) {\n    return Promise.resolve(value).bind(thisArg);\n};\n};\n\n},{}],4:[function(_dereq_,module,exports){\n\"use strict\";\nvar old;\nif (typeof Promise !== \"undefined\") old = Promise;\nfunction noConflict() {\n    try { if (Promise === bluebird) Promise = old; }\n    catch (e) {}\n    return bluebird;\n}\nvar bluebird = _dereq_(\"./promise\")();\nbluebird.noConflict = noConflict;\nmodule.exports = bluebird;\n\n},{\"./promise\":22}],5:[function(_dereq_,module,exports){\n\"use strict\";\nvar cr = Object.create;\nif (cr) {\n    var callerCache = cr(null);\n    var getterCache = cr(null);\n    callerCache[\" size\"] = getterCache[\" size\"] = 0;\n}\n\nmodule.exports = function(Promise) {\nvar util = _dereq_(\"./util\");\nvar canEvaluate = util.canEvaluate;\nvar isIdentifier = util.isIdentifier;\n\nvar getMethodCaller;\nvar getGetter;\nif (!true) {\nvar makeMethodCaller = function (methodName) {\n    return new Function(\"ensureMethod\", \"                                    \\n\\\n        return function(obj) {                                               \\n\\\n            'use strict'                                                     \\n\\\n            var len = this.length;                                           \\n\\\n            ensureMethod(obj, 'methodName');                                 \\n\\\n            switch(len) {                                                    \\n\\\n                case 1: return obj.methodName(this[0]);                      \\n\\\n                case 2: return obj.methodName(this[0], this[1]);             \\n\\\n                case 3: return obj.methodName(this[0], this[1], this[2]);    \\n\\\n                case 0: return obj.methodName();                             \\n\\\n                default:                                                     \\n\\\n                    return obj.methodName.apply(obj, this);                  \\n\\\n            }                                                                \\n\\\n        };                                                                   \\n\\\n        \".replace(/methodName/g, methodName))(ensureMethod);\n};\n\nvar makeGetter = function (propertyName) {\n    return new Function(\"obj\", \"                                             \\n\\\n        'use strict';                                                        \\n\\\n        return obj.propertyName;                                             \\n\\\n        \".replace(\"propertyName\", propertyName));\n};\n\nvar getCompiled = function(name, compiler, cache) {\n    var ret = cache[name];\n    if (typeof ret !== \"function\") {\n        if (!isIdentifier(name)) {\n            return null;\n        }\n        ret = compiler(name);\n        cache[name] = ret;\n        cache[\" size\"]++;\n        if (cache[\" size\"] > 512) {\n            var keys = Object.keys(cache);\n            for (var i = 0; i < 256; ++i) delete cache[keys[i]];\n            cache[\" size\"] = keys.length - 256;\n        }\n    }\n    return ret;\n};\n\ngetMethodCaller = function(name) {\n    return getCompiled(name, makeMethodCaller, callerCache);\n};\n\ngetGetter = function(name) {\n    return getCompiled(name, makeGetter, getterCache);\n};\n}\n\nfunction ensureMethod(obj, methodName) {\n    var fn;\n    if (obj != null) fn = obj[methodName];\n    if (typeof fn !== \"function\") {\n        var message = \"Object \" + util.classString(obj) + \" has no method '\" +\n            util.toString(methodName) + \"'\";\n        throw new Promise.TypeError(message);\n    }\n    return fn;\n}\n\nfunction caller(obj) {\n    var methodName = this.pop();\n    var fn = ensureMethod(obj, methodName);\n    return fn.apply(obj, this);\n}\nPromise.prototype.call = function (methodName) {\n    var args = [].slice.call(arguments, 1);;\n    if (!true) {\n        if (canEvaluate) {\n            var maybeCaller = getMethodCaller(methodName);\n            if (maybeCaller !== null) {\n                return this._then(\n                    maybeCaller, undefined, undefined, args, undefined);\n            }\n        }\n    }\n    args.push(methodName);\n    return this._then(caller, undefined, undefined, args, undefined);\n};\n\nfunction namedGetter(obj) {\n    return obj[this];\n}\nfunction indexedGetter(obj) {\n    var index = +this;\n    if (index < 0) index = Math.max(0, index + obj.length);\n    return obj[index];\n}\nPromise.prototype.get = function (propertyName) {\n    var isIndex = (typeof propertyName === \"number\");\n    var getter;\n    if (!isIndex) {\n        if (canEvaluate) {\n            var maybeGetter = getGetter(propertyName);\n            getter = maybeGetter !== null ? maybeGetter : namedGetter;\n        } else {\n            getter = namedGetter;\n        }\n    } else {\n        getter = indexedGetter;\n    }\n    return this._then(getter, undefined, undefined, propertyName, undefined);\n};\n};\n\n},{\"./util\":36}],6:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, PromiseArray, apiRejection, debug) {\nvar util = _dereq_(\"./util\");\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\nvar async = Promise._async;\n\nPromise.prototype[\"break\"] = Promise.prototype.cancel = function() {\n    if (!debug.cancellation()) return this._warn(\"cancellation is disabled\");\n\n    var promise = this;\n    var child = promise;\n    while (promise._isCancellable()) {\n        if (!promise._cancelBy(child)) {\n            if (child._isFollowing()) {\n                child._followee().cancel();\n            } else {\n                child._cancelBranched();\n            }\n            break;\n        }\n\n        var parent = promise._cancellationParent;\n        if (parent == null || !parent._isCancellable()) {\n            if (promise._isFollowing()) {\n                promise._followee().cancel();\n            } else {\n                promise._cancelBranched();\n            }\n            break;\n        } else {\n            if (promise._isFollowing()) promise._followee().cancel();\n            promise._setWillBeCancelled();\n            child = promise;\n            promise = parent;\n        }\n    }\n};\n\nPromise.prototype._branchHasCancelled = function() {\n    this._branchesRemainingToCancel--;\n};\n\nPromise.prototype._enoughBranchesHaveCancelled = function() {\n    return this._branchesRemainingToCancel === undefined ||\n           this._branchesRemainingToCancel <= 0;\n};\n\nPromise.prototype._cancelBy = function(canceller) {\n    if (canceller === this) {\n        this._branchesRemainingToCancel = 0;\n        this._invokeOnCancel();\n        return true;\n    } else {\n        this._branchHasCancelled();\n        if (this._enoughBranchesHaveCancelled()) {\n            this._invokeOnCancel();\n            return true;\n        }\n    }\n    return false;\n};\n\nPromise.prototype._cancelBranched = function() {\n    if (this._enoughBranchesHaveCancelled()) {\n        this._cancel();\n    }\n};\n\nPromise.prototype._cancel = function() {\n    if (!this._isCancellable()) return;\n    this._setCancelled();\n    async.invoke(this._cancelPromises, this, undefined);\n};\n\nPromise.prototype._cancelPromises = function() {\n    if (this._length() > 0) this._settlePromises();\n};\n\nPromise.prototype._unsetOnCancel = function() {\n    this._onCancelField = undefined;\n};\n\nPromise.prototype._isCancellable = function() {\n    return this.isPending() && !this._isCancelled();\n};\n\nPromise.prototype.isCancellable = function() {\n    return this.isPending() && !this.isCancelled();\n};\n\nPromise.prototype._doInvokeOnCancel = function(onCancelCallback, internalOnly) {\n    if (util.isArray(onCancelCallback)) {\n        for (var i = 0; i < onCancelCallback.length; ++i) {\n            this._doInvokeOnCancel(onCancelCallback[i], internalOnly);\n        }\n    } else if (onCancelCallback !== undefined) {\n        if (typeof onCancelCallback === \"function\") {\n            if (!internalOnly) {\n                var e = tryCatch(onCancelCallback).call(this._boundValue());\n                if (e === errorObj) {\n                    this._attachExtraTrace(e.e);\n                    async.throwLater(e.e);\n                }\n            }\n        } else {\n            onCancelCallback._resultCancelled(this);\n        }\n    }\n};\n\nPromise.prototype._invokeOnCancel = function() {\n    var onCancelCallback = this._onCancel();\n    this._unsetOnCancel();\n    async.invoke(this._doInvokeOnCancel, this, onCancelCallback);\n};\n\nPromise.prototype._invokeInternalOnCancel = function() {\n    if (this._isCancellable()) {\n        this._doInvokeOnCancel(this._onCancel(), true);\n        this._unsetOnCancel();\n    }\n};\n\nPromise.prototype._resultCancelled = function() {\n    this.cancel();\n};\n\n};\n\n},{\"./util\":36}],7:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(NEXT_FILTER) {\nvar util = _dereq_(\"./util\");\nvar getKeys = _dereq_(\"./es5\").keys;\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\n\nfunction catchFilter(instances, cb, promise) {\n    return function(e) {\n        var boundTo = promise._boundValue();\n        predicateLoop: for (var i = 0; i < instances.length; ++i) {\n            var item = instances[i];\n\n            if (item === Error ||\n                (item != null && item.prototype instanceof Error)) {\n                if (e instanceof item) {\n                    return tryCatch(cb).call(boundTo, e);\n                }\n            } else if (typeof item === \"function\") {\n                var matchesPredicate = tryCatch(item).call(boundTo, e);\n                if (matchesPredicate === errorObj) {\n                    return matchesPredicate;\n                } else if (matchesPredicate) {\n                    return tryCatch(cb).call(boundTo, e);\n                }\n            } else if (util.isObject(e)) {\n                var keys = getKeys(item);\n                for (var j = 0; j < keys.length; ++j) {\n                    var key = keys[j];\n                    if (item[key] != e[key]) {\n                        continue predicateLoop;\n                    }\n                }\n                return tryCatch(cb).call(boundTo, e);\n            }\n        }\n        return NEXT_FILTER;\n    };\n}\n\nreturn catchFilter;\n};\n\n},{\"./es5\":13,\"./util\":36}],8:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nvar longStackTraces = false;\nvar contextStack = [];\n\nPromise.prototype._promiseCreated = function() {};\nPromise.prototype._pushContext = function() {};\nPromise.prototype._popContext = function() {return null;};\nPromise._peekContext = Promise.prototype._peekContext = function() {};\n\nfunction Context() {\n    this._trace = new Context.CapturedTrace(peekContext());\n}\nContext.prototype._pushContext = function () {\n    if (this._trace !== undefined) {\n        this._trace._promiseCreated = null;\n        contextStack.push(this._trace);\n    }\n};\n\nContext.prototype._popContext = function () {\n    if (this._trace !== undefined) {\n        var trace = contextStack.pop();\n        var ret = trace._promiseCreated;\n        trace._promiseCreated = null;\n        return ret;\n    }\n    return null;\n};\n\nfunction createContext() {\n    if (longStackTraces) return new Context();\n}\n\nfunction peekContext() {\n    var lastIndex = contextStack.length - 1;\n    if (lastIndex >= 0) {\n        return contextStack[lastIndex];\n    }\n    return undefined;\n}\nContext.CapturedTrace = null;\nContext.create = createContext;\nContext.deactivateLongStackTraces = function() {};\nContext.activateLongStackTraces = function() {\n    var Promise_pushContext = Promise.prototype._pushContext;\n    var Promise_popContext = Promise.prototype._popContext;\n    var Promise_PeekContext = Promise._peekContext;\n    var Promise_peekContext = Promise.prototype._peekContext;\n    var Promise_promiseCreated = Promise.prototype._promiseCreated;\n    Context.deactivateLongStackTraces = function() {\n        Promise.prototype._pushContext = Promise_pushContext;\n        Promise.prototype._popContext = Promise_popContext;\n        Promise._peekContext = Promise_PeekContext;\n        Promise.prototype._peekContext = Promise_peekContext;\n        Promise.prototype._promiseCreated = Promise_promiseCreated;\n        longStackTraces = false;\n    };\n    longStackTraces = true;\n    Promise.prototype._pushContext = Context.prototype._pushContext;\n    Promise.prototype._popContext = Context.prototype._popContext;\n    Promise._peekContext = Promise.prototype._peekContext = peekContext;\n    Promise.prototype._promiseCreated = function() {\n        var ctx = this._peekContext();\n        if (ctx && ctx._promiseCreated == null) ctx._promiseCreated = this;\n    };\n};\nreturn Context;\n};\n\n},{}],9:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, Context) {\nvar getDomain = Promise._getDomain;\nvar async = Promise._async;\nvar Warning = _dereq_(\"./errors\").Warning;\nvar util = _dereq_(\"./util\");\nvar canAttachTrace = util.canAttachTrace;\nvar unhandledRejectionHandled;\nvar possiblyUnhandledRejection;\nvar bluebirdFramePattern =\n    /[\\\\\\/]bluebird[\\\\\\/]js[\\\\\\/](release|debug|instrumented)/;\nvar nodeFramePattern = /\\((?:timers\\.js):\\d+:\\d+\\)/;\nvar parseLinePattern = /[\\/<\\(](.+?):(\\d+):(\\d+)\\)?\\s*$/;\nvar stackFramePattern = null;\nvar formatStack = null;\nvar indentStackFrames = false;\nvar printWarning;\nvar debugging = !!(util.env(\"BLUEBIRD_DEBUG\") != 0 &&\n                        (true ||\n                         util.env(\"BLUEBIRD_DEBUG\") ||\n                         util.env(\"NODE_ENV\") === \"development\"));\n\nvar warnings = !!(util.env(\"BLUEBIRD_WARNINGS\") != 0 &&\n    (debugging || util.env(\"BLUEBIRD_WARNINGS\")));\n\nvar longStackTraces = !!(util.env(\"BLUEBIRD_LONG_STACK_TRACES\") != 0 &&\n    (debugging || util.env(\"BLUEBIRD_LONG_STACK_TRACES\")));\n\nvar wForgottenReturn = util.env(\"BLUEBIRD_W_FORGOTTEN_RETURN\") != 0 &&\n    (warnings || !!util.env(\"BLUEBIRD_W_FORGOTTEN_RETURN\"));\n\nPromise.prototype.suppressUnhandledRejections = function() {\n    var target = this._target();\n    target._bitField = ((target._bitField & (~1048576)) |\n                      524288);\n};\n\nPromise.prototype._ensurePossibleRejectionHandled = function () {\n    if ((this._bitField & 524288) !== 0) return;\n    this._setRejectionIsUnhandled();\n    async.invokeLater(this._notifyUnhandledRejection, this, undefined);\n};\n\nPromise.prototype._notifyUnhandledRejectionIsHandled = function () {\n    fireRejectionEvent(\"rejectionHandled\",\n                                  unhandledRejectionHandled, undefined, this);\n};\n\nPromise.prototype._setReturnedNonUndefined = function() {\n    this._bitField = this._bitField | 268435456;\n};\n\nPromise.prototype._returnedNonUndefined = function() {\n    return (this._bitField & 268435456) !== 0;\n};\n\nPromise.prototype._notifyUnhandledRejection = function () {\n    if (this._isRejectionUnhandled()) {\n        var reason = this._settledValue();\n        this._setUnhandledRejectionIsNotified();\n        fireRejectionEvent(\"unhandledRejection\",\n                                      possiblyUnhandledRejection, reason, this);\n    }\n};\n\nPromise.prototype._setUnhandledRejectionIsNotified = function () {\n    this._bitField = this._bitField | 262144;\n};\n\nPromise.prototype._unsetUnhandledRejectionIsNotified = function () {\n    this._bitField = this._bitField & (~262144);\n};\n\nPromise.prototype._isUnhandledRejectionNotified = function () {\n    return (this._bitField & 262144) > 0;\n};\n\nPromise.prototype._setRejectionIsUnhandled = function () {\n    this._bitField = this._bitField | 1048576;\n};\n\nPromise.prototype._unsetRejectionIsUnhandled = function () {\n    this._bitField = this._bitField & (~1048576);\n    if (this._isUnhandledRejectionNotified()) {\n        this._unsetUnhandledRejectionIsNotified();\n        this._notifyUnhandledRejectionIsHandled();\n    }\n};\n\nPromise.prototype._isRejectionUnhandled = function () {\n    return (this._bitField & 1048576) > 0;\n};\n\nPromise.prototype._warn = function(message, shouldUseOwnTrace, promise) {\n    return warn(message, shouldUseOwnTrace, promise || this);\n};\n\nPromise.onPossiblyUnhandledRejection = function (fn) {\n    var domain = getDomain();\n    possiblyUnhandledRejection =\n        typeof fn === \"function\" ? (domain === null ?\n                                            fn : util.domainBind(domain, fn))\n                                 : undefined;\n};\n\nPromise.onUnhandledRejectionHandled = function (fn) {\n    var domain = getDomain();\n    unhandledRejectionHandled =\n        typeof fn === \"function\" ? (domain === null ?\n                                            fn : util.domainBind(domain, fn))\n                                 : undefined;\n};\n\nvar disableLongStackTraces = function() {};\nPromise.longStackTraces = function () {\n    if (async.haveItemsQueued() && !config.longStackTraces) {\n        throw new Error(\"cannot enable long stack traces after promises have been created\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    if (!config.longStackTraces && longStackTracesIsSupported()) {\n        var Promise_captureStackTrace = Promise.prototype._captureStackTrace;\n        var Promise_attachExtraTrace = Promise.prototype._attachExtraTrace;\n        config.longStackTraces = true;\n        disableLongStackTraces = function() {\n            if (async.haveItemsQueued() && !config.longStackTraces) {\n                throw new Error(\"cannot enable long stack traces after promises have been created\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n            }\n            Promise.prototype._captureStackTrace = Promise_captureStackTrace;\n            Promise.prototype._attachExtraTrace = Promise_attachExtraTrace;\n            Context.deactivateLongStackTraces();\n            async.enableTrampoline();\n            config.longStackTraces = false;\n        };\n        Promise.prototype._captureStackTrace = longStackTracesCaptureStackTrace;\n        Promise.prototype._attachExtraTrace = longStackTracesAttachExtraTrace;\n        Context.activateLongStackTraces();\n        async.disableTrampolineIfNecessary();\n    }\n};\n\nPromise.hasLongStackTraces = function () {\n    return config.longStackTraces && longStackTracesIsSupported();\n};\n\nvar fireDomEvent = (function() {\n    try {\n        if (typeof CustomEvent === \"function\") {\n            var event = new CustomEvent(\"CustomEvent\");\n            util.global.dispatchEvent(event);\n            return function(name, event) {\n                var domEvent = new CustomEvent(name.toLowerCase(), {\n                    detail: event,\n                    cancelable: true\n                });\n                return !util.global.dispatchEvent(domEvent);\n            };\n        } else if (typeof Event === \"function\") {\n            var event = new Event(\"CustomEvent\");\n            util.global.dispatchEvent(event);\n            return function(name, event) {\n                var domEvent = new Event(name.toLowerCase(), {\n                    cancelable: true\n                });\n                domEvent.detail = event;\n                return !util.global.dispatchEvent(domEvent);\n            };\n        } else {\n            var event = document.createEvent(\"CustomEvent\");\n            event.initCustomEvent(\"testingtheevent\", false, true, {});\n            util.global.dispatchEvent(event);\n            return function(name, event) {\n                var domEvent = document.createEvent(\"CustomEvent\");\n                domEvent.initCustomEvent(name.toLowerCase(), false, true,\n                    event);\n                return !util.global.dispatchEvent(domEvent);\n            };\n        }\n    } catch (e) {}\n    return function() {\n        return false;\n    };\n})();\n\nvar fireGlobalEvent = (function() {\n    if (util.isNode) {\n        return function() {\n            return process.emit.apply(process, arguments);\n        };\n    } else {\n        if (!util.global) {\n            return function() {\n                return false;\n            };\n        }\n        return function(name) {\n            var methodName = \"on\" + name.toLowerCase();\n            var method = util.global[methodName];\n            if (!method) return false;\n            method.apply(util.global, [].slice.call(arguments, 1));\n            return true;\n        };\n    }\n})();\n\nfunction generatePromiseLifecycleEventObject(name, promise) {\n    return {promise: promise};\n}\n\nvar eventToObjectGenerator = {\n    promiseCreated: generatePromiseLifecycleEventObject,\n    promiseFulfilled: generatePromiseLifecycleEventObject,\n    promiseRejected: generatePromiseLifecycleEventObject,\n    promiseResolved: generatePromiseLifecycleEventObject,\n    promiseCancelled: generatePromiseLifecycleEventObject,\n    promiseChained: function(name, promise, child) {\n        return {promise: promise, child: child};\n    },\n    warning: function(name, warning) {\n        return {warning: warning};\n    },\n    unhandledRejection: function (name, reason, promise) {\n        return {reason: reason, promise: promise};\n    },\n    rejectionHandled: generatePromiseLifecycleEventObject\n};\n\nvar activeFireEvent = function (name) {\n    var globalEventFired = false;\n    try {\n        globalEventFired = fireGlobalEvent.apply(null, arguments);\n    } catch (e) {\n        async.throwLater(e);\n        globalEventFired = true;\n    }\n\n    var domEventFired = false;\n    try {\n        domEventFired = fireDomEvent(name,\n                    eventToObjectGenerator[name].apply(null, arguments));\n    } catch (e) {\n        async.throwLater(e);\n        domEventFired = true;\n    }\n\n    return domEventFired || globalEventFired;\n};\n\nPromise.config = function(opts) {\n    opts = Object(opts);\n    if (\"longStackTraces\" in opts) {\n        if (opts.longStackTraces) {\n            Promise.longStackTraces();\n        } else if (!opts.longStackTraces && Promise.hasLongStackTraces()) {\n            disableLongStackTraces();\n        }\n    }\n    if (\"warnings\" in opts) {\n        var warningsOption = opts.warnings;\n        config.warnings = !!warningsOption;\n        wForgottenReturn = config.warnings;\n\n        if (util.isObject(warningsOption)) {\n            if (\"wForgottenReturn\" in warningsOption) {\n                wForgottenReturn = !!warningsOption.wForgottenReturn;\n            }\n        }\n    }\n    if (\"cancellation\" in opts && opts.cancellation && !config.cancellation) {\n        if (async.haveItemsQueued()) {\n            throw new Error(\n                \"cannot enable cancellation after promises are in use\");\n        }\n        Promise.prototype._clearCancellationData =\n            cancellationClearCancellationData;\n        Promise.prototype._propagateFrom = cancellationPropagateFrom;\n        Promise.prototype._onCancel = cancellationOnCancel;\n        Promise.prototype._setOnCancel = cancellationSetOnCancel;\n        Promise.prototype._attachCancellationCallback =\n            cancellationAttachCancellationCallback;\n        Promise.prototype._execute = cancellationExecute;\n        propagateFromFunction = cancellationPropagateFrom;\n        config.cancellation = true;\n    }\n    if (\"monitoring\" in opts) {\n        if (opts.monitoring && !config.monitoring) {\n            config.monitoring = true;\n            Promise.prototype._fireEvent = activeFireEvent;\n        } else if (!opts.monitoring && config.monitoring) {\n            config.monitoring = false;\n            Promise.prototype._fireEvent = defaultFireEvent;\n        }\n    }\n    return Promise;\n};\n\nfunction defaultFireEvent() { return false; }\n\nPromise.prototype._fireEvent = defaultFireEvent;\nPromise.prototype._execute = function(executor, resolve, reject) {\n    try {\n        executor(resolve, reject);\n    } catch (e) {\n        return e;\n    }\n};\nPromise.prototype._onCancel = function () {};\nPromise.prototype._setOnCancel = function (handler) { ; };\nPromise.prototype._attachCancellationCallback = function(onCancel) {\n    ;\n};\nPromise.prototype._captureStackTrace = function () {};\nPromise.prototype._attachExtraTrace = function () {};\nPromise.prototype._clearCancellationData = function() {};\nPromise.prototype._propagateFrom = function (parent, flags) {\n    ;\n    ;\n};\n\nfunction cancellationExecute(executor, resolve, reject) {\n    var promise = this;\n    try {\n        executor(resolve, reject, function(onCancel) {\n            if (typeof onCancel !== \"function\") {\n                throw new TypeError(\"onCancel must be a function, got: \" +\n                                    util.toString(onCancel));\n            }\n            promise._attachCancellationCallback(onCancel);\n        });\n    } catch (e) {\n        return e;\n    }\n}\n\nfunction cancellationAttachCancellationCallback(onCancel) {\n    if (!this._isCancellable()) return this;\n\n    var previousOnCancel = this._onCancel();\n    if (previousOnCancel !== undefined) {\n        if (util.isArray(previousOnCancel)) {\n            previousOnCancel.push(onCancel);\n        } else {\n            this._setOnCancel([previousOnCancel, onCancel]);\n        }\n    } else {\n        this._setOnCancel(onCancel);\n    }\n}\n\nfunction cancellationOnCancel() {\n    return this._onCancelField;\n}\n\nfunction cancellationSetOnCancel(onCancel) {\n    this._onCancelField = onCancel;\n}\n\nfunction cancellationClearCancellationData() {\n    this._cancellationParent = undefined;\n    this._onCancelField = undefined;\n}\n\nfunction cancellationPropagateFrom(parent, flags) {\n    if ((flags & 1) !== 0) {\n        this._cancellationParent = parent;\n        var branchesRemainingToCancel = parent._branchesRemainingToCancel;\n        if (branchesRemainingToCancel === undefined) {\n            branchesRemainingToCancel = 0;\n        }\n        parent._branchesRemainingToCancel = branchesRemainingToCancel + 1;\n    }\n    if ((flags & 2) !== 0 && parent._isBound()) {\n        this._setBoundTo(parent._boundTo);\n    }\n}\n\nfunction bindingPropagateFrom(parent, flags) {\n    if ((flags & 2) !== 0 && parent._isBound()) {\n        this._setBoundTo(parent._boundTo);\n    }\n}\nvar propagateFromFunction = bindingPropagateFrom;\n\nfunction boundValueFunction() {\n    var ret = this._boundTo;\n    if (ret !== undefined) {\n        if (ret instanceof Promise) {\n            if (ret.isFulfilled()) {\n                return ret.value();\n            } else {\n                return undefined;\n            }\n        }\n    }\n    return ret;\n}\n\nfunction longStackTracesCaptureStackTrace() {\n    this._trace = new CapturedTrace(this._peekContext());\n}\n\nfunction longStackTracesAttachExtraTrace(error, ignoreSelf) {\n    if (canAttachTrace(error)) {\n        var trace = this._trace;\n        if (trace !== undefined) {\n            if (ignoreSelf) trace = trace._parent;\n        }\n        if (trace !== undefined) {\n            trace.attachExtraTrace(error);\n        } else if (!error.__stackCleaned__) {\n            var parsed = parseStackAndMessage(error);\n            util.notEnumerableProp(error, \"stack\",\n                parsed.message + \"\\n\" + parsed.stack.join(\"\\n\"));\n            util.notEnumerableProp(error, \"__stackCleaned__\", true);\n        }\n    }\n}\n\nfunction checkForgottenReturns(returnValue, promiseCreated, name, promise,\n                               parent) {\n    if (returnValue === undefined && promiseCreated !== null &&\n        wForgottenReturn) {\n        if (parent !== undefined && parent._returnedNonUndefined()) return;\n        if ((promise._bitField & 65535) === 0) return;\n\n        if (name) name = name + \" \";\n        var handlerLine = \"\";\n        var creatorLine = \"\";\n        if (promiseCreated._trace) {\n            var traceLines = promiseCreated._trace.stack.split(\"\\n\");\n            var stack = cleanStack(traceLines);\n            for (var i = stack.length - 1; i >= 0; --i) {\n                var line = stack[i];\n                if (!nodeFramePattern.test(line)) {\n                    var lineMatches = line.match(parseLinePattern);\n                    if (lineMatches) {\n                        handlerLine  = \"at \" + lineMatches[1] +\n                            \":\" + lineMatches[2] + \":\" + lineMatches[3] + \" \";\n                    }\n                    break;\n                }\n            }\n\n            if (stack.length > 0) {\n                var firstUserLine = stack[0];\n                for (var i = 0; i < traceLines.length; ++i) {\n\n                    if (traceLines[i] === firstUserLine) {\n                        if (i > 0) {\n                            creatorLine = \"\\n\" + traceLines[i - 1];\n                        }\n                        break;\n                    }\n                }\n\n            }\n        }\n        var msg = \"a promise was created in a \" + name +\n            \"handler \" + handlerLine + \"but was not returned from it, \" +\n            \"see http://goo.gl/rRqMUw\" +\n            creatorLine;\n        promise._warn(msg, true, promiseCreated);\n    }\n}\n\nfunction deprecated(name, replacement) {\n    var message = name +\n        \" is deprecated and will be removed in a future version.\";\n    if (replacement) message += \" Use \" + replacement + \" instead.\";\n    return warn(message);\n}\n\nfunction warn(message, shouldUseOwnTrace, promise) {\n    if (!config.warnings) return;\n    var warning = new Warning(message);\n    var ctx;\n    if (shouldUseOwnTrace) {\n        promise._attachExtraTrace(warning);\n    } else if (config.longStackTraces && (ctx = Promise._peekContext())) {\n        ctx.attachExtraTrace(warning);\n    } else {\n        var parsed = parseStackAndMessage(warning);\n        warning.stack = parsed.message + \"\\n\" + parsed.stack.join(\"\\n\");\n    }\n\n    if (!activeFireEvent(\"warning\", warning)) {\n        formatAndLogError(warning, \"\", true);\n    }\n}\n\nfunction reconstructStack(message, stacks) {\n    for (var i = 0; i < stacks.length - 1; ++i) {\n        stacks[i].push(\"From previous event:\");\n        stacks[i] = stacks[i].join(\"\\n\");\n    }\n    if (i < stacks.length) {\n        stacks[i] = stacks[i].join(\"\\n\");\n    }\n    return message + \"\\n\" + stacks.join(\"\\n\");\n}\n\nfunction removeDuplicateOrEmptyJumps(stacks) {\n    for (var i = 0; i < stacks.length; ++i) {\n        if (stacks[i].length === 0 ||\n            ((i + 1 < stacks.length) && stacks[i][0] === stacks[i+1][0])) {\n            stacks.splice(i, 1);\n            i--;\n        }\n    }\n}\n\nfunction removeCommonRoots(stacks) {\n    var current = stacks[0];\n    for (var i = 1; i < stacks.length; ++i) {\n        var prev = stacks[i];\n        var currentLastIndex = current.length - 1;\n        var currentLastLine = current[currentLastIndex];\n        var commonRootMeetPoint = -1;\n\n        for (var j = prev.length - 1; j >= 0; --j) {\n            if (prev[j] === currentLastLine) {\n                commonRootMeetPoint = j;\n                break;\n            }\n        }\n\n        for (var j = commonRootMeetPoint; j >= 0; --j) {\n            var line = prev[j];\n            if (current[currentLastIndex] === line) {\n                current.pop();\n                currentLastIndex--;\n            } else {\n                break;\n            }\n        }\n        current = prev;\n    }\n}\n\nfunction cleanStack(stack) {\n    var ret = [];\n    for (var i = 0; i < stack.length; ++i) {\n        var line = stack[i];\n        var isTraceLine = \"    (No stack trace)\" === line ||\n            stackFramePattern.test(line);\n        var isInternalFrame = isTraceLine && shouldIgnore(line);\n        if (isTraceLine && !isInternalFrame) {\n            if (indentStackFrames && line.charAt(0) !== \" \") {\n                line = \"    \" + line;\n            }\n            ret.push(line);\n        }\n    }\n    return ret;\n}\n\nfunction stackFramesAsArray(error) {\n    var stack = error.stack.replace(/\\s+$/g, \"\").split(\"\\n\");\n    for (var i = 0; i < stack.length; ++i) {\n        var line = stack[i];\n        if (\"    (No stack trace)\" === line || stackFramePattern.test(line)) {\n            break;\n        }\n    }\n    if (i > 0 && error.name != \"SyntaxError\") {\n        stack = stack.slice(i);\n    }\n    return stack;\n}\n\nfunction parseStackAndMessage(error) {\n    var stack = error.stack;\n    var message = error.toString();\n    stack = typeof stack === \"string\" && stack.length > 0\n                ? stackFramesAsArray(error) : [\"    (No stack trace)\"];\n    return {\n        message: message,\n        stack: error.name == \"SyntaxError\" ? stack : cleanStack(stack)\n    };\n}\n\nfunction formatAndLogError(error, title, isSoft) {\n    if (typeof console !== \"undefined\") {\n        var message;\n        if (util.isObject(error)) {\n            var stack = error.stack;\n            message = title + formatStack(stack, error);\n        } else {\n            message = title + String(error);\n        }\n        if (typeof printWarning === \"function\") {\n            printWarning(message, isSoft);\n        } else if (typeof console.log === \"function\" ||\n            typeof console.log === \"object\") {\n            console.log(message);\n        }\n    }\n}\n\nfunction fireRejectionEvent(name, localHandler, reason, promise) {\n    var localEventFired = false;\n    try {\n        if (typeof localHandler === \"function\") {\n            localEventFired = true;\n            if (name === \"rejectionHandled\") {\n                localHandler(promise);\n            } else {\n                localHandler(reason, promise);\n            }\n        }\n    } catch (e) {\n        async.throwLater(e);\n    }\n\n    if (name === \"unhandledRejection\") {\n        if (!activeFireEvent(name, reason, promise) && !localEventFired) {\n            formatAndLogError(reason, \"Unhandled rejection \");\n        }\n    } else {\n        activeFireEvent(name, promise);\n    }\n}\n\nfunction formatNonError(obj) {\n    var str;\n    if (typeof obj === \"function\") {\n        str = \"[function \" +\n            (obj.name || \"anonymous\") +\n            \"]\";\n    } else {\n        str = obj && typeof obj.toString === \"function\"\n            ? obj.toString() : util.toString(obj);\n        var ruselessToString = /\\[object [a-zA-Z0-9$_]+\\]/;\n        if (ruselessToString.test(str)) {\n            try {\n                var newStr = JSON.stringify(obj);\n                str = newStr;\n            }\n            catch(e) {\n\n            }\n        }\n        if (str.length === 0) {\n            str = \"(empty array)\";\n        }\n    }\n    return (\"(<\" + snip(str) + \">, no stack trace)\");\n}\n\nfunction snip(str) {\n    var maxChars = 41;\n    if (str.length < maxChars) {\n        return str;\n    }\n    return str.substr(0, maxChars - 3) + \"...\";\n}\n\nfunction longStackTracesIsSupported() {\n    return typeof captureStackTrace === \"function\";\n}\n\nvar shouldIgnore = function() { return false; };\nvar parseLineInfoRegex = /[\\/<\\(]([^:\\/]+):(\\d+):(?:\\d+)\\)?\\s*$/;\nfunction parseLineInfo(line) {\n    var matches = line.match(parseLineInfoRegex);\n    if (matches) {\n        return {\n            fileName: matches[1],\n            line: parseInt(matches[2], 10)\n        };\n    }\n}\n\nfunction setBounds(firstLineError, lastLineError) {\n    if (!longStackTracesIsSupported()) return;\n    var firstStackLines = firstLineError.stack.split(\"\\n\");\n    var lastStackLines = lastLineError.stack.split(\"\\n\");\n    var firstIndex = -1;\n    var lastIndex = -1;\n    var firstFileName;\n    var lastFileName;\n    for (var i = 0; i < firstStackLines.length; ++i) {\n        var result = parseLineInfo(firstStackLines[i]);\n        if (result) {\n            firstFileName = result.fileName;\n            firstIndex = result.line;\n            break;\n        }\n    }\n    for (var i = 0; i < lastStackLines.length; ++i) {\n        var result = parseLineInfo(lastStackLines[i]);\n        if (result) {\n            lastFileName = result.fileName;\n            lastIndex = result.line;\n            break;\n        }\n    }\n    if (firstIndex < 0 || lastIndex < 0 || !firstFileName || !lastFileName ||\n        firstFileName !== lastFileName || firstIndex >= lastIndex) {\n        return;\n    }\n\n    shouldIgnore = function(line) {\n        if (bluebirdFramePattern.test(line)) return true;\n        var info = parseLineInfo(line);\n        if (info) {\n            if (info.fileName === firstFileName &&\n                (firstIndex <= info.line && info.line <= lastIndex)) {\n                return true;\n            }\n        }\n        return false;\n    };\n}\n\nfunction CapturedTrace(parent) {\n    this._parent = parent;\n    this._promisesCreated = 0;\n    var length = this._length = 1 + (parent === undefined ? 0 : parent._length);\n    captureStackTrace(this, CapturedTrace);\n    if (length > 32) this.uncycle();\n}\nutil.inherits(CapturedTrace, Error);\nContext.CapturedTrace = CapturedTrace;\n\nCapturedTrace.prototype.uncycle = function() {\n    var length = this._length;\n    if (length < 2) return;\n    var nodes = [];\n    var stackToIndex = {};\n\n    for (var i = 0, node = this; node !== undefined; ++i) {\n        nodes.push(node);\n        node = node._parent;\n    }\n    length = this._length = i;\n    for (var i = length - 1; i >= 0; --i) {\n        var stack = nodes[i].stack;\n        if (stackToIndex[stack] === undefined) {\n            stackToIndex[stack] = i;\n        }\n    }\n    for (var i = 0; i < length; ++i) {\n        var currentStack = nodes[i].stack;\n        var index = stackToIndex[currentStack];\n        if (index !== undefined && index !== i) {\n            if (index > 0) {\n                nodes[index - 1]._parent = undefined;\n                nodes[index - 1]._length = 1;\n            }\n            nodes[i]._parent = undefined;\n            nodes[i]._length = 1;\n            var cycleEdgeNode = i > 0 ? nodes[i - 1] : this;\n\n            if (index < length - 1) {\n                cycleEdgeNode._parent = nodes[index + 1];\n                cycleEdgeNode._parent.uncycle();\n                cycleEdgeNode._length =\n                    cycleEdgeNode._parent._length + 1;\n            } else {\n                cycleEdgeNode._parent = undefined;\n                cycleEdgeNode._length = 1;\n            }\n            var currentChildLength = cycleEdgeNode._length + 1;\n            for (var j = i - 2; j >= 0; --j) {\n                nodes[j]._length = currentChildLength;\n                currentChildLength++;\n            }\n            return;\n        }\n    }\n};\n\nCapturedTrace.prototype.attachExtraTrace = function(error) {\n    if (error.__stackCleaned__) return;\n    this.uncycle();\n    var parsed = parseStackAndMessage(error);\n    var message = parsed.message;\n    var stacks = [parsed.stack];\n\n    var trace = this;\n    while (trace !== undefined) {\n        stacks.push(cleanStack(trace.stack.split(\"\\n\")));\n        trace = trace._parent;\n    }\n    removeCommonRoots(stacks);\n    removeDuplicateOrEmptyJumps(stacks);\n    util.notEnumerableProp(error, \"stack\", reconstructStack(message, stacks));\n    util.notEnumerableProp(error, \"__stackCleaned__\", true);\n};\n\nvar captureStackTrace = (function stackDetection() {\n    var v8stackFramePattern = /^\\s*at\\s*/;\n    var v8stackFormatter = function(stack, error) {\n        if (typeof stack === \"string\") return stack;\n\n        if (error.name !== undefined &&\n            error.message !== undefined) {\n            return error.toString();\n        }\n        return formatNonError(error);\n    };\n\n    if (typeof Error.stackTraceLimit === \"number\" &&\n        typeof Error.captureStackTrace === \"function\") {\n        Error.stackTraceLimit += 6;\n        stackFramePattern = v8stackFramePattern;\n        formatStack = v8stackFormatter;\n        var captureStackTrace = Error.captureStackTrace;\n\n        shouldIgnore = function(line) {\n            return bluebirdFramePattern.test(line);\n        };\n        return function(receiver, ignoreUntil) {\n            Error.stackTraceLimit += 6;\n            captureStackTrace(receiver, ignoreUntil);\n            Error.stackTraceLimit -= 6;\n        };\n    }\n    var err = new Error();\n\n    if (typeof err.stack === \"string\" &&\n        err.stack.split(\"\\n\")[0].indexOf(\"stackDetection@\") >= 0) {\n        stackFramePattern = /@/;\n        formatStack = v8stackFormatter;\n        indentStackFrames = true;\n        return function captureStackTrace(o) {\n            o.stack = new Error().stack;\n        };\n    }\n\n    var hasStackAfterThrow;\n    try { throw new Error(); }\n    catch(e) {\n        hasStackAfterThrow = (\"stack\" in e);\n    }\n    if (!(\"stack\" in err) && hasStackAfterThrow &&\n        typeof Error.stackTraceLimit === \"number\") {\n        stackFramePattern = v8stackFramePattern;\n        formatStack = v8stackFormatter;\n        return function captureStackTrace(o) {\n            Error.stackTraceLimit += 6;\n            try { throw new Error(); }\n            catch(e) { o.stack = e.stack; }\n            Error.stackTraceLimit -= 6;\n        };\n    }\n\n    formatStack = function(stack, error) {\n        if (typeof stack === \"string\") return stack;\n\n        if ((typeof error === \"object\" ||\n            typeof error === \"function\") &&\n            error.name !== undefined &&\n            error.message !== undefined) {\n            return error.toString();\n        }\n        return formatNonError(error);\n    };\n\n    return null;\n\n})([]);\n\nif (typeof console !== \"undefined\" && typeof console.warn !== \"undefined\") {\n    printWarning = function (message) {\n        console.warn(message);\n    };\n    if (util.isNode && process.stderr.isTTY) {\n        printWarning = function(message, isSoft) {\n            var color = isSoft ? \"\\u001b[33m\" : \"\\u001b[31m\";\n            console.warn(color + message + \"\\u001b[0m\\n\");\n        };\n    } else if (!util.isNode && typeof (new Error().stack) === \"string\") {\n        printWarning = function(message, isSoft) {\n            console.warn(\"%c\" + message,\n                        isSoft ? \"color: darkorange\" : \"color: red\");\n        };\n    }\n}\n\nvar config = {\n    warnings: warnings,\n    longStackTraces: false,\n    cancellation: false,\n    monitoring: false\n};\n\nif (longStackTraces) Promise.longStackTraces();\n\nreturn {\n    longStackTraces: function() {\n        return config.longStackTraces;\n    },\n    warnings: function() {\n        return config.warnings;\n    },\n    cancellation: function() {\n        return config.cancellation;\n    },\n    monitoring: function() {\n        return config.monitoring;\n    },\n    propagateFromFunction: function() {\n        return propagateFromFunction;\n    },\n    boundValueFunction: function() {\n        return boundValueFunction;\n    },\n    checkForgottenReturns: checkForgottenReturns,\n    setBounds: setBounds,\n    warn: warn,\n    deprecated: deprecated,\n    CapturedTrace: CapturedTrace,\n    fireDomEvent: fireDomEvent,\n    fireGlobalEvent: fireGlobalEvent\n};\n};\n\n},{\"./errors\":12,\"./util\":36}],10:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nfunction returner() {\n    return this.value;\n}\nfunction thrower() {\n    throw this.reason;\n}\n\nPromise.prototype[\"return\"] =\nPromise.prototype.thenReturn = function (value) {\n    if (value instanceof Promise) value.suppressUnhandledRejections();\n    return this._then(\n        returner, undefined, undefined, {value: value}, undefined);\n};\n\nPromise.prototype[\"throw\"] =\nPromise.prototype.thenThrow = function (reason) {\n    return this._then(\n        thrower, undefined, undefined, {reason: reason}, undefined);\n};\n\nPromise.prototype.catchThrow = function (reason) {\n    if (arguments.length <= 1) {\n        return this._then(\n            undefined, thrower, undefined, {reason: reason}, undefined);\n    } else {\n        var _reason = arguments[1];\n        var handler = function() {throw _reason;};\n        return this.caught(reason, handler);\n    }\n};\n\nPromise.prototype.catchReturn = function (value) {\n    if (arguments.length <= 1) {\n        if (value instanceof Promise) value.suppressUnhandledRejections();\n        return this._then(\n            undefined, returner, undefined, {value: value}, undefined);\n    } else {\n        var _value = arguments[1];\n        if (_value instanceof Promise) _value.suppressUnhandledRejections();\n        var handler = function() {return _value;};\n        return this.caught(value, handler);\n    }\n};\n};\n\n},{}],11:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar PromiseReduce = Promise.reduce;\nvar PromiseAll = Promise.all;\n\nfunction promiseAllThis() {\n    return PromiseAll(this);\n}\n\nfunction PromiseMapSeries(promises, fn) {\n    return PromiseReduce(promises, fn, INTERNAL, INTERNAL);\n}\n\nPromise.prototype.each = function (fn) {\n    return PromiseReduce(this, fn, INTERNAL, 0)\n              ._then(promiseAllThis, undefined, undefined, this, undefined);\n};\n\nPromise.prototype.mapSeries = function (fn) {\n    return PromiseReduce(this, fn, INTERNAL, INTERNAL);\n};\n\nPromise.each = function (promises, fn) {\n    return PromiseReduce(promises, fn, INTERNAL, 0)\n              ._then(promiseAllThis, undefined, undefined, promises, undefined);\n};\n\nPromise.mapSeries = PromiseMapSeries;\n};\n\n\n},{}],12:[function(_dereq_,module,exports){\n\"use strict\";\nvar es5 = _dereq_(\"./es5\");\nvar Objectfreeze = es5.freeze;\nvar util = _dereq_(\"./util\");\nvar inherits = util.inherits;\nvar notEnumerableProp = util.notEnumerableProp;\n\nfunction subError(nameProperty, defaultMessage) {\n    function SubError(message) {\n        if (!(this instanceof SubError)) return new SubError(message);\n        notEnumerableProp(this, \"message\",\n            typeof message === \"string\" ? message : defaultMessage);\n        notEnumerableProp(this, \"name\", nameProperty);\n        if (Error.captureStackTrace) {\n            Error.captureStackTrace(this, this.constructor);\n        } else {\n            Error.call(this);\n        }\n    }\n    inherits(SubError, Error);\n    return SubError;\n}\n\nvar _TypeError, _RangeError;\nvar Warning = subError(\"Warning\", \"warning\");\nvar CancellationError = subError(\"CancellationError\", \"cancellation error\");\nvar TimeoutError = subError(\"TimeoutError\", \"timeout error\");\nvar AggregateError = subError(\"AggregateError\", \"aggregate error\");\ntry {\n    _TypeError = TypeError;\n    _RangeError = RangeError;\n} catch(e) {\n    _TypeError = subError(\"TypeError\", \"type error\");\n    _RangeError = subError(\"RangeError\", \"range error\");\n}\n\nvar methods = (\"join pop push shift unshift slice filter forEach some \" +\n    \"every map indexOf lastIndexOf reduce reduceRight sort reverse\").split(\" \");\n\nfor (var i = 0; i < methods.length; ++i) {\n    if (typeof Array.prototype[methods[i]] === \"function\") {\n        AggregateError.prototype[methods[i]] = Array.prototype[methods[i]];\n    }\n}\n\nes5.defineProperty(AggregateError.prototype, \"length\", {\n    value: 0,\n    configurable: false,\n    writable: true,\n    enumerable: true\n});\nAggregateError.prototype[\"isOperational\"] = true;\nvar level = 0;\nAggregateError.prototype.toString = function() {\n    var indent = Array(level * 4 + 1).join(\" \");\n    var ret = \"\\n\" + indent + \"AggregateError of:\" + \"\\n\";\n    level++;\n    indent = Array(level * 4 + 1).join(\" \");\n    for (var i = 0; i < this.length; ++i) {\n        var str = this[i] === this ? \"[Circular AggregateError]\" : this[i] + \"\";\n        var lines = str.split(\"\\n\");\n        for (var j = 0; j < lines.length; ++j) {\n            lines[j] = indent + lines[j];\n        }\n        str = lines.join(\"\\n\");\n        ret += str + \"\\n\";\n    }\n    level--;\n    return ret;\n};\n\nfunction OperationalError(message) {\n    if (!(this instanceof OperationalError))\n        return new OperationalError(message);\n    notEnumerableProp(this, \"name\", \"OperationalError\");\n    notEnumerableProp(this, \"message\", message);\n    this.cause = message;\n    this[\"isOperational\"] = true;\n\n    if (message instanceof Error) {\n        notEnumerableProp(this, \"message\", message.message);\n        notEnumerableProp(this, \"stack\", message.stack);\n    } else if (Error.captureStackTrace) {\n        Error.captureStackTrace(this, this.constructor);\n    }\n\n}\ninherits(OperationalError, Error);\n\nvar errorTypes = Error[\"__BluebirdErrorTypes__\"];\nif (!errorTypes) {\n    errorTypes = Objectfreeze({\n        CancellationError: CancellationError,\n        TimeoutError: TimeoutError,\n        OperationalError: OperationalError,\n        RejectionError: OperationalError,\n        AggregateError: AggregateError\n    });\n    es5.defineProperty(Error, \"__BluebirdErrorTypes__\", {\n        value: errorTypes,\n        writable: false,\n        enumerable: false,\n        configurable: false\n    });\n}\n\nmodule.exports = {\n    Error: Error,\n    TypeError: _TypeError,\n    RangeError: _RangeError,\n    CancellationError: errorTypes.CancellationError,\n    OperationalError: errorTypes.OperationalError,\n    TimeoutError: errorTypes.TimeoutError,\n    AggregateError: errorTypes.AggregateError,\n    Warning: Warning\n};\n\n},{\"./es5\":13,\"./util\":36}],13:[function(_dereq_,module,exports){\nvar isES5 = (function(){\n    \"use strict\";\n    return this === undefined;\n})();\n\nif (isES5) {\n    module.exports = {\n        freeze: Object.freeze,\n        defineProperty: Object.defineProperty,\n        getDescriptor: Object.getOwnPropertyDescriptor,\n        keys: Object.keys,\n        names: Object.getOwnPropertyNames,\n        getPrototypeOf: Object.getPrototypeOf,\n        isArray: Array.isArray,\n        isES5: isES5,\n        propertyIsWritable: function(obj, prop) {\n            var descriptor = Object.getOwnPropertyDescriptor(obj, prop);\n            return !!(!descriptor || descriptor.writable || descriptor.set);\n        }\n    };\n} else {\n    var has = {}.hasOwnProperty;\n    var str = {}.toString;\n    var proto = {}.constructor.prototype;\n\n    var ObjectKeys = function (o) {\n        var ret = [];\n        for (var key in o) {\n            if (has.call(o, key)) {\n                ret.push(key);\n            }\n        }\n        return ret;\n    };\n\n    var ObjectGetDescriptor = function(o, key) {\n        return {value: o[key]};\n    };\n\n    var ObjectDefineProperty = function (o, key, desc) {\n        o[key] = desc.value;\n        return o;\n    };\n\n    var ObjectFreeze = function (obj) {\n        return obj;\n    };\n\n    var ObjectGetPrototypeOf = function (obj) {\n        try {\n            return Object(obj).constructor.prototype;\n        }\n        catch (e) {\n            return proto;\n        }\n    };\n\n    var ArrayIsArray = function (obj) {\n        try {\n            return str.call(obj) === \"[object Array]\";\n        }\n        catch(e) {\n            return false;\n        }\n    };\n\n    module.exports = {\n        isArray: ArrayIsArray,\n        keys: ObjectKeys,\n        names: ObjectKeys,\n        defineProperty: ObjectDefineProperty,\n        getDescriptor: ObjectGetDescriptor,\n        freeze: ObjectFreeze,\n        getPrototypeOf: ObjectGetPrototypeOf,\n        isES5: isES5,\n        propertyIsWritable: function() {\n            return true;\n        }\n    };\n}\n\n},{}],14:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar PromiseMap = Promise.map;\n\nPromise.prototype.filter = function (fn, options) {\n    return PromiseMap(this, fn, options, INTERNAL);\n};\n\nPromise.filter = function (promises, fn, options) {\n    return PromiseMap(promises, fn, options, INTERNAL);\n};\n};\n\n},{}],15:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, tryConvertToPromise, NEXT_FILTER) {\nvar util = _dereq_(\"./util\");\nvar CancellationError = Promise.CancellationError;\nvar errorObj = util.errorObj;\nvar catchFilter = _dereq_(\"./catch_filter\")(NEXT_FILTER);\n\nfunction PassThroughHandlerContext(promise, type, handler) {\n    this.promise = promise;\n    this.type = type;\n    this.handler = handler;\n    this.called = false;\n    this.cancelPromise = null;\n}\n\nPassThroughHandlerContext.prototype.isFinallyHandler = function() {\n    return this.type === 0;\n};\n\nfunction FinallyHandlerCancelReaction(finallyHandler) {\n    this.finallyHandler = finallyHandler;\n}\n\nFinallyHandlerCancelReaction.prototype._resultCancelled = function() {\n    checkCancel(this.finallyHandler);\n};\n\nfunction checkCancel(ctx, reason) {\n    if (ctx.cancelPromise != null) {\n        if (arguments.length > 1) {\n            ctx.cancelPromise._reject(reason);\n        } else {\n            ctx.cancelPromise._cancel();\n        }\n        ctx.cancelPromise = null;\n        return true;\n    }\n    return false;\n}\n\nfunction succeed() {\n    return finallyHandler.call(this, this.promise._target()._settledValue());\n}\nfunction fail(reason) {\n    if (checkCancel(this, reason)) return;\n    errorObj.e = reason;\n    return errorObj;\n}\nfunction finallyHandler(reasonOrValue) {\n    var promise = this.promise;\n    var handler = this.handler;\n\n    if (!this.called) {\n        this.called = true;\n        var ret = this.isFinallyHandler()\n            ? handler.call(promise._boundValue())\n            : handler.call(promise._boundValue(), reasonOrValue);\n        if (ret === NEXT_FILTER) {\n            return ret;\n        } else if (ret !== undefined) {\n            promise._setReturnedNonUndefined();\n            var maybePromise = tryConvertToPromise(ret, promise);\n            if (maybePromise instanceof Promise) {\n                if (this.cancelPromise != null) {\n                    if (maybePromise._isCancelled()) {\n                        var reason =\n                            new CancellationError(\"late cancellation observer\");\n                        promise._attachExtraTrace(reason);\n                        errorObj.e = reason;\n                        return errorObj;\n                    } else if (maybePromise.isPending()) {\n                        maybePromise._attachCancellationCallback(\n                            new FinallyHandlerCancelReaction(this));\n                    }\n                }\n                return maybePromise._then(\n                    succeed, fail, undefined, this, undefined);\n            }\n        }\n    }\n\n    if (promise.isRejected()) {\n        checkCancel(this);\n        errorObj.e = reasonOrValue;\n        return errorObj;\n    } else {\n        checkCancel(this);\n        return reasonOrValue;\n    }\n}\n\nPromise.prototype._passThrough = function(handler, type, success, fail) {\n    if (typeof handler !== \"function\") return this.then();\n    return this._then(success,\n                      fail,\n                      undefined,\n                      new PassThroughHandlerContext(this, type, handler),\n                      undefined);\n};\n\nPromise.prototype.lastly =\nPromise.prototype[\"finally\"] = function (handler) {\n    return this._passThrough(handler,\n                             0,\n                             finallyHandler,\n                             finallyHandler);\n};\n\n\nPromise.prototype.tap = function (handler) {\n    return this._passThrough(handler, 1, finallyHandler);\n};\n\nPromise.prototype.tapCatch = function (handlerOrPredicate) {\n    var len = arguments.length;\n    if(len === 1) {\n        return this._passThrough(handlerOrPredicate,\n                                 1,\n                                 undefined,\n                                 finallyHandler);\n    } else {\n         var catchInstances = new Array(len - 1),\n            j = 0, i;\n        for (i = 0; i < len - 1; ++i) {\n            var item = arguments[i];\n            if (util.isObject(item)) {\n                catchInstances[j++] = item;\n            } else {\n                return Promise.reject(new TypeError(\n                    \"tapCatch statement predicate: \"\n                    + \"expecting an object but got \" + util.classString(item)\n                ));\n            }\n        }\n        catchInstances.length = j;\n        var handler = arguments[i];\n        return this._passThrough(catchFilter(catchInstances, handler, this),\n                                 1,\n                                 undefined,\n                                 finallyHandler);\n    }\n\n};\n\nreturn PassThroughHandlerContext;\n};\n\n},{\"./catch_filter\":7,\"./util\":36}],16:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise,\n                          apiRejection,\n                          INTERNAL,\n                          tryConvertToPromise,\n                          Proxyable,\n                          debug) {\nvar errors = _dereq_(\"./errors\");\nvar TypeError = errors.TypeError;\nvar util = _dereq_(\"./util\");\nvar errorObj = util.errorObj;\nvar tryCatch = util.tryCatch;\nvar yieldHandlers = [];\n\nfunction promiseFromYieldHandler(value, yieldHandlers, traceParent) {\n    for (var i = 0; i < yieldHandlers.length; ++i) {\n        traceParent._pushContext();\n        var result = tryCatch(yieldHandlers[i])(value);\n        traceParent._popContext();\n        if (result === errorObj) {\n            traceParent._pushContext();\n            var ret = Promise.reject(errorObj.e);\n            traceParent._popContext();\n            return ret;\n        }\n        var maybePromise = tryConvertToPromise(result, traceParent);\n        if (maybePromise instanceof Promise) return maybePromise;\n    }\n    return null;\n}\n\nfunction PromiseSpawn(generatorFunction, receiver, yieldHandler, stack) {\n    if (debug.cancellation()) {\n        var internal = new Promise(INTERNAL);\n        var _finallyPromise = this._finallyPromise = new Promise(INTERNAL);\n        this._promise = internal.lastly(function() {\n            return _finallyPromise;\n        });\n        internal._captureStackTrace();\n        internal._setOnCancel(this);\n    } else {\n        var promise = this._promise = new Promise(INTERNAL);\n        promise._captureStackTrace();\n    }\n    this._stack = stack;\n    this._generatorFunction = generatorFunction;\n    this._receiver = receiver;\n    this._generator = undefined;\n    this._yieldHandlers = typeof yieldHandler === \"function\"\n        ? [yieldHandler].concat(yieldHandlers)\n        : yieldHandlers;\n    this._yieldedPromise = null;\n    this._cancellationPhase = false;\n}\nutil.inherits(PromiseSpawn, Proxyable);\n\nPromiseSpawn.prototype._isResolved = function() {\n    return this._promise === null;\n};\n\nPromiseSpawn.prototype._cleanup = function() {\n    this._promise = this._generator = null;\n    if (debug.cancellation() && this._finallyPromise !== null) {\n        this._finallyPromise._fulfill();\n        this._finallyPromise = null;\n    }\n};\n\nPromiseSpawn.prototype._promiseCancelled = function() {\n    if (this._isResolved()) return;\n    var implementsReturn = typeof this._generator[\"return\"] !== \"undefined\";\n\n    var result;\n    if (!implementsReturn) {\n        var reason = new Promise.CancellationError(\n            \"generator .return() sentinel\");\n        Promise.coroutine.returnSentinel = reason;\n        this._promise._attachExtraTrace(reason);\n        this._promise._pushContext();\n        result = tryCatch(this._generator[\"throw\"]).call(this._generator,\n                                                         reason);\n        this._promise._popContext();\n    } else {\n        this._promise._pushContext();\n        result = tryCatch(this._generator[\"return\"]).call(this._generator,\n                                                          undefined);\n        this._promise._popContext();\n    }\n    this._cancellationPhase = true;\n    this._yieldedPromise = null;\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._promiseFulfilled = function(value) {\n    this._yieldedPromise = null;\n    this._promise._pushContext();\n    var result = tryCatch(this._generator.next).call(this._generator, value);\n    this._promise._popContext();\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._promiseRejected = function(reason) {\n    this._yieldedPromise = null;\n    this._promise._attachExtraTrace(reason);\n    this._promise._pushContext();\n    var result = tryCatch(this._generator[\"throw\"])\n        .call(this._generator, reason);\n    this._promise._popContext();\n    this._continue(result);\n};\n\nPromiseSpawn.prototype._resultCancelled = function() {\n    if (this._yieldedPromise instanceof Promise) {\n        var promise = this._yieldedPromise;\n        this._yieldedPromise = null;\n        promise.cancel();\n    }\n};\n\nPromiseSpawn.prototype.promise = function () {\n    return this._promise;\n};\n\nPromiseSpawn.prototype._run = function () {\n    this._generator = this._generatorFunction.call(this._receiver);\n    this._receiver =\n        this._generatorFunction = undefined;\n    this._promiseFulfilled(undefined);\n};\n\nPromiseSpawn.prototype._continue = function (result) {\n    var promise = this._promise;\n    if (result === errorObj) {\n        this._cleanup();\n        if (this._cancellationPhase) {\n            return promise.cancel();\n        } else {\n            return promise._rejectCallback(result.e, false);\n        }\n    }\n\n    var value = result.value;\n    if (result.done === true) {\n        this._cleanup();\n        if (this._cancellationPhase) {\n            return promise.cancel();\n        } else {\n            return promise._resolveCallback(value);\n        }\n    } else {\n        var maybePromise = tryConvertToPromise(value, this._promise);\n        if (!(maybePromise instanceof Promise)) {\n            maybePromise =\n                promiseFromYieldHandler(maybePromise,\n                                        this._yieldHandlers,\n                                        this._promise);\n            if (maybePromise === null) {\n                this._promiseRejected(\n                    new TypeError(\n                        \"A value %s was yielded that could not be treated as a promise\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\\u000a\".replace(\"%s\", String(value)) +\n                        \"From coroutine:\\u000a\" +\n                        this._stack.split(\"\\n\").slice(1, -7).join(\"\\n\")\n                    )\n                );\n                return;\n            }\n        }\n        maybePromise = maybePromise._target();\n        var bitField = maybePromise._bitField;\n        ;\n        if (((bitField & 50397184) === 0)) {\n            this._yieldedPromise = maybePromise;\n            maybePromise._proxy(this, null);\n        } else if (((bitField & 33554432) !== 0)) {\n            Promise._async.invoke(\n                this._promiseFulfilled, this, maybePromise._value()\n            );\n        } else if (((bitField & 16777216) !== 0)) {\n            Promise._async.invoke(\n                this._promiseRejected, this, maybePromise._reason()\n            );\n        } else {\n            this._promiseCancelled();\n        }\n    }\n};\n\nPromise.coroutine = function (generatorFunction, options) {\n    if (typeof generatorFunction !== \"function\") {\n        throw new TypeError(\"generatorFunction must be a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var yieldHandler = Object(options).yieldHandler;\n    var PromiseSpawn$ = PromiseSpawn;\n    var stack = new Error().stack;\n    return function () {\n        var generator = generatorFunction.apply(this, arguments);\n        var spawn = new PromiseSpawn$(undefined, undefined, yieldHandler,\n                                      stack);\n        var ret = spawn.promise();\n        spawn._generator = generator;\n        spawn._promiseFulfilled(undefined);\n        return ret;\n    };\n};\n\nPromise.coroutine.addYieldHandler = function(fn) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    yieldHandlers.push(fn);\n};\n\nPromise.spawn = function (generatorFunction) {\n    debug.deprecated(\"Promise.spawn()\", \"Promise.coroutine()\");\n    if (typeof generatorFunction !== \"function\") {\n        return apiRejection(\"generatorFunction must be a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var spawn = new PromiseSpawn(generatorFunction, this);\n    var ret = spawn.promise();\n    spawn._run(Promise.spawn);\n    return ret;\n};\n};\n\n},{\"./errors\":12,\"./util\":36}],17:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports =\nfunction(Promise, PromiseArray, tryConvertToPromise, INTERNAL, async,\n         getDomain) {\nvar util = _dereq_(\"./util\");\nvar canEvaluate = util.canEvaluate;\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\nvar reject;\n\nif (!true) {\nif (canEvaluate) {\n    var thenCallback = function(i) {\n        return new Function(\"value\", \"holder\", \"                             \\n\\\n            'use strict';                                                    \\n\\\n            holder.pIndex = value;                                           \\n\\\n            holder.checkFulfillment(this);                                   \\n\\\n            \".replace(/Index/g, i));\n    };\n\n    var promiseSetter = function(i) {\n        return new Function(\"promise\", \"holder\", \"                           \\n\\\n            'use strict';                                                    \\n\\\n            holder.pIndex = promise;                                         \\n\\\n            \".replace(/Index/g, i));\n    };\n\n    var generateHolderClass = function(total) {\n        var props = new Array(total);\n        for (var i = 0; i < props.length; ++i) {\n            props[i] = \"this.p\" + (i+1);\n        }\n        var assignment = props.join(\" = \") + \" = null;\";\n        var cancellationCode= \"var promise;\\n\" + props.map(function(prop) {\n            return \"                                                         \\n\\\n                promise = \" + prop + \";                                      \\n\\\n                if (promise instanceof Promise) {                            \\n\\\n                    promise.cancel();                                        \\n\\\n                }                                                            \\n\\\n            \";\n        }).join(\"\\n\");\n        var passedArguments = props.join(\", \");\n        var name = \"Holder$\" + total;\n\n\n        var code = \"return function(tryCatch, errorObj, Promise, async) {    \\n\\\n            'use strict';                                                    \\n\\\n            function [TheName](fn) {                                         \\n\\\n                [TheProperties]                                              \\n\\\n                this.fn = fn;                                                \\n\\\n                this.asyncNeeded = true;                                     \\n\\\n                this.now = 0;                                                \\n\\\n            }                                                                \\n\\\n                                                                             \\n\\\n            [TheName].prototype._callFunction = function(promise) {          \\n\\\n                promise._pushContext();                                      \\n\\\n                var ret = tryCatch(this.fn)([ThePassedArguments]);           \\n\\\n                promise._popContext();                                       \\n\\\n                if (ret === errorObj) {                                      \\n\\\n                    promise._rejectCallback(ret.e, false);                   \\n\\\n                } else {                                                     \\n\\\n                    promise._resolveCallback(ret);                           \\n\\\n                }                                                            \\n\\\n            };                                                               \\n\\\n                                                                             \\n\\\n            [TheName].prototype.checkFulfillment = function(promise) {       \\n\\\n                var now = ++this.now;                                        \\n\\\n                if (now === [TheTotal]) {                                    \\n\\\n                    if (this.asyncNeeded) {                                  \\n\\\n                        async.invoke(this._callFunction, this, promise);     \\n\\\n                    } else {                                                 \\n\\\n                        this._callFunction(promise);                         \\n\\\n                    }                                                        \\n\\\n                                                                             \\n\\\n                }                                                            \\n\\\n            };                                                               \\n\\\n                                                                             \\n\\\n            [TheName].prototype._resultCancelled = function() {              \\n\\\n                [CancellationCode]                                           \\n\\\n            };                                                               \\n\\\n                                                                             \\n\\\n            return [TheName];                                                \\n\\\n        }(tryCatch, errorObj, Promise, async);                               \\n\\\n        \";\n\n        code = code.replace(/\\[TheName\\]/g, name)\n            .replace(/\\[TheTotal\\]/g, total)\n            .replace(/\\[ThePassedArguments\\]/g, passedArguments)\n            .replace(/\\[TheProperties\\]/g, assignment)\n            .replace(/\\[CancellationCode\\]/g, cancellationCode);\n\n        return new Function(\"tryCatch\", \"errorObj\", \"Promise\", \"async\", code)\n                           (tryCatch, errorObj, Promise, async);\n    };\n\n    var holderClasses = [];\n    var thenCallbacks = [];\n    var promiseSetters = [];\n\n    for (var i = 0; i < 8; ++i) {\n        holderClasses.push(generateHolderClass(i + 1));\n        thenCallbacks.push(thenCallback(i + 1));\n        promiseSetters.push(promiseSetter(i + 1));\n    }\n\n    reject = function (reason) {\n        this._reject(reason);\n    };\n}}\n\nPromise.join = function () {\n    var last = arguments.length - 1;\n    var fn;\n    if (last > 0 && typeof arguments[last] === \"function\") {\n        fn = arguments[last];\n        if (!true) {\n            if (last <= 8 && canEvaluate) {\n                var ret = new Promise(INTERNAL);\n                ret._captureStackTrace();\n                var HolderClass = holderClasses[last - 1];\n                var holder = new HolderClass(fn);\n                var callbacks = thenCallbacks;\n\n                for (var i = 0; i < last; ++i) {\n                    var maybePromise = tryConvertToPromise(arguments[i], ret);\n                    if (maybePromise instanceof Promise) {\n                        maybePromise = maybePromise._target();\n                        var bitField = maybePromise._bitField;\n                        ;\n                        if (((bitField & 50397184) === 0)) {\n                            maybePromise._then(callbacks[i], reject,\n                                               undefined, ret, holder);\n                            promiseSetters[i](maybePromise, holder);\n                            holder.asyncNeeded = false;\n                        } else if (((bitField & 33554432) !== 0)) {\n                            callbacks[i].call(ret,\n                                              maybePromise._value(), holder);\n                        } else if (((bitField & 16777216) !== 0)) {\n                            ret._reject(maybePromise._reason());\n                        } else {\n                            ret._cancel();\n                        }\n                    } else {\n                        callbacks[i].call(ret, maybePromise, holder);\n                    }\n                }\n\n                if (!ret._isFateSealed()) {\n                    if (holder.asyncNeeded) {\n                        var domain = getDomain();\n                        if (domain !== null) {\n                            holder.fn = util.domainBind(domain, holder.fn);\n                        }\n                    }\n                    ret._setAsyncGuaranteed();\n                    ret._setOnCancel(holder);\n                }\n                return ret;\n            }\n        }\n    }\n    var args = [].slice.call(arguments);;\n    if (fn) args.pop();\n    var ret = new PromiseArray(args).promise();\n    return fn !== undefined ? ret.spread(fn) : ret;\n};\n\n};\n\n},{\"./util\":36}],18:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise,\n                          PromiseArray,\n                          apiRejection,\n                          tryConvertToPromise,\n                          INTERNAL,\n                          debug) {\nvar getDomain = Promise._getDomain;\nvar util = _dereq_(\"./util\");\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\nvar async = Promise._async;\n\nfunction MappingPromiseArray(promises, fn, limit, _filter) {\n    this.constructor$(promises);\n    this._promise._captureStackTrace();\n    var domain = getDomain();\n    this._callback = domain === null ? fn : util.domainBind(domain, fn);\n    this._preservedValues = _filter === INTERNAL\n        ? new Array(this.length())\n        : null;\n    this._limit = limit;\n    this._inFlight = 0;\n    this._queue = [];\n    async.invoke(this._asyncInit, this, undefined);\n}\nutil.inherits(MappingPromiseArray, PromiseArray);\n\nMappingPromiseArray.prototype._asyncInit = function() {\n    this._init$(undefined, -2);\n};\n\nMappingPromiseArray.prototype._init = function () {};\n\nMappingPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    var values = this._values;\n    var length = this.length();\n    var preservedValues = this._preservedValues;\n    var limit = this._limit;\n\n    if (index < 0) {\n        index = (index * -1) - 1;\n        values[index] = value;\n        if (limit >= 1) {\n            this._inFlight--;\n            this._drainQueue();\n            if (this._isResolved()) return true;\n        }\n    } else {\n        if (limit >= 1 && this._inFlight >= limit) {\n            values[index] = value;\n            this._queue.push(index);\n            return false;\n        }\n        if (preservedValues !== null) preservedValues[index] = value;\n\n        var promise = this._promise;\n        var callback = this._callback;\n        var receiver = promise._boundValue();\n        promise._pushContext();\n        var ret = tryCatch(callback).call(receiver, value, index, length);\n        var promiseCreated = promise._popContext();\n        debug.checkForgottenReturns(\n            ret,\n            promiseCreated,\n            preservedValues !== null ? \"Promise.filter\" : \"Promise.map\",\n            promise\n        );\n        if (ret === errorObj) {\n            this._reject(ret.e);\n            return true;\n        }\n\n        var maybePromise = tryConvertToPromise(ret, this._promise);\n        if (maybePromise instanceof Promise) {\n            maybePromise = maybePromise._target();\n            var bitField = maybePromise._bitField;\n            ;\n            if (((bitField & 50397184) === 0)) {\n                if (limit >= 1) this._inFlight++;\n                values[index] = maybePromise;\n                maybePromise._proxy(this, (index + 1) * -1);\n                return false;\n            } else if (((bitField & 33554432) !== 0)) {\n                ret = maybePromise._value();\n            } else if (((bitField & 16777216) !== 0)) {\n                this._reject(maybePromise._reason());\n                return true;\n            } else {\n                this._cancel();\n                return true;\n            }\n        }\n        values[index] = ret;\n    }\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= length) {\n        if (preservedValues !== null) {\n            this._filter(values, preservedValues);\n        } else {\n            this._resolve(values);\n        }\n        return true;\n    }\n    return false;\n};\n\nMappingPromiseArray.prototype._drainQueue = function () {\n    var queue = this._queue;\n    var limit = this._limit;\n    var values = this._values;\n    while (queue.length > 0 && this._inFlight < limit) {\n        if (this._isResolved()) return;\n        var index = queue.pop();\n        this._promiseFulfilled(values[index], index);\n    }\n};\n\nMappingPromiseArray.prototype._filter = function (booleans, values) {\n    var len = values.length;\n    var ret = new Array(len);\n    var j = 0;\n    for (var i = 0; i < len; ++i) {\n        if (booleans[i]) ret[j++] = values[i];\n    }\n    ret.length = j;\n    this._resolve(ret);\n};\n\nMappingPromiseArray.prototype.preservedValues = function () {\n    return this._preservedValues;\n};\n\nfunction map(promises, fn, options, _filter) {\n    if (typeof fn !== \"function\") {\n        return apiRejection(\"expecting a function but got \" + util.classString(fn));\n    }\n\n    var limit = 0;\n    if (options !== undefined) {\n        if (typeof options === \"object\" && options !== null) {\n            if (typeof options.concurrency !== \"number\") {\n                return Promise.reject(\n                    new TypeError(\"'concurrency' must be a number but it is \" +\n                                    util.classString(options.concurrency)));\n            }\n            limit = options.concurrency;\n        } else {\n            return Promise.reject(new TypeError(\n                            \"options argument must be an object but it is \" +\n                             util.classString(options)));\n        }\n    }\n    limit = typeof limit === \"number\" &&\n        isFinite(limit) && limit >= 1 ? limit : 0;\n    return new MappingPromiseArray(promises, fn, limit, _filter).promise();\n}\n\nPromise.prototype.map = function (fn, options) {\n    return map(this, fn, options, null);\n};\n\nPromise.map = function (promises, fn, options, _filter) {\n    return map(promises, fn, options, _filter);\n};\n\n\n};\n\n},{\"./util\":36}],19:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports =\nfunction(Promise, INTERNAL, tryConvertToPromise, apiRejection, debug) {\nvar util = _dereq_(\"./util\");\nvar tryCatch = util.tryCatch;\n\nPromise.method = function (fn) {\n    if (typeof fn !== \"function\") {\n        throw new Promise.TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    return function () {\n        var ret = new Promise(INTERNAL);\n        ret._captureStackTrace();\n        ret._pushContext();\n        var value = tryCatch(fn).apply(this, arguments);\n        var promiseCreated = ret._popContext();\n        debug.checkForgottenReturns(\n            value, promiseCreated, \"Promise.method\", ret);\n        ret._resolveFromSyncValue(value);\n        return ret;\n    };\n};\n\nPromise.attempt = Promise[\"try\"] = function (fn) {\n    if (typeof fn !== \"function\") {\n        return apiRejection(\"expecting a function but got \" + util.classString(fn));\n    }\n    var ret = new Promise(INTERNAL);\n    ret._captureStackTrace();\n    ret._pushContext();\n    var value;\n    if (arguments.length > 1) {\n        debug.deprecated(\"calling Promise.try with more than 1 argument\");\n        var arg = arguments[1];\n        var ctx = arguments[2];\n        value = util.isArray(arg) ? tryCatch(fn).apply(ctx, arg)\n                                  : tryCatch(fn).call(ctx, arg);\n    } else {\n        value = tryCatch(fn)();\n    }\n    var promiseCreated = ret._popContext();\n    debug.checkForgottenReturns(\n        value, promiseCreated, \"Promise.try\", ret);\n    ret._resolveFromSyncValue(value);\n    return ret;\n};\n\nPromise.prototype._resolveFromSyncValue = function (value) {\n    if (value === util.errorObj) {\n        this._rejectCallback(value.e, false);\n    } else {\n        this._resolveCallback(value, true);\n    }\n};\n};\n\n},{\"./util\":36}],20:[function(_dereq_,module,exports){\n\"use strict\";\nvar util = _dereq_(\"./util\");\nvar maybeWrapAsError = util.maybeWrapAsError;\nvar errors = _dereq_(\"./errors\");\nvar OperationalError = errors.OperationalError;\nvar es5 = _dereq_(\"./es5\");\n\nfunction isUntypedError(obj) {\n    return obj instanceof Error &&\n        es5.getPrototypeOf(obj) === Error.prototype;\n}\n\nvar rErrorKey = /^(?:name|message|stack|cause)$/;\nfunction wrapAsOperationalError(obj) {\n    var ret;\n    if (isUntypedError(obj)) {\n        ret = new OperationalError(obj);\n        ret.name = obj.name;\n        ret.message = obj.message;\n        ret.stack = obj.stack;\n        var keys = es5.keys(obj);\n        for (var i = 0; i < keys.length; ++i) {\n            var key = keys[i];\n            if (!rErrorKey.test(key)) {\n                ret[key] = obj[key];\n            }\n        }\n        return ret;\n    }\n    util.markAsOriginatingFromRejection(obj);\n    return obj;\n}\n\nfunction nodebackForPromise(promise, multiArgs) {\n    return function(err, value) {\n        if (promise === null) return;\n        if (err) {\n            var wrapped = wrapAsOperationalError(maybeWrapAsError(err));\n            promise._attachExtraTrace(wrapped);\n            promise._reject(wrapped);\n        } else if (!multiArgs) {\n            promise._fulfill(value);\n        } else {\n            var args = [].slice.call(arguments, 1);;\n            promise._fulfill(args);\n        }\n        promise = null;\n    };\n}\n\nmodule.exports = nodebackForPromise;\n\n},{\"./errors\":12,\"./es5\":13,\"./util\":36}],21:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nvar util = _dereq_(\"./util\");\nvar async = Promise._async;\nvar tryCatch = util.tryCatch;\nvar errorObj = util.errorObj;\n\nfunction spreadAdapter(val, nodeback) {\n    var promise = this;\n    if (!util.isArray(val)) return successAdapter.call(promise, val, nodeback);\n    var ret =\n        tryCatch(nodeback).apply(promise._boundValue(), [null].concat(val));\n    if (ret === errorObj) {\n        async.throwLater(ret.e);\n    }\n}\n\nfunction successAdapter(val, nodeback) {\n    var promise = this;\n    var receiver = promise._boundValue();\n    var ret = val === undefined\n        ? tryCatch(nodeback).call(receiver, null)\n        : tryCatch(nodeback).call(receiver, null, val);\n    if (ret === errorObj) {\n        async.throwLater(ret.e);\n    }\n}\nfunction errorAdapter(reason, nodeback) {\n    var promise = this;\n    if (!reason) {\n        var newReason = new Error(reason + \"\");\n        newReason.cause = reason;\n        reason = newReason;\n    }\n    var ret = tryCatch(nodeback).call(promise._boundValue(), reason);\n    if (ret === errorObj) {\n        async.throwLater(ret.e);\n    }\n}\n\nPromise.prototype.asCallback = Promise.prototype.nodeify = function (nodeback,\n                                                                     options) {\n    if (typeof nodeback == \"function\") {\n        var adapter = successAdapter;\n        if (options !== undefined && Object(options).spread) {\n            adapter = spreadAdapter;\n        }\n        this._then(\n            adapter,\n            errorAdapter,\n            undefined,\n            this,\n            nodeback\n        );\n    }\n    return this;\n};\n};\n\n},{\"./util\":36}],22:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function() {\nvar makeSelfResolutionError = function () {\n    return new TypeError(\"circular promise resolution chain\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n};\nvar reflectHandler = function() {\n    return new Promise.PromiseInspection(this._target());\n};\nvar apiRejection = function(msg) {\n    return Promise.reject(new TypeError(msg));\n};\nfunction Proxyable() {}\nvar UNDEFINED_BINDING = {};\nvar util = _dereq_(\"./util\");\n\nvar getDomain;\nif (util.isNode) {\n    getDomain = function() {\n        var ret = process.domain;\n        if (ret === undefined) ret = null;\n        return ret;\n    };\n} else {\n    getDomain = function() {\n        return null;\n    };\n}\nutil.notEnumerableProp(Promise, \"_getDomain\", getDomain);\n\nvar es5 = _dereq_(\"./es5\");\nvar Async = _dereq_(\"./async\");\nvar async = new Async();\nes5.defineProperty(Promise, \"_async\", {value: async});\nvar errors = _dereq_(\"./errors\");\nvar TypeError = Promise.TypeError = errors.TypeError;\nPromise.RangeError = errors.RangeError;\nvar CancellationError = Promise.CancellationError = errors.CancellationError;\nPromise.TimeoutError = errors.TimeoutError;\nPromise.OperationalError = errors.OperationalError;\nPromise.RejectionError = errors.OperationalError;\nPromise.AggregateError = errors.AggregateError;\nvar INTERNAL = function(){};\nvar APPLY = {};\nvar NEXT_FILTER = {};\nvar tryConvertToPromise = _dereq_(\"./thenables\")(Promise, INTERNAL);\nvar PromiseArray =\n    _dereq_(\"./promise_array\")(Promise, INTERNAL,\n                               tryConvertToPromise, apiRejection, Proxyable);\nvar Context = _dereq_(\"./context\")(Promise);\n /*jshint unused:false*/\nvar createContext = Context.create;\nvar debug = _dereq_(\"./debuggability\")(Promise, Context);\nvar CapturedTrace = debug.CapturedTrace;\nvar PassThroughHandlerContext =\n    _dereq_(\"./finally\")(Promise, tryConvertToPromise, NEXT_FILTER);\nvar catchFilter = _dereq_(\"./catch_filter\")(NEXT_FILTER);\nvar nodebackForPromise = _dereq_(\"./nodeback\");\nvar errorObj = util.errorObj;\nvar tryCatch = util.tryCatch;\nfunction check(self, executor) {\n    if (self == null || self.constructor !== Promise) {\n        throw new TypeError(\"the promise constructor cannot be invoked directly\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    if (typeof executor !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(executor));\n    }\n\n}\n\nfunction Promise(executor) {\n    if (executor !== INTERNAL) {\n        check(this, executor);\n    }\n    this._bitField = 0;\n    this._fulfillmentHandler0 = undefined;\n    this._rejectionHandler0 = undefined;\n    this._promise0 = undefined;\n    this._receiver0 = undefined;\n    this._resolveFromExecutor(executor);\n    this._promiseCreated();\n    this._fireEvent(\"promiseCreated\", this);\n}\n\nPromise.prototype.toString = function () {\n    return \"[object Promise]\";\n};\n\nPromise.prototype.caught = Promise.prototype[\"catch\"] = function (fn) {\n    var len = arguments.length;\n    if (len > 1) {\n        var catchInstances = new Array(len - 1),\n            j = 0, i;\n        for (i = 0; i < len - 1; ++i) {\n            var item = arguments[i];\n            if (util.isObject(item)) {\n                catchInstances[j++] = item;\n            } else {\n                return apiRejection(\"Catch statement predicate: \" +\n                    \"expecting an object but got \" + util.classString(item));\n            }\n        }\n        catchInstances.length = j;\n        fn = arguments[i];\n        return this.then(undefined, catchFilter(catchInstances, fn, this));\n    }\n    return this.then(undefined, fn);\n};\n\nPromise.prototype.reflect = function () {\n    return this._then(reflectHandler,\n        reflectHandler, undefined, this, undefined);\n};\n\nPromise.prototype.then = function (didFulfill, didReject) {\n    if (debug.warnings() && arguments.length > 0 &&\n        typeof didFulfill !== \"function\" &&\n        typeof didReject !== \"function\") {\n        var msg = \".then() only accepts functions but was passed: \" +\n                util.classString(didFulfill);\n        if (arguments.length > 1) {\n            msg += \", \" + util.classString(didReject);\n        }\n        this._warn(msg);\n    }\n    return this._then(didFulfill, didReject, undefined, undefined, undefined);\n};\n\nPromise.prototype.done = function (didFulfill, didReject) {\n    var promise =\n        this._then(didFulfill, didReject, undefined, undefined, undefined);\n    promise._setIsFinal();\n};\n\nPromise.prototype.spread = function (fn) {\n    if (typeof fn !== \"function\") {\n        return apiRejection(\"expecting a function but got \" + util.classString(fn));\n    }\n    return this.all()._then(fn, undefined, undefined, APPLY, undefined);\n};\n\nPromise.prototype.toJSON = function () {\n    var ret = {\n        isFulfilled: false,\n        isRejected: false,\n        fulfillmentValue: undefined,\n        rejectionReason: undefined\n    };\n    if (this.isFulfilled()) {\n        ret.fulfillmentValue = this.value();\n        ret.isFulfilled = true;\n    } else if (this.isRejected()) {\n        ret.rejectionReason = this.reason();\n        ret.isRejected = true;\n    }\n    return ret;\n};\n\nPromise.prototype.all = function () {\n    if (arguments.length > 0) {\n        this._warn(\".all() was passed arguments but it does not take any\");\n    }\n    return new PromiseArray(this).promise();\n};\n\nPromise.prototype.error = function (fn) {\n    return this.caught(util.originatesFromRejection, fn);\n};\n\nPromise.getNewLibraryCopy = module.exports;\n\nPromise.is = function (val) {\n    return val instanceof Promise;\n};\n\nPromise.fromNode = Promise.fromCallback = function(fn) {\n    var ret = new Promise(INTERNAL);\n    ret._captureStackTrace();\n    var multiArgs = arguments.length > 1 ? !!Object(arguments[1]).multiArgs\n                                         : false;\n    var result = tryCatch(fn)(nodebackForPromise(ret, multiArgs));\n    if (result === errorObj) {\n        ret._rejectCallback(result.e, true);\n    }\n    if (!ret._isFateSealed()) ret._setAsyncGuaranteed();\n    return ret;\n};\n\nPromise.all = function (promises) {\n    return new PromiseArray(promises).promise();\n};\n\nPromise.cast = function (obj) {\n    var ret = tryConvertToPromise(obj);\n    if (!(ret instanceof Promise)) {\n        ret = new Promise(INTERNAL);\n        ret._captureStackTrace();\n        ret._setFulfilled();\n        ret._rejectionHandler0 = obj;\n    }\n    return ret;\n};\n\nPromise.resolve = Promise.fulfilled = Promise.cast;\n\nPromise.reject = Promise.rejected = function (reason) {\n    var ret = new Promise(INTERNAL);\n    ret._captureStackTrace();\n    ret._rejectCallback(reason, true);\n    return ret;\n};\n\nPromise.setScheduler = function(fn) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    return async.setScheduler(fn);\n};\n\nPromise.prototype._then = function (\n    didFulfill,\n    didReject,\n    _,    receiver,\n    internalData\n) {\n    var haveInternalData = internalData !== undefined;\n    var promise = haveInternalData ? internalData : new Promise(INTERNAL);\n    var target = this._target();\n    var bitField = target._bitField;\n\n    if (!haveInternalData) {\n        promise._propagateFrom(this, 3);\n        promise._captureStackTrace();\n        if (receiver === undefined &&\n            ((this._bitField & 2097152) !== 0)) {\n            if (!((bitField & 50397184) === 0)) {\n                receiver = this._boundValue();\n            } else {\n                receiver = target === this ? undefined : this._boundTo;\n            }\n        }\n        this._fireEvent(\"promiseChained\", this, promise);\n    }\n\n    var domain = getDomain();\n    if (!((bitField & 50397184) === 0)) {\n        var handler, value, settler = target._settlePromiseCtx;\n        if (((bitField & 33554432) !== 0)) {\n            value = target._rejectionHandler0;\n            handler = didFulfill;\n        } else if (((bitField & 16777216) !== 0)) {\n            value = target._fulfillmentHandler0;\n            handler = didReject;\n            target._unsetRejectionIsUnhandled();\n        } else {\n            settler = target._settlePromiseLateCancellationObserver;\n            value = new CancellationError(\"late cancellation observer\");\n            target._attachExtraTrace(value);\n            handler = didReject;\n        }\n\n        async.invoke(settler, target, {\n            handler: domain === null ? handler\n                : (typeof handler === \"function\" &&\n                    util.domainBind(domain, handler)),\n            promise: promise,\n            receiver: receiver,\n            value: value\n        });\n    } else {\n        target._addCallbacks(didFulfill, didReject, promise, receiver, domain);\n    }\n\n    return promise;\n};\n\nPromise.prototype._length = function () {\n    return this._bitField & 65535;\n};\n\nPromise.prototype._isFateSealed = function () {\n    return (this._bitField & 117506048) !== 0;\n};\n\nPromise.prototype._isFollowing = function () {\n    return (this._bitField & 67108864) === 67108864;\n};\n\nPromise.prototype._setLength = function (len) {\n    this._bitField = (this._bitField & -65536) |\n        (len & 65535);\n};\n\nPromise.prototype._setFulfilled = function () {\n    this._bitField = this._bitField | 33554432;\n    this._fireEvent(\"promiseFulfilled\", this);\n};\n\nPromise.prototype._setRejected = function () {\n    this._bitField = this._bitField | 16777216;\n    this._fireEvent(\"promiseRejected\", this);\n};\n\nPromise.prototype._setFollowing = function () {\n    this._bitField = this._bitField | 67108864;\n    this._fireEvent(\"promiseResolved\", this);\n};\n\nPromise.prototype._setIsFinal = function () {\n    this._bitField = this._bitField | 4194304;\n};\n\nPromise.prototype._isFinal = function () {\n    return (this._bitField & 4194304) > 0;\n};\n\nPromise.prototype._unsetCancelled = function() {\n    this._bitField = this._bitField & (~65536);\n};\n\nPromise.prototype._setCancelled = function() {\n    this._bitField = this._bitField | 65536;\n    this._fireEvent(\"promiseCancelled\", this);\n};\n\nPromise.prototype._setWillBeCancelled = function() {\n    this._bitField = this._bitField | 8388608;\n};\n\nPromise.prototype._setAsyncGuaranteed = function() {\n    if (async.hasCustomScheduler()) return;\n    this._bitField = this._bitField | 134217728;\n};\n\nPromise.prototype._receiverAt = function (index) {\n    var ret = index === 0 ? this._receiver0 : this[\n            index * 4 - 4 + 3];\n    if (ret === UNDEFINED_BINDING) {\n        return undefined;\n    } else if (ret === undefined && this._isBound()) {\n        return this._boundValue();\n    }\n    return ret;\n};\n\nPromise.prototype._promiseAt = function (index) {\n    return this[\n            index * 4 - 4 + 2];\n};\n\nPromise.prototype._fulfillmentHandlerAt = function (index) {\n    return this[\n            index * 4 - 4 + 0];\n};\n\nPromise.prototype._rejectionHandlerAt = function (index) {\n    return this[\n            index * 4 - 4 + 1];\n};\n\nPromise.prototype._boundValue = function() {};\n\nPromise.prototype._migrateCallback0 = function (follower) {\n    var bitField = follower._bitField;\n    var fulfill = follower._fulfillmentHandler0;\n    var reject = follower._rejectionHandler0;\n    var promise = follower._promise0;\n    var receiver = follower._receiverAt(0);\n    if (receiver === undefined) receiver = UNDEFINED_BINDING;\n    this._addCallbacks(fulfill, reject, promise, receiver, null);\n};\n\nPromise.prototype._migrateCallbackAt = function (follower, index) {\n    var fulfill = follower._fulfillmentHandlerAt(index);\n    var reject = follower._rejectionHandlerAt(index);\n    var promise = follower._promiseAt(index);\n    var receiver = follower._receiverAt(index);\n    if (receiver === undefined) receiver = UNDEFINED_BINDING;\n    this._addCallbacks(fulfill, reject, promise, receiver, null);\n};\n\nPromise.prototype._addCallbacks = function (\n    fulfill,\n    reject,\n    promise,\n    receiver,\n    domain\n) {\n    var index = this._length();\n\n    if (index >= 65535 - 4) {\n        index = 0;\n        this._setLength(0);\n    }\n\n    if (index === 0) {\n        this._promise0 = promise;\n        this._receiver0 = receiver;\n        if (typeof fulfill === \"function\") {\n            this._fulfillmentHandler0 =\n                domain === null ? fulfill : util.domainBind(domain, fulfill);\n        }\n        if (typeof reject === \"function\") {\n            this._rejectionHandler0 =\n                domain === null ? reject : util.domainBind(domain, reject);\n        }\n    } else {\n        var base = index * 4 - 4;\n        this[base + 2] = promise;\n        this[base + 3] = receiver;\n        if (typeof fulfill === \"function\") {\n            this[base + 0] =\n                domain === null ? fulfill : util.domainBind(domain, fulfill);\n        }\n        if (typeof reject === \"function\") {\n            this[base + 1] =\n                domain === null ? reject : util.domainBind(domain, reject);\n        }\n    }\n    this._setLength(index + 1);\n    return index;\n};\n\nPromise.prototype._proxy = function (proxyable, arg) {\n    this._addCallbacks(undefined, undefined, arg, proxyable, null);\n};\n\nPromise.prototype._resolveCallback = function(value, shouldBind) {\n    if (((this._bitField & 117506048) !== 0)) return;\n    if (value === this)\n        return this._rejectCallback(makeSelfResolutionError(), false);\n    var maybePromise = tryConvertToPromise(value, this);\n    if (!(maybePromise instanceof Promise)) return this._fulfill(value);\n\n    if (shouldBind) this._propagateFrom(maybePromise, 2);\n\n    var promise = maybePromise._target();\n\n    if (promise === this) {\n        this._reject(makeSelfResolutionError());\n        return;\n    }\n\n    var bitField = promise._bitField;\n    if (((bitField & 50397184) === 0)) {\n        var len = this._length();\n        if (len > 0) promise._migrateCallback0(this);\n        for (var i = 1; i < len; ++i) {\n            promise._migrateCallbackAt(this, i);\n        }\n        this._setFollowing();\n        this._setLength(0);\n        this._setFollowee(promise);\n    } else if (((bitField & 33554432) !== 0)) {\n        this._fulfill(promise._value());\n    } else if (((bitField & 16777216) !== 0)) {\n        this._reject(promise._reason());\n    } else {\n        var reason = new CancellationError(\"late cancellation observer\");\n        promise._attachExtraTrace(reason);\n        this._reject(reason);\n    }\n};\n\nPromise.prototype._rejectCallback =\nfunction(reason, synchronous, ignoreNonErrorWarnings) {\n    var trace = util.ensureErrorObject(reason);\n    var hasStack = trace === reason;\n    if (!hasStack && !ignoreNonErrorWarnings && debug.warnings()) {\n        var message = \"a promise was rejected with a non-error: \" +\n            util.classString(reason);\n        this._warn(message, true);\n    }\n    this._attachExtraTrace(trace, synchronous ? hasStack : false);\n    this._reject(reason);\n};\n\nPromise.prototype._resolveFromExecutor = function (executor) {\n    if (executor === INTERNAL) return;\n    var promise = this;\n    this._captureStackTrace();\n    this._pushContext();\n    var synchronous = true;\n    var r = this._execute(executor, function(value) {\n        promise._resolveCallback(value);\n    }, function (reason) {\n        promise._rejectCallback(reason, synchronous);\n    });\n    synchronous = false;\n    this._popContext();\n\n    if (r !== undefined) {\n        promise._rejectCallback(r, true);\n    }\n};\n\nPromise.prototype._settlePromiseFromHandler = function (\n    handler, receiver, value, promise\n) {\n    var bitField = promise._bitField;\n    if (((bitField & 65536) !== 0)) return;\n    promise._pushContext();\n    var x;\n    if (receiver === APPLY) {\n        if (!value || typeof value.length !== \"number\") {\n            x = errorObj;\n            x.e = new TypeError(\"cannot .spread() a non-array: \" +\n                                    util.classString(value));\n        } else {\n            x = tryCatch(handler).apply(this._boundValue(), value);\n        }\n    } else {\n        x = tryCatch(handler).call(receiver, value);\n    }\n    var promiseCreated = promise._popContext();\n    bitField = promise._bitField;\n    if (((bitField & 65536) !== 0)) return;\n\n    if (x === NEXT_FILTER) {\n        promise._reject(value);\n    } else if (x === errorObj) {\n        promise._rejectCallback(x.e, false);\n    } else {\n        debug.checkForgottenReturns(x, promiseCreated, \"\",  promise, this);\n        promise._resolveCallback(x);\n    }\n};\n\nPromise.prototype._target = function() {\n    var ret = this;\n    while (ret._isFollowing()) ret = ret._followee();\n    return ret;\n};\n\nPromise.prototype._followee = function() {\n    return this._rejectionHandler0;\n};\n\nPromise.prototype._setFollowee = function(promise) {\n    this._rejectionHandler0 = promise;\n};\n\nPromise.prototype._settlePromise = function(promise, handler, receiver, value) {\n    var isPromise = promise instanceof Promise;\n    var bitField = this._bitField;\n    var asyncGuaranteed = ((bitField & 134217728) !== 0);\n    if (((bitField & 65536) !== 0)) {\n        if (isPromise) promise._invokeInternalOnCancel();\n\n        if (receiver instanceof PassThroughHandlerContext &&\n            receiver.isFinallyHandler()) {\n            receiver.cancelPromise = promise;\n            if (tryCatch(handler).call(receiver, value) === errorObj) {\n                promise._reject(errorObj.e);\n            }\n        } else if (handler === reflectHandler) {\n            promise._fulfill(reflectHandler.call(receiver));\n        } else if (receiver instanceof Proxyable) {\n            receiver._promiseCancelled(promise);\n        } else if (isPromise || promise instanceof PromiseArray) {\n            promise._cancel();\n        } else {\n            receiver.cancel();\n        }\n    } else if (typeof handler === \"function\") {\n        if (!isPromise) {\n            handler.call(receiver, value, promise);\n        } else {\n            if (asyncGuaranteed) promise._setAsyncGuaranteed();\n            this._settlePromiseFromHandler(handler, receiver, value, promise);\n        }\n    } else if (receiver instanceof Proxyable) {\n        if (!receiver._isResolved()) {\n            if (((bitField & 33554432) !== 0)) {\n                receiver._promiseFulfilled(value, promise);\n            } else {\n                receiver._promiseRejected(value, promise);\n            }\n        }\n    } else if (isPromise) {\n        if (asyncGuaranteed) promise._setAsyncGuaranteed();\n        if (((bitField & 33554432) !== 0)) {\n            promise._fulfill(value);\n        } else {\n            promise._reject(value);\n        }\n    }\n};\n\nPromise.prototype._settlePromiseLateCancellationObserver = function(ctx) {\n    var handler = ctx.handler;\n    var promise = ctx.promise;\n    var receiver = ctx.receiver;\n    var value = ctx.value;\n    if (typeof handler === \"function\") {\n        if (!(promise instanceof Promise)) {\n            handler.call(receiver, value, promise);\n        } else {\n            this._settlePromiseFromHandler(handler, receiver, value, promise);\n        }\n    } else if (promise instanceof Promise) {\n        promise._reject(value);\n    }\n};\n\nPromise.prototype._settlePromiseCtx = function(ctx) {\n    this._settlePromise(ctx.promise, ctx.handler, ctx.receiver, ctx.value);\n};\n\nPromise.prototype._settlePromise0 = function(handler, value, bitField) {\n    var promise = this._promise0;\n    var receiver = this._receiverAt(0);\n    this._promise0 = undefined;\n    this._receiver0 = undefined;\n    this._settlePromise(promise, handler, receiver, value);\n};\n\nPromise.prototype._clearCallbackDataAtIndex = function(index) {\n    var base = index * 4 - 4;\n    this[base + 2] =\n    this[base + 3] =\n    this[base + 0] =\n    this[base + 1] = undefined;\n};\n\nPromise.prototype._fulfill = function (value) {\n    var bitField = this._bitField;\n    if (((bitField & 117506048) >>> 16)) return;\n    if (value === this) {\n        var err = makeSelfResolutionError();\n        this._attachExtraTrace(err);\n        return this._reject(err);\n    }\n    this._setFulfilled();\n    this._rejectionHandler0 = value;\n\n    if ((bitField & 65535) > 0) {\n        if (((bitField & 134217728) !== 0)) {\n            this._settlePromises();\n        } else {\n            async.settlePromises(this);\n        }\n    }\n};\n\nPromise.prototype._reject = function (reason) {\n    var bitField = this._bitField;\n    if (((bitField & 117506048) >>> 16)) return;\n    this._setRejected();\n    this._fulfillmentHandler0 = reason;\n\n    if (this._isFinal()) {\n        return async.fatalError(reason, util.isNode);\n    }\n\n    if ((bitField & 65535) > 0) {\n        async.settlePromises(this);\n    } else {\n        this._ensurePossibleRejectionHandled();\n    }\n};\n\nPromise.prototype._fulfillPromises = function (len, value) {\n    for (var i = 1; i < len; i++) {\n        var handler = this._fulfillmentHandlerAt(i);\n        var promise = this._promiseAt(i);\n        var receiver = this._receiverAt(i);\n        this._clearCallbackDataAtIndex(i);\n        this._settlePromise(promise, handler, receiver, value);\n    }\n};\n\nPromise.prototype._rejectPromises = function (len, reason) {\n    for (var i = 1; i < len; i++) {\n        var handler = this._rejectionHandlerAt(i);\n        var promise = this._promiseAt(i);\n        var receiver = this._receiverAt(i);\n        this._clearCallbackDataAtIndex(i);\n        this._settlePromise(promise, handler, receiver, reason);\n    }\n};\n\nPromise.prototype._settlePromises = function () {\n    var bitField = this._bitField;\n    var len = (bitField & 65535);\n\n    if (len > 0) {\n        if (((bitField & 16842752) !== 0)) {\n            var reason = this._fulfillmentHandler0;\n            this._settlePromise0(this._rejectionHandler0, reason, bitField);\n            this._rejectPromises(len, reason);\n        } else {\n            var value = this._rejectionHandler0;\n            this._settlePromise0(this._fulfillmentHandler0, value, bitField);\n            this._fulfillPromises(len, value);\n        }\n        this._setLength(0);\n    }\n    this._clearCancellationData();\n};\n\nPromise.prototype._settledValue = function() {\n    var bitField = this._bitField;\n    if (((bitField & 33554432) !== 0)) {\n        return this._rejectionHandler0;\n    } else if (((bitField & 16777216) !== 0)) {\n        return this._fulfillmentHandler0;\n    }\n};\n\nfunction deferResolve(v) {this.promise._resolveCallback(v);}\nfunction deferReject(v) {this.promise._rejectCallback(v, false);}\n\nPromise.defer = Promise.pending = function() {\n    debug.deprecated(\"Promise.defer\", \"new Promise\");\n    var promise = new Promise(INTERNAL);\n    return {\n        promise: promise,\n        resolve: deferResolve,\n        reject: deferReject\n    };\n};\n\nutil.notEnumerableProp(Promise,\n                       \"_makeSelfResolutionError\",\n                       makeSelfResolutionError);\n\n_dereq_(\"./method\")(Promise, INTERNAL, tryConvertToPromise, apiRejection,\n    debug);\n_dereq_(\"./bind\")(Promise, INTERNAL, tryConvertToPromise, debug);\n_dereq_(\"./cancel\")(Promise, PromiseArray, apiRejection, debug);\n_dereq_(\"./direct_resolve\")(Promise);\n_dereq_(\"./synchronous_inspection\")(Promise);\n_dereq_(\"./join\")(\n    Promise, PromiseArray, tryConvertToPromise, INTERNAL, async, getDomain);\nPromise.Promise = Promise;\nPromise.version = \"3.5.0\";\n_dereq_('./map.js')(Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL, debug);\n_dereq_('./call_get.js')(Promise);\n_dereq_('./using.js')(Promise, apiRejection, tryConvertToPromise, createContext, INTERNAL, debug);\n_dereq_('./timers.js')(Promise, INTERNAL, debug);\n_dereq_('./generators.js')(Promise, apiRejection, INTERNAL, tryConvertToPromise, Proxyable, debug);\n_dereq_('./nodeify.js')(Promise);\n_dereq_('./promisify.js')(Promise, INTERNAL);\n_dereq_('./props.js')(Promise, PromiseArray, tryConvertToPromise, apiRejection);\n_dereq_('./race.js')(Promise, INTERNAL, tryConvertToPromise, apiRejection);\n_dereq_('./reduce.js')(Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL, debug);\n_dereq_('./settle.js')(Promise, PromiseArray, debug);\n_dereq_('./some.js')(Promise, PromiseArray, apiRejection);\n_dereq_('./filter.js')(Promise, INTERNAL);\n_dereq_('./each.js')(Promise, INTERNAL);\n_dereq_('./any.js')(Promise);\n                                                         \n    util.toFastProperties(Promise);                                          \n    util.toFastProperties(Promise.prototype);                                \n    function fillTypes(value) {                                              \n        var p = new Promise(INTERNAL);                                       \n        p._fulfillmentHandler0 = value;                                      \n        p._rejectionHandler0 = value;                                        \n        p._promise0 = value;                                                 \n        p._receiver0 = value;                                                \n    }                                                                        \n    // Complete slack tracking, opt out of field-type tracking and           \n    // stabilize map                                                         \n    fillTypes({a: 1});                                                       \n    fillTypes({b: 2});                                                       \n    fillTypes({c: 3});                                                       \n    fillTypes(1);                                                            \n    fillTypes(function(){});                                                 \n    fillTypes(undefined);                                                    \n    fillTypes(false);                                                        \n    fillTypes(new Promise(INTERNAL));                                        \n    debug.setBounds(Async.firstLineError, util.lastLineError);               \n    return Promise;                                                          \n\n};\n\n},{\"./any.js\":1,\"./async\":2,\"./bind\":3,\"./call_get.js\":5,\"./cancel\":6,\"./catch_filter\":7,\"./context\":8,\"./debuggability\":9,\"./direct_resolve\":10,\"./each.js\":11,\"./errors\":12,\"./es5\":13,\"./filter.js\":14,\"./finally\":15,\"./generators.js\":16,\"./join\":17,\"./map.js\":18,\"./method\":19,\"./nodeback\":20,\"./nodeify.js\":21,\"./promise_array\":23,\"./promisify.js\":24,\"./props.js\":25,\"./race.js\":27,\"./reduce.js\":28,\"./settle.js\":30,\"./some.js\":31,\"./synchronous_inspection\":32,\"./thenables\":33,\"./timers.js\":34,\"./using.js\":35,\"./util\":36}],23:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL, tryConvertToPromise,\n    apiRejection, Proxyable) {\nvar util = _dereq_(\"./util\");\nvar isArray = util.isArray;\n\nfunction toResolutionValue(val) {\n    switch(val) {\n    case -2: return [];\n    case -3: return {};\n    case -6: return new Map();\n    }\n}\n\nfunction PromiseArray(values) {\n    var promise = this._promise = new Promise(INTERNAL);\n    if (values instanceof Promise) {\n        promise._propagateFrom(values, 3);\n    }\n    promise._setOnCancel(this);\n    this._values = values;\n    this._length = 0;\n    this._totalResolved = 0;\n    this._init(undefined, -2);\n}\nutil.inherits(PromiseArray, Proxyable);\n\nPromiseArray.prototype.length = function () {\n    return this._length;\n};\n\nPromiseArray.prototype.promise = function () {\n    return this._promise;\n};\n\nPromiseArray.prototype._init = function init(_, resolveValueIfEmpty) {\n    var values = tryConvertToPromise(this._values, this._promise);\n    if (values instanceof Promise) {\n        values = values._target();\n        var bitField = values._bitField;\n        ;\n        this._values = values;\n\n        if (((bitField & 50397184) === 0)) {\n            this._promise._setAsyncGuaranteed();\n            return values._then(\n                init,\n                this._reject,\n                undefined,\n                this,\n                resolveValueIfEmpty\n           );\n        } else if (((bitField & 33554432) !== 0)) {\n            values = values._value();\n        } else if (((bitField & 16777216) !== 0)) {\n            return this._reject(values._reason());\n        } else {\n            return this._cancel();\n        }\n    }\n    values = util.asArray(values);\n    if (values === null) {\n        var err = apiRejection(\n            \"expecting an array or an iterable object but got \" + util.classString(values)).reason();\n        this._promise._rejectCallback(err, false);\n        return;\n    }\n\n    if (values.length === 0) {\n        if (resolveValueIfEmpty === -5) {\n            this._resolveEmptyArray();\n        }\n        else {\n            this._resolve(toResolutionValue(resolveValueIfEmpty));\n        }\n        return;\n    }\n    this._iterate(values);\n};\n\nPromiseArray.prototype._iterate = function(values) {\n    var len = this.getActualLength(values.length);\n    this._length = len;\n    this._values = this.shouldCopyValues() ? new Array(len) : this._values;\n    var result = this._promise;\n    var isResolved = false;\n    var bitField = null;\n    for (var i = 0; i < len; ++i) {\n        var maybePromise = tryConvertToPromise(values[i], result);\n\n        if (maybePromise instanceof Promise) {\n            maybePromise = maybePromise._target();\n            bitField = maybePromise._bitField;\n        } else {\n            bitField = null;\n        }\n\n        if (isResolved) {\n            if (bitField !== null) {\n                maybePromise.suppressUnhandledRejections();\n            }\n        } else if (bitField !== null) {\n            if (((bitField & 50397184) === 0)) {\n                maybePromise._proxy(this, i);\n                this._values[i] = maybePromise;\n            } else if (((bitField & 33554432) !== 0)) {\n                isResolved = this._promiseFulfilled(maybePromise._value(), i);\n            } else if (((bitField & 16777216) !== 0)) {\n                isResolved = this._promiseRejected(maybePromise._reason(), i);\n            } else {\n                isResolved = this._promiseCancelled(i);\n            }\n        } else {\n            isResolved = this._promiseFulfilled(maybePromise, i);\n        }\n    }\n    if (!isResolved) result._setAsyncGuaranteed();\n};\n\nPromiseArray.prototype._isResolved = function () {\n    return this._values === null;\n};\n\nPromiseArray.prototype._resolve = function (value) {\n    this._values = null;\n    this._promise._fulfill(value);\n};\n\nPromiseArray.prototype._cancel = function() {\n    if (this._isResolved() || !this._promise._isCancellable()) return;\n    this._values = null;\n    this._promise._cancel();\n};\n\nPromiseArray.prototype._reject = function (reason) {\n    this._values = null;\n    this._promise._rejectCallback(reason, false);\n};\n\nPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    this._values[index] = value;\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= this._length) {\n        this._resolve(this._values);\n        return true;\n    }\n    return false;\n};\n\nPromiseArray.prototype._promiseCancelled = function() {\n    this._cancel();\n    return true;\n};\n\nPromiseArray.prototype._promiseRejected = function (reason) {\n    this._totalResolved++;\n    this._reject(reason);\n    return true;\n};\n\nPromiseArray.prototype._resultCancelled = function() {\n    if (this._isResolved()) return;\n    var values = this._values;\n    this._cancel();\n    if (values instanceof Promise) {\n        values.cancel();\n    } else {\n        for (var i = 0; i < values.length; ++i) {\n            if (values[i] instanceof Promise) {\n                values[i].cancel();\n            }\n        }\n    }\n};\n\nPromiseArray.prototype.shouldCopyValues = function () {\n    return true;\n};\n\nPromiseArray.prototype.getActualLength = function (len) {\n    return len;\n};\n\nreturn PromiseArray;\n};\n\n},{\"./util\":36}],24:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar THIS = {};\nvar util = _dereq_(\"./util\");\nvar nodebackForPromise = _dereq_(\"./nodeback\");\nvar withAppended = util.withAppended;\nvar maybeWrapAsError = util.maybeWrapAsError;\nvar canEvaluate = util.canEvaluate;\nvar TypeError = _dereq_(\"./errors\").TypeError;\nvar defaultSuffix = \"Async\";\nvar defaultPromisified = {__isPromisified__: true};\nvar noCopyProps = [\n    \"arity\",    \"length\",\n    \"name\",\n    \"arguments\",\n    \"caller\",\n    \"callee\",\n    \"prototype\",\n    \"__isPromisified__\"\n];\nvar noCopyPropsPattern = new RegExp(\"^(?:\" + noCopyProps.join(\"|\") + \")$\");\n\nvar defaultFilter = function(name) {\n    return util.isIdentifier(name) &&\n        name.charAt(0) !== \"_\" &&\n        name !== \"constructor\";\n};\n\nfunction propsFilter(key) {\n    return !noCopyPropsPattern.test(key);\n}\n\nfunction isPromisified(fn) {\n    try {\n        return fn.__isPromisified__ === true;\n    }\n    catch (e) {\n        return false;\n    }\n}\n\nfunction hasPromisified(obj, key, suffix) {\n    var val = util.getDataPropertyOrDefault(obj, key + suffix,\n                                            defaultPromisified);\n    return val ? isPromisified(val) : false;\n}\nfunction checkValid(ret, suffix, suffixRegexp) {\n    for (var i = 0; i < ret.length; i += 2) {\n        var key = ret[i];\n        if (suffixRegexp.test(key)) {\n            var keyWithoutAsyncSuffix = key.replace(suffixRegexp, \"\");\n            for (var j = 0; j < ret.length; j += 2) {\n                if (ret[j] === keyWithoutAsyncSuffix) {\n                    throw new TypeError(\"Cannot promisify an API that has normal methods with '%s'-suffix\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\"\n                        .replace(\"%s\", suffix));\n                }\n            }\n        }\n    }\n}\n\nfunction promisifiableMethods(obj, suffix, suffixRegexp, filter) {\n    var keys = util.inheritedDataKeys(obj);\n    var ret = [];\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        var value = obj[key];\n        var passesDefaultFilter = filter === defaultFilter\n            ? true : defaultFilter(key, value, obj);\n        if (typeof value === \"function\" &&\n            !isPromisified(value) &&\n            !hasPromisified(obj, key, suffix) &&\n            filter(key, value, obj, passesDefaultFilter)) {\n            ret.push(key, value);\n        }\n    }\n    checkValid(ret, suffix, suffixRegexp);\n    return ret;\n}\n\nvar escapeIdentRegex = function(str) {\n    return str.replace(/([$])/, \"\\\\$\");\n};\n\nvar makeNodePromisifiedEval;\nif (!true) {\nvar switchCaseArgumentOrder = function(likelyArgumentCount) {\n    var ret = [likelyArgumentCount];\n    var min = Math.max(0, likelyArgumentCount - 1 - 3);\n    for(var i = likelyArgumentCount - 1; i >= min; --i) {\n        ret.push(i);\n    }\n    for(var i = likelyArgumentCount + 1; i <= 3; ++i) {\n        ret.push(i);\n    }\n    return ret;\n};\n\nvar argumentSequence = function(argumentCount) {\n    return util.filledRange(argumentCount, \"_arg\", \"\");\n};\n\nvar parameterDeclaration = function(parameterCount) {\n    return util.filledRange(\n        Math.max(parameterCount, 3), \"_arg\", \"\");\n};\n\nvar parameterCount = function(fn) {\n    if (typeof fn.length === \"number\") {\n        return Math.max(Math.min(fn.length, 1023 + 1), 0);\n    }\n    return 0;\n};\n\nmakeNodePromisifiedEval =\nfunction(callback, receiver, originalName, fn, _, multiArgs) {\n    var newParameterCount = Math.max(0, parameterCount(fn) - 1);\n    var argumentOrder = switchCaseArgumentOrder(newParameterCount);\n    var shouldProxyThis = typeof callback === \"string\" || receiver === THIS;\n\n    function generateCallForArgumentCount(count) {\n        var args = argumentSequence(count).join(\", \");\n        var comma = count > 0 ? \", \" : \"\";\n        var ret;\n        if (shouldProxyThis) {\n            ret = \"ret = callback.call(this, {{args}}, nodeback); break;\\n\";\n        } else {\n            ret = receiver === undefined\n                ? \"ret = callback({{args}}, nodeback); break;\\n\"\n                : \"ret = callback.call(receiver, {{args}}, nodeback); break;\\n\";\n        }\n        return ret.replace(\"{{args}}\", args).replace(\", \", comma);\n    }\n\n    function generateArgumentSwitchCase() {\n        var ret = \"\";\n        for (var i = 0; i < argumentOrder.length; ++i) {\n            ret += \"case \" + argumentOrder[i] +\":\" +\n                generateCallForArgumentCount(argumentOrder[i]);\n        }\n\n        ret += \"                                                             \\n\\\n        default:                                                             \\n\\\n            var args = new Array(len + 1);                                   \\n\\\n            var i = 0;                                                       \\n\\\n            for (var i = 0; i < len; ++i) {                                  \\n\\\n               args[i] = arguments[i];                                       \\n\\\n            }                                                                \\n\\\n            args[i] = nodeback;                                              \\n\\\n            [CodeForCall]                                                    \\n\\\n            break;                                                           \\n\\\n        \".replace(\"[CodeForCall]\", (shouldProxyThis\n                                ? \"ret = callback.apply(this, args);\\n\"\n                                : \"ret = callback.apply(receiver, args);\\n\"));\n        return ret;\n    }\n\n    var getFunctionCode = typeof callback === \"string\"\n                                ? (\"this != null ? this['\"+callback+\"'] : fn\")\n                                : \"fn\";\n    var body = \"'use strict';                                                \\n\\\n        var ret = function (Parameters) {                                    \\n\\\n            'use strict';                                                    \\n\\\n            var len = arguments.length;                                      \\n\\\n            var promise = new Promise(INTERNAL);                             \\n\\\n            promise._captureStackTrace();                                    \\n\\\n            var nodeback = nodebackForPromise(promise, \" + multiArgs + \");   \\n\\\n            var ret;                                                         \\n\\\n            var callback = tryCatch([GetFunctionCode]);                      \\n\\\n            switch(len) {                                                    \\n\\\n                [CodeForSwitchCase]                                          \\n\\\n            }                                                                \\n\\\n            if (ret === errorObj) {                                          \\n\\\n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\\n\\\n            }                                                                \\n\\\n            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \\n\\\n            return promise;                                                  \\n\\\n        };                                                                   \\n\\\n        notEnumerableProp(ret, '__isPromisified__', true);                   \\n\\\n        return ret;                                                          \\n\\\n    \".replace(\"[CodeForSwitchCase]\", generateArgumentSwitchCase())\n        .replace(\"[GetFunctionCode]\", getFunctionCode);\n    body = body.replace(\"Parameters\", parameterDeclaration(newParameterCount));\n    return new Function(\"Promise\",\n                        \"fn\",\n                        \"receiver\",\n                        \"withAppended\",\n                        \"maybeWrapAsError\",\n                        \"nodebackForPromise\",\n                        \"tryCatch\",\n                        \"errorObj\",\n                        \"notEnumerableProp\",\n                        \"INTERNAL\",\n                        body)(\n                    Promise,\n                    fn,\n                    receiver,\n                    withAppended,\n                    maybeWrapAsError,\n                    nodebackForPromise,\n                    util.tryCatch,\n                    util.errorObj,\n                    util.notEnumerableProp,\n                    INTERNAL);\n};\n}\n\nfunction makeNodePromisifiedClosure(callback, receiver, _, fn, __, multiArgs) {\n    var defaultThis = (function() {return this;})();\n    var method = callback;\n    if (typeof method === \"string\") {\n        callback = fn;\n    }\n    function promisified() {\n        var _receiver = receiver;\n        if (receiver === THIS) _receiver = this;\n        var promise = new Promise(INTERNAL);\n        promise._captureStackTrace();\n        var cb = typeof method === \"string\" && this !== defaultThis\n            ? this[method] : callback;\n        var fn = nodebackForPromise(promise, multiArgs);\n        try {\n            cb.apply(_receiver, withAppended(arguments, fn));\n        } catch(e) {\n            promise._rejectCallback(maybeWrapAsError(e), true, true);\n        }\n        if (!promise._isFateSealed()) promise._setAsyncGuaranteed();\n        return promise;\n    }\n    util.notEnumerableProp(promisified, \"__isPromisified__\", true);\n    return promisified;\n}\n\nvar makeNodePromisified = canEvaluate\n    ? makeNodePromisifiedEval\n    : makeNodePromisifiedClosure;\n\nfunction promisifyAll(obj, suffix, filter, promisifier, multiArgs) {\n    var suffixRegexp = new RegExp(escapeIdentRegex(suffix) + \"$\");\n    var methods =\n        promisifiableMethods(obj, suffix, suffixRegexp, filter);\n\n    for (var i = 0, len = methods.length; i < len; i+= 2) {\n        var key = methods[i];\n        var fn = methods[i+1];\n        var promisifiedKey = key + suffix;\n        if (promisifier === makeNodePromisified) {\n            obj[promisifiedKey] =\n                makeNodePromisified(key, THIS, key, fn, suffix, multiArgs);\n        } else {\n            var promisified = promisifier(fn, function() {\n                return makeNodePromisified(key, THIS, key,\n                                           fn, suffix, multiArgs);\n            });\n            util.notEnumerableProp(promisified, \"__isPromisified__\", true);\n            obj[promisifiedKey] = promisified;\n        }\n    }\n    util.toFastProperties(obj);\n    return obj;\n}\n\nfunction promisify(callback, receiver, multiArgs) {\n    return makeNodePromisified(callback, receiver, undefined,\n                                callback, null, multiArgs);\n}\n\nPromise.promisify = function (fn, options) {\n    if (typeof fn !== \"function\") {\n        throw new TypeError(\"expecting a function but got \" + util.classString(fn));\n    }\n    if (isPromisified(fn)) {\n        return fn;\n    }\n    options = Object(options);\n    var receiver = options.context === undefined ? THIS : options.context;\n    var multiArgs = !!options.multiArgs;\n    var ret = promisify(fn, receiver, multiArgs);\n    util.copyDescriptors(fn, ret, propsFilter);\n    return ret;\n};\n\nPromise.promisifyAll = function (target, options) {\n    if (typeof target !== \"function\" && typeof target !== \"object\") {\n        throw new TypeError(\"the target of promisifyAll must be an object or a function\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    options = Object(options);\n    var multiArgs = !!options.multiArgs;\n    var suffix = options.suffix;\n    if (typeof suffix !== \"string\") suffix = defaultSuffix;\n    var filter = options.filter;\n    if (typeof filter !== \"function\") filter = defaultFilter;\n    var promisifier = options.promisifier;\n    if (typeof promisifier !== \"function\") promisifier = makeNodePromisified;\n\n    if (!util.isIdentifier(suffix)) {\n        throw new RangeError(\"suffix must be a valid identifier\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n\n    var keys = util.inheritedDataKeys(target);\n    for (var i = 0; i < keys.length; ++i) {\n        var value = target[keys[i]];\n        if (keys[i] !== \"constructor\" &&\n            util.isClass(value)) {\n            promisifyAll(value.prototype, suffix, filter, promisifier,\n                multiArgs);\n            promisifyAll(value, suffix, filter, promisifier, multiArgs);\n        }\n    }\n\n    return promisifyAll(target, suffix, filter, promisifier, multiArgs);\n};\n};\n\n\n},{\"./errors\":12,\"./nodeback\":20,\"./util\":36}],25:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(\n    Promise, PromiseArray, tryConvertToPromise, apiRejection) {\nvar util = _dereq_(\"./util\");\nvar isObject = util.isObject;\nvar es5 = _dereq_(\"./es5\");\nvar Es6Map;\nif (typeof Map === \"function\") Es6Map = Map;\n\nvar mapToEntries = (function() {\n    var index = 0;\n    var size = 0;\n\n    function extractEntry(value, key) {\n        this[index] = value;\n        this[index + size] = key;\n        index++;\n    }\n\n    return function mapToEntries(map) {\n        size = map.size;\n        index = 0;\n        var ret = new Array(map.size * 2);\n        map.forEach(extractEntry, ret);\n        return ret;\n    };\n})();\n\nvar entriesToMap = function(entries) {\n    var ret = new Es6Map();\n    var length = entries.length / 2 | 0;\n    for (var i = 0; i < length; ++i) {\n        var key = entries[length + i];\n        var value = entries[i];\n        ret.set(key, value);\n    }\n    return ret;\n};\n\nfunction PropertiesPromiseArray(obj) {\n    var isMap = false;\n    var entries;\n    if (Es6Map !== undefined && obj instanceof Es6Map) {\n        entries = mapToEntries(obj);\n        isMap = true;\n    } else {\n        var keys = es5.keys(obj);\n        var len = keys.length;\n        entries = new Array(len * 2);\n        for (var i = 0; i < len; ++i) {\n            var key = keys[i];\n            entries[i] = obj[key];\n            entries[i + len] = key;\n        }\n    }\n    this.constructor$(entries);\n    this._isMap = isMap;\n    this._init$(undefined, isMap ? -6 : -3);\n}\nutil.inherits(PropertiesPromiseArray, PromiseArray);\n\nPropertiesPromiseArray.prototype._init = function () {};\n\nPropertiesPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    this._values[index] = value;\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= this._length) {\n        var val;\n        if (this._isMap) {\n            val = entriesToMap(this._values);\n        } else {\n            val = {};\n            var keyOffset = this.length();\n            for (var i = 0, len = this.length(); i < len; ++i) {\n                val[this._values[i + keyOffset]] = this._values[i];\n            }\n        }\n        this._resolve(val);\n        return true;\n    }\n    return false;\n};\n\nPropertiesPromiseArray.prototype.shouldCopyValues = function () {\n    return false;\n};\n\nPropertiesPromiseArray.prototype.getActualLength = function (len) {\n    return len >> 1;\n};\n\nfunction props(promises) {\n    var ret;\n    var castValue = tryConvertToPromise(promises);\n\n    if (!isObject(castValue)) {\n        return apiRejection(\"cannot await properties of a non-object\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    } else if (castValue instanceof Promise) {\n        ret = castValue._then(\n            Promise.props, undefined, undefined, undefined, undefined);\n    } else {\n        ret = new PropertiesPromiseArray(castValue).promise();\n    }\n\n    if (castValue instanceof Promise) {\n        ret._propagateFrom(castValue, 2);\n    }\n    return ret;\n}\n\nPromise.prototype.props = function () {\n    return props(this);\n};\n\nPromise.props = function (promises) {\n    return props(promises);\n};\n};\n\n},{\"./es5\":13,\"./util\":36}],26:[function(_dereq_,module,exports){\n\"use strict\";\nfunction arrayMove(src, srcIndex, dst, dstIndex, len) {\n    for (var j = 0; j < len; ++j) {\n        dst[j + dstIndex] = src[j + srcIndex];\n        src[j + srcIndex] = void 0;\n    }\n}\n\nfunction Queue(capacity) {\n    this._capacity = capacity;\n    this._length = 0;\n    this._front = 0;\n}\n\nQueue.prototype._willBeOverCapacity = function (size) {\n    return this._capacity < size;\n};\n\nQueue.prototype._pushOne = function (arg) {\n    var length = this.length();\n    this._checkCapacity(length + 1);\n    var i = (this._front + length) & (this._capacity - 1);\n    this[i] = arg;\n    this._length = length + 1;\n};\n\nQueue.prototype.push = function (fn, receiver, arg) {\n    var length = this.length() + 3;\n    if (this._willBeOverCapacity(length)) {\n        this._pushOne(fn);\n        this._pushOne(receiver);\n        this._pushOne(arg);\n        return;\n    }\n    var j = this._front + length - 3;\n    this._checkCapacity(length);\n    var wrapMask = this._capacity - 1;\n    this[(j + 0) & wrapMask] = fn;\n    this[(j + 1) & wrapMask] = receiver;\n    this[(j + 2) & wrapMask] = arg;\n    this._length = length;\n};\n\nQueue.prototype.shift = function () {\n    var front = this._front,\n        ret = this[front];\n\n    this[front] = undefined;\n    this._front = (front + 1) & (this._capacity - 1);\n    this._length--;\n    return ret;\n};\n\nQueue.prototype.length = function () {\n    return this._length;\n};\n\nQueue.prototype._checkCapacity = function (size) {\n    if (this._capacity < size) {\n        this._resizeTo(this._capacity << 1);\n    }\n};\n\nQueue.prototype._resizeTo = function (capacity) {\n    var oldCapacity = this._capacity;\n    this._capacity = capacity;\n    var front = this._front;\n    var length = this._length;\n    var moveItemsCount = (front + length) & (oldCapacity - 1);\n    arrayMove(this, 0, this, oldCapacity, moveItemsCount);\n};\n\nmodule.exports = Queue;\n\n},{}],27:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(\n    Promise, INTERNAL, tryConvertToPromise, apiRejection) {\nvar util = _dereq_(\"./util\");\n\nvar raceLater = function (promise) {\n    return promise.then(function(array) {\n        return race(array, promise);\n    });\n};\n\nfunction race(promises, parent) {\n    var maybePromise = tryConvertToPromise(promises);\n\n    if (maybePromise instanceof Promise) {\n        return raceLater(maybePromise);\n    } else {\n        promises = util.asArray(promises);\n        if (promises === null)\n            return apiRejection(\"expecting an array or an iterable object but got \" + util.classString(promises));\n    }\n\n    var ret = new Promise(INTERNAL);\n    if (parent !== undefined) {\n        ret._propagateFrom(parent, 3);\n    }\n    var fulfill = ret._fulfill;\n    var reject = ret._reject;\n    for (var i = 0, len = promises.length; i < len; ++i) {\n        var val = promises[i];\n\n        if (val === undefined && !(i in promises)) {\n            continue;\n        }\n\n        Promise.cast(val)._then(fulfill, reject, undefined, ret, null);\n    }\n    return ret;\n}\n\nPromise.race = function (promises) {\n    return race(promises, undefined);\n};\n\nPromise.prototype.race = function () {\n    return race(this, undefined);\n};\n\n};\n\n},{\"./util\":36}],28:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise,\n                          PromiseArray,\n                          apiRejection,\n                          tryConvertToPromise,\n                          INTERNAL,\n                          debug) {\nvar getDomain = Promise._getDomain;\nvar util = _dereq_(\"./util\");\nvar tryCatch = util.tryCatch;\n\nfunction ReductionPromiseArray(promises, fn, initialValue, _each) {\n    this.constructor$(promises);\n    var domain = getDomain();\n    this._fn = domain === null ? fn : util.domainBind(domain, fn);\n    if (initialValue !== undefined) {\n        initialValue = Promise.resolve(initialValue);\n        initialValue._attachCancellationCallback(this);\n    }\n    this._initialValue = initialValue;\n    this._currentCancellable = null;\n    if(_each === INTERNAL) {\n        this._eachValues = Array(this._length);\n    } else if (_each === 0) {\n        this._eachValues = null;\n    } else {\n        this._eachValues = undefined;\n    }\n    this._promise._captureStackTrace();\n    this._init$(undefined, -5);\n}\nutil.inherits(ReductionPromiseArray, PromiseArray);\n\nReductionPromiseArray.prototype._gotAccum = function(accum) {\n    if (this._eachValues !== undefined && \n        this._eachValues !== null && \n        accum !== INTERNAL) {\n        this._eachValues.push(accum);\n    }\n};\n\nReductionPromiseArray.prototype._eachComplete = function(value) {\n    if (this._eachValues !== null) {\n        this._eachValues.push(value);\n    }\n    return this._eachValues;\n};\n\nReductionPromiseArray.prototype._init = function() {};\n\nReductionPromiseArray.prototype._resolveEmptyArray = function() {\n    this._resolve(this._eachValues !== undefined ? this._eachValues\n                                                 : this._initialValue);\n};\n\nReductionPromiseArray.prototype.shouldCopyValues = function () {\n    return false;\n};\n\nReductionPromiseArray.prototype._resolve = function(value) {\n    this._promise._resolveCallback(value);\n    this._values = null;\n};\n\nReductionPromiseArray.prototype._resultCancelled = function(sender) {\n    if (sender === this._initialValue) return this._cancel();\n    if (this._isResolved()) return;\n    this._resultCancelled$();\n    if (this._currentCancellable instanceof Promise) {\n        this._currentCancellable.cancel();\n    }\n    if (this._initialValue instanceof Promise) {\n        this._initialValue.cancel();\n    }\n};\n\nReductionPromiseArray.prototype._iterate = function (values) {\n    this._values = values;\n    var value;\n    var i;\n    var length = values.length;\n    if (this._initialValue !== undefined) {\n        value = this._initialValue;\n        i = 0;\n    } else {\n        value = Promise.resolve(values[0]);\n        i = 1;\n    }\n\n    this._currentCancellable = value;\n\n    if (!value.isRejected()) {\n        for (; i < length; ++i) {\n            var ctx = {\n                accum: null,\n                value: values[i],\n                index: i,\n                length: length,\n                array: this\n            };\n            value = value._then(gotAccum, undefined, undefined, ctx, undefined);\n        }\n    }\n\n    if (this._eachValues !== undefined) {\n        value = value\n            ._then(this._eachComplete, undefined, undefined, this, undefined);\n    }\n    value._then(completed, completed, undefined, value, this);\n};\n\nPromise.prototype.reduce = function (fn, initialValue) {\n    return reduce(this, fn, initialValue, null);\n};\n\nPromise.reduce = function (promises, fn, initialValue, _each) {\n    return reduce(promises, fn, initialValue, _each);\n};\n\nfunction completed(valueOrReason, array) {\n    if (this.isFulfilled()) {\n        array._resolve(valueOrReason);\n    } else {\n        array._reject(valueOrReason);\n    }\n}\n\nfunction reduce(promises, fn, initialValue, _each) {\n    if (typeof fn !== \"function\") {\n        return apiRejection(\"expecting a function but got \" + util.classString(fn));\n    }\n    var array = new ReductionPromiseArray(promises, fn, initialValue, _each);\n    return array.promise();\n}\n\nfunction gotAccum(accum) {\n    this.accum = accum;\n    this.array._gotAccum(accum);\n    var value = tryConvertToPromise(this.value, this.array._promise);\n    if (value instanceof Promise) {\n        this.array._currentCancellable = value;\n        return value._then(gotValue, undefined, undefined, this, undefined);\n    } else {\n        return gotValue.call(this, value);\n    }\n}\n\nfunction gotValue(value) {\n    var array = this.array;\n    var promise = array._promise;\n    var fn = tryCatch(array._fn);\n    promise._pushContext();\n    var ret;\n    if (array._eachValues !== undefined) {\n        ret = fn.call(promise._boundValue(), value, this.index, this.length);\n    } else {\n        ret = fn.call(promise._boundValue(),\n                              this.accum, value, this.index, this.length);\n    }\n    if (ret instanceof Promise) {\n        array._currentCancellable = ret;\n    }\n    var promiseCreated = promise._popContext();\n    debug.checkForgottenReturns(\n        ret,\n        promiseCreated,\n        array._eachValues !== undefined ? \"Promise.each\" : \"Promise.reduce\",\n        promise\n    );\n    return ret;\n}\n};\n\n},{\"./util\":36}],29:[function(_dereq_,module,exports){\n\"use strict\";\nvar util = _dereq_(\"./util\");\nvar schedule;\nvar noAsyncScheduler = function() {\n    throw new Error(\"No async scheduler available\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n};\nvar NativePromise = util.getNativePromise();\nif (util.isNode && typeof MutationObserver === \"undefined\") {\n    var GlobalSetImmediate = global.setImmediate;\n    var ProcessNextTick = process.nextTick;\n    schedule = util.isRecentNode\n                ? function(fn) { GlobalSetImmediate.call(global, fn); }\n                : function(fn) { ProcessNextTick.call(process, fn); };\n} else if (typeof NativePromise === \"function\" &&\n           typeof NativePromise.resolve === \"function\") {\n    var nativePromise = NativePromise.resolve();\n    schedule = function(fn) {\n        nativePromise.then(fn);\n    };\n} else if ((typeof MutationObserver !== \"undefined\") &&\n          !(typeof window !== \"undefined\" &&\n            window.navigator &&\n            (window.navigator.standalone || window.cordova))) {\n    schedule = (function() {\n        var div = document.createElement(\"div\");\n        var opts = {attributes: true};\n        var toggleScheduled = false;\n        var div2 = document.createElement(\"div\");\n        var o2 = new MutationObserver(function() {\n            div.classList.toggle(\"foo\");\n            toggleScheduled = false;\n        });\n        o2.observe(div2, opts);\n\n        var scheduleToggle = function() {\n            if (toggleScheduled) return;\n            toggleScheduled = true;\n            div2.classList.toggle(\"foo\");\n        };\n\n        return function schedule(fn) {\n            var o = new MutationObserver(function() {\n                o.disconnect();\n                fn();\n            });\n            o.observe(div, opts);\n            scheduleToggle();\n        };\n    })();\n} else if (typeof setImmediate !== \"undefined\") {\n    schedule = function (fn) {\n        setImmediate(fn);\n    };\n} else if (typeof setTimeout !== \"undefined\") {\n    schedule = function (fn) {\n        setTimeout(fn, 0);\n    };\n} else {\n    schedule = noAsyncScheduler;\n}\nmodule.exports = schedule;\n\n},{\"./util\":36}],30:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports =\n    function(Promise, PromiseArray, debug) {\nvar PromiseInspection = Promise.PromiseInspection;\nvar util = _dereq_(\"./util\");\n\nfunction SettledPromiseArray(values) {\n    this.constructor$(values);\n}\nutil.inherits(SettledPromiseArray, PromiseArray);\n\nSettledPromiseArray.prototype._promiseResolved = function (index, inspection) {\n    this._values[index] = inspection;\n    var totalResolved = ++this._totalResolved;\n    if (totalResolved >= this._length) {\n        this._resolve(this._values);\n        return true;\n    }\n    return false;\n};\n\nSettledPromiseArray.prototype._promiseFulfilled = function (value, index) {\n    var ret = new PromiseInspection();\n    ret._bitField = 33554432;\n    ret._settledValueField = value;\n    return this._promiseResolved(index, ret);\n};\nSettledPromiseArray.prototype._promiseRejected = function (reason, index) {\n    var ret = new PromiseInspection();\n    ret._bitField = 16777216;\n    ret._settledValueField = reason;\n    return this._promiseResolved(index, ret);\n};\n\nPromise.settle = function (promises) {\n    debug.deprecated(\".settle()\", \".reflect()\");\n    return new SettledPromiseArray(promises).promise();\n};\n\nPromise.prototype.settle = function () {\n    return Promise.settle(this);\n};\n};\n\n},{\"./util\":36}],31:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports =\nfunction(Promise, PromiseArray, apiRejection) {\nvar util = _dereq_(\"./util\");\nvar RangeError = _dereq_(\"./errors\").RangeError;\nvar AggregateError = _dereq_(\"./errors\").AggregateError;\nvar isArray = util.isArray;\nvar CANCELLATION = {};\n\n\nfunction SomePromiseArray(values) {\n    this.constructor$(values);\n    this._howMany = 0;\n    this._unwrap = false;\n    this._initialized = false;\n}\nutil.inherits(SomePromiseArray, PromiseArray);\n\nSomePromiseArray.prototype._init = function () {\n    if (!this._initialized) {\n        return;\n    }\n    if (this._howMany === 0) {\n        this._resolve([]);\n        return;\n    }\n    this._init$(undefined, -5);\n    var isArrayResolved = isArray(this._values);\n    if (!this._isResolved() &&\n        isArrayResolved &&\n        this._howMany > this._canPossiblyFulfill()) {\n        this._reject(this._getRangeError(this.length()));\n    }\n};\n\nSomePromiseArray.prototype.init = function () {\n    this._initialized = true;\n    this._init();\n};\n\nSomePromiseArray.prototype.setUnwrap = function () {\n    this._unwrap = true;\n};\n\nSomePromiseArray.prototype.howMany = function () {\n    return this._howMany;\n};\n\nSomePromiseArray.prototype.setHowMany = function (count) {\n    this._howMany = count;\n};\n\nSomePromiseArray.prototype._promiseFulfilled = function (value) {\n    this._addFulfilled(value);\n    if (this._fulfilled() === this.howMany()) {\n        this._values.length = this.howMany();\n        if (this.howMany() === 1 && this._unwrap) {\n            this._resolve(this._values[0]);\n        } else {\n            this._resolve(this._values);\n        }\n        return true;\n    }\n    return false;\n\n};\nSomePromiseArray.prototype._promiseRejected = function (reason) {\n    this._addRejected(reason);\n    return this._checkOutcome();\n};\n\nSomePromiseArray.prototype._promiseCancelled = function () {\n    if (this._values instanceof Promise || this._values == null) {\n        return this._cancel();\n    }\n    this._addRejected(CANCELLATION);\n    return this._checkOutcome();\n};\n\nSomePromiseArray.prototype._checkOutcome = function() {\n    if (this.howMany() > this._canPossiblyFulfill()) {\n        var e = new AggregateError();\n        for (var i = this.length(); i < this._values.length; ++i) {\n            if (this._values[i] !== CANCELLATION) {\n                e.push(this._values[i]);\n            }\n        }\n        if (e.length > 0) {\n            this._reject(e);\n        } else {\n            this._cancel();\n        }\n        return true;\n    }\n    return false;\n};\n\nSomePromiseArray.prototype._fulfilled = function () {\n    return this._totalResolved;\n};\n\nSomePromiseArray.prototype._rejected = function () {\n    return this._values.length - this.length();\n};\n\nSomePromiseArray.prototype._addRejected = function (reason) {\n    this._values.push(reason);\n};\n\nSomePromiseArray.prototype._addFulfilled = function (value) {\n    this._values[this._totalResolved++] = value;\n};\n\nSomePromiseArray.prototype._canPossiblyFulfill = function () {\n    return this.length() - this._rejected();\n};\n\nSomePromiseArray.prototype._getRangeError = function (count) {\n    var message = \"Input array must contain at least \" +\n            this._howMany + \" items but contains only \" + count + \" items\";\n    return new RangeError(message);\n};\n\nSomePromiseArray.prototype._resolveEmptyArray = function () {\n    this._reject(this._getRangeError(0));\n};\n\nfunction some(promises, howMany) {\n    if ((howMany | 0) !== howMany || howMany < 0) {\n        return apiRejection(\"expecting a positive integer\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    var ret = new SomePromiseArray(promises);\n    var promise = ret.promise();\n    ret.setHowMany(howMany);\n    ret.init();\n    return promise;\n}\n\nPromise.some = function (promises, howMany) {\n    return some(promises, howMany);\n};\n\nPromise.prototype.some = function (howMany) {\n    return some(this, howMany);\n};\n\nPromise._SomePromiseArray = SomePromiseArray;\n};\n\n},{\"./errors\":12,\"./util\":36}],32:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise) {\nfunction PromiseInspection(promise) {\n    if (promise !== undefined) {\n        promise = promise._target();\n        this._bitField = promise._bitField;\n        this._settledValueField = promise._isFateSealed()\n            ? promise._settledValue() : undefined;\n    }\n    else {\n        this._bitField = 0;\n        this._settledValueField = undefined;\n    }\n}\n\nPromiseInspection.prototype._settledValue = function() {\n    return this._settledValueField;\n};\n\nvar value = PromiseInspection.prototype.value = function () {\n    if (!this.isFulfilled()) {\n        throw new TypeError(\"cannot get fulfillment value of a non-fulfilled promise\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    return this._settledValue();\n};\n\nvar reason = PromiseInspection.prototype.error =\nPromiseInspection.prototype.reason = function () {\n    if (!this.isRejected()) {\n        throw new TypeError(\"cannot get rejection reason of a non-rejected promise\\u000a\\u000a    See http://goo.gl/MqrFmX\\u000a\");\n    }\n    return this._settledValue();\n};\n\nvar isFulfilled = PromiseInspection.prototype.isFulfilled = function() {\n    return (this._bitField & 33554432) !== 0;\n};\n\nvar isRejected = PromiseInspection.prototype.isRejected = function () {\n    return (this._bitField & 16777216) !== 0;\n};\n\nvar isPending = PromiseInspection.prototype.isPending = function () {\n    return (this._bitField & 50397184) === 0;\n};\n\nvar isResolved = PromiseInspection.prototype.isResolved = function () {\n    return (this._bitField & 50331648) !== 0;\n};\n\nPromiseInspection.prototype.isCancelled = function() {\n    return (this._bitField & 8454144) !== 0;\n};\n\nPromise.prototype.__isCancelled = function() {\n    return (this._bitField & 65536) === 65536;\n};\n\nPromise.prototype._isCancelled = function() {\n    return this._target().__isCancelled();\n};\n\nPromise.prototype.isCancelled = function() {\n    return (this._target()._bitField & 8454144) !== 0;\n};\n\nPromise.prototype.isPending = function() {\n    return isPending.call(this._target());\n};\n\nPromise.prototype.isRejected = function() {\n    return isRejected.call(this._target());\n};\n\nPromise.prototype.isFulfilled = function() {\n    return isFulfilled.call(this._target());\n};\n\nPromise.prototype.isResolved = function() {\n    return isResolved.call(this._target());\n};\n\nPromise.prototype.value = function() {\n    return value.call(this._target());\n};\n\nPromise.prototype.reason = function() {\n    var target = this._target();\n    target._unsetRejectionIsUnhandled();\n    return reason.call(target);\n};\n\nPromise.prototype._value = function() {\n    return this._settledValue();\n};\n\nPromise.prototype._reason = function() {\n    this._unsetRejectionIsUnhandled();\n    return this._settledValue();\n};\n\nPromise.PromiseInspection = PromiseInspection;\n};\n\n},{}],33:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL) {\nvar util = _dereq_(\"./util\");\nvar errorObj = util.errorObj;\nvar isObject = util.isObject;\n\nfunction tryConvertToPromise(obj, context) {\n    if (isObject(obj)) {\n        if (obj instanceof Promise) return obj;\n        var then = getThen(obj);\n        if (then === errorObj) {\n            if (context) context._pushContext();\n            var ret = Promise.reject(then.e);\n            if (context) context._popContext();\n            return ret;\n        } else if (typeof then === \"function\") {\n            if (isAnyBluebirdPromise(obj)) {\n                var ret = new Promise(INTERNAL);\n                obj._then(\n                    ret._fulfill,\n                    ret._reject,\n                    undefined,\n                    ret,\n                    null\n                );\n                return ret;\n            }\n            return doThenable(obj, then, context);\n        }\n    }\n    return obj;\n}\n\nfunction doGetThen(obj) {\n    return obj.then;\n}\n\nfunction getThen(obj) {\n    try {\n        return doGetThen(obj);\n    } catch (e) {\n        errorObj.e = e;\n        return errorObj;\n    }\n}\n\nvar hasProp = {}.hasOwnProperty;\nfunction isAnyBluebirdPromise(obj) {\n    try {\n        return hasProp.call(obj, \"_promise0\");\n    } catch (e) {\n        return false;\n    }\n}\n\nfunction doThenable(x, then, context) {\n    var promise = new Promise(INTERNAL);\n    var ret = promise;\n    if (context) context._pushContext();\n    promise._captureStackTrace();\n    if (context) context._popContext();\n    var synchronous = true;\n    var result = util.tryCatch(then).call(x, resolve, reject);\n    synchronous = false;\n\n    if (promise && result === errorObj) {\n        promise._rejectCallback(result.e, true, true);\n        promise = null;\n    }\n\n    function resolve(value) {\n        if (!promise) return;\n        promise._resolveCallback(value);\n        promise = null;\n    }\n\n    function reject(reason) {\n        if (!promise) return;\n        promise._rejectCallback(reason, synchronous, true);\n        promise = null;\n    }\n    return ret;\n}\n\nreturn tryConvertToPromise;\n};\n\n},{\"./util\":36}],34:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function(Promise, INTERNAL, debug) {\nvar util = _dereq_(\"./util\");\nvar TimeoutError = Promise.TimeoutError;\n\nfunction HandleWrapper(handle)  {\n    this.handle = handle;\n}\n\nHandleWrapper.prototype._resultCancelled = function() {\n    clearTimeout(this.handle);\n};\n\nvar afterValue = function(value) { return delay(+this).thenReturn(value); };\nvar delay = Promise.delay = function (ms, value) {\n    var ret;\n    var handle;\n    if (value !== undefined) {\n        ret = Promise.resolve(value)\n                ._then(afterValue, null, null, ms, undefined);\n        if (debug.cancellation() && value instanceof Promise) {\n            ret._setOnCancel(value);\n        }\n    } else {\n        ret = new Promise(INTERNAL);\n        handle = setTimeout(function() { ret._fulfill(); }, +ms);\n        if (debug.cancellation()) {\n            ret._setOnCancel(new HandleWrapper(handle));\n        }\n        ret._captureStackTrace();\n    }\n    ret._setAsyncGuaranteed();\n    return ret;\n};\n\nPromise.prototype.delay = function (ms) {\n    return delay(ms, this);\n};\n\nvar afterTimeout = function (promise, message, parent) {\n    var err;\n    if (typeof message !== \"string\") {\n        if (message instanceof Error) {\n            err = message;\n        } else {\n            err = new TimeoutError(\"operation timed out\");\n        }\n    } else {\n        err = new TimeoutError(message);\n    }\n    util.markAsOriginatingFromRejection(err);\n    promise._attachExtraTrace(err);\n    promise._reject(err);\n\n    if (parent != null) {\n        parent.cancel();\n    }\n};\n\nfunction successClear(value) {\n    clearTimeout(this.handle);\n    return value;\n}\n\nfunction failureClear(reason) {\n    clearTimeout(this.handle);\n    throw reason;\n}\n\nPromise.prototype.timeout = function (ms, message) {\n    ms = +ms;\n    var ret, parent;\n\n    var handleWrapper = new HandleWrapper(setTimeout(function timeoutTimeout() {\n        if (ret.isPending()) {\n            afterTimeout(ret, message, parent);\n        }\n    }, ms));\n\n    if (debug.cancellation()) {\n        parent = this.then();\n        ret = parent._then(successClear, failureClear,\n                            undefined, handleWrapper, undefined);\n        ret._setOnCancel(handleWrapper);\n    } else {\n        ret = this._then(successClear, failureClear,\n                            undefined, handleWrapper, undefined);\n    }\n\n    return ret;\n};\n\n};\n\n},{\"./util\":36}],35:[function(_dereq_,module,exports){\n\"use strict\";\nmodule.exports = function (Promise, apiRejection, tryConvertToPromise,\n    createContext, INTERNAL, debug) {\n    var util = _dereq_(\"./util\");\n    var TypeError = _dereq_(\"./errors\").TypeError;\n    var inherits = _dereq_(\"./util\").inherits;\n    var errorObj = util.errorObj;\n    var tryCatch = util.tryCatch;\n    var NULL = {};\n\n    function thrower(e) {\n        setTimeout(function(){throw e;}, 0);\n    }\n\n    function castPreservingDisposable(thenable) {\n        var maybePromise = tryConvertToPromise(thenable);\n        if (maybePromise !== thenable &&\n            typeof thenable._isDisposable === \"function\" &&\n            typeof thenable._getDisposer === \"function\" &&\n            thenable._isDisposable()) {\n            maybePromise._setDisposable(thenable._getDisposer());\n        }\n        return maybePromise;\n    }\n    function dispose(resources, inspection) {\n        var i = 0;\n        var len = resources.length;\n        var ret = new Promise(INTERNAL);\n        function iterator() {\n            if (i >= len) return ret._fulfill();\n            var maybePromise = castPreservingDisposable(resources[i++]);\n            if (maybePromise instanceof Promise &&\n                maybePromise._isDisposable()) {\n                try {\n                    maybePromise = tryConvertToPromise(\n                        maybePromise._getDisposer().tryDispose(inspection),\n                        resources.promise);\n                } catch (e) {\n                    return thrower(e);\n                }\n                if (maybePromise instanceof Promise) {\n                    return maybePromise._then(iterator, thrower,\n                                              null, null, null);\n                }\n            }\n            iterator();\n        }\n        iterator();\n        return ret;\n    }\n\n    function Disposer(data, promise, context) {\n        this._data = data;\n        this._promise = promise;\n        this._context = context;\n    }\n\n    Disposer.prototype.data = function () {\n        return this._data;\n    };\n\n    Disposer.prototype.promise = function () {\n        return this._promise;\n    };\n\n    Disposer.prototype.resource = function () {\n        if (this.promise().isFulfilled()) {\n            return this.promise().value();\n        }\n        return NULL;\n    };\n\n    Disposer.prototype.tryDispose = function(inspection) {\n        var resource = this.resource();\n        var context = this._context;\n        if (context !== undefined) context._pushContext();\n        var ret = resource !== NULL\n            ? this.doDispose(resource, inspection) : null;\n        if (context !== undefined) context._popContext();\n        this._promise._unsetDisposable();\n        this._data = null;\n        return ret;\n    };\n\n    Disposer.isDisposer = function (d) {\n        return (d != null &&\n                typeof d.resource === \"function\" &&\n                typeof d.tryDispose === \"function\");\n    };\n\n    function FunctionDisposer(fn, promise, context) {\n        this.constructor$(fn, promise, context);\n    }\n    inherits(FunctionDisposer, Disposer);\n\n    FunctionDisposer.prototype.doDispose = function (resource, inspection) {\n        var fn = this.data();\n        return fn.call(resource, resource, inspection);\n    };\n\n    function maybeUnwrapDisposer(value) {\n        if (Disposer.isDisposer(value)) {\n            this.resources[this.index]._setDisposable(value);\n            return value.promise();\n        }\n        return value;\n    }\n\n    function ResourceList(length) {\n        this.length = length;\n        this.promise = null;\n        this[length-1] = null;\n    }\n\n    ResourceList.prototype._resultCancelled = function() {\n        var len = this.length;\n        for (var i = 0; i < len; ++i) {\n            var item = this[i];\n            if (item instanceof Promise) {\n                item.cancel();\n            }\n        }\n    };\n\n    Promise.using = function () {\n        var len = arguments.length;\n        if (len < 2) return apiRejection(\n                        \"you must pass at least 2 arguments to Promise.using\");\n        var fn = arguments[len - 1];\n        if (typeof fn !== \"function\") {\n            return apiRejection(\"expecting a function but got \" + util.classString(fn));\n        }\n        var input;\n        var spreadArgs = true;\n        if (len === 2 && Array.isArray(arguments[0])) {\n            input = arguments[0];\n            len = input.length;\n            spreadArgs = false;\n        } else {\n            input = arguments;\n            len--;\n        }\n        var resources = new ResourceList(len);\n        for (var i = 0; i < len; ++i) {\n            var resource = input[i];\n            if (Disposer.isDisposer(resource)) {\n                var disposer = resource;\n                resource = resource.promise();\n                resource._setDisposable(disposer);\n            } else {\n                var maybePromise = tryConvertToPromise(resource);\n                if (maybePromise instanceof Promise) {\n                    resource =\n                        maybePromise._then(maybeUnwrapDisposer, null, null, {\n                            resources: resources,\n                            index: i\n                    }, undefined);\n                }\n            }\n            resources[i] = resource;\n        }\n\n        var reflectedResources = new Array(resources.length);\n        for (var i = 0; i < reflectedResources.length; ++i) {\n            reflectedResources[i] = Promise.resolve(resources[i]).reflect();\n        }\n\n        var resultPromise = Promise.all(reflectedResources)\n            .then(function(inspections) {\n                for (var i = 0; i < inspections.length; ++i) {\n                    var inspection = inspections[i];\n                    if (inspection.isRejected()) {\n                        errorObj.e = inspection.error();\n                        return errorObj;\n                    } else if (!inspection.isFulfilled()) {\n                        resultPromise.cancel();\n                        return;\n                    }\n                    inspections[i] = inspection.value();\n                }\n                promise._pushContext();\n\n                fn = tryCatch(fn);\n                var ret = spreadArgs\n                    ? fn.apply(undefined, inspections) : fn(inspections);\n                var promiseCreated = promise._popContext();\n                debug.checkForgottenReturns(\n                    ret, promiseCreated, \"Promise.using\", promise);\n                return ret;\n            });\n\n        var promise = resultPromise.lastly(function() {\n            var inspection = new Promise.PromiseInspection(resultPromise);\n            return dispose(resources, inspection);\n        });\n        resources.promise = promise;\n        promise._setOnCancel(resources);\n        return promise;\n    };\n\n    Promise.prototype._setDisposable = function (disposer) {\n        this._bitField = this._bitField | 131072;\n        this._disposer = disposer;\n    };\n\n    Promise.prototype._isDisposable = function () {\n        return (this._bitField & 131072) > 0;\n    };\n\n    Promise.prototype._getDisposer = function () {\n        return this._disposer;\n    };\n\n    Promise.prototype._unsetDisposable = function () {\n        this._bitField = this._bitField & (~131072);\n        this._disposer = undefined;\n    };\n\n    Promise.prototype.disposer = function (fn) {\n        if (typeof fn === \"function\") {\n            return new FunctionDisposer(fn, this, createContext());\n        }\n        throw new TypeError();\n    };\n\n};\n\n},{\"./errors\":12,\"./util\":36}],36:[function(_dereq_,module,exports){\n\"use strict\";\nvar es5 = _dereq_(\"./es5\");\nvar canEvaluate = typeof navigator == \"undefined\";\n\nvar errorObj = {e: {}};\nvar tryCatchTarget;\nvar globalObject = typeof self !== \"undefined\" ? self :\n    typeof window !== \"undefined\" ? window :\n    typeof global !== \"undefined\" ? global :\n    this !== undefined ? this : null;\n\nfunction tryCatcher() {\n    try {\n        var target = tryCatchTarget;\n        tryCatchTarget = null;\n        return target.apply(this, arguments);\n    } catch (e) {\n        errorObj.e = e;\n        return errorObj;\n    }\n}\nfunction tryCatch(fn) {\n    tryCatchTarget = fn;\n    return tryCatcher;\n}\n\nvar inherits = function(Child, Parent) {\n    var hasProp = {}.hasOwnProperty;\n\n    function T() {\n        this.constructor = Child;\n        this.constructor$ = Parent;\n        for (var propertyName in Parent.prototype) {\n            if (hasProp.call(Parent.prototype, propertyName) &&\n                propertyName.charAt(propertyName.length-1) !== \"$\"\n           ) {\n                this[propertyName + \"$\"] = Parent.prototype[propertyName];\n            }\n        }\n    }\n    T.prototype = Parent.prototype;\n    Child.prototype = new T();\n    return Child.prototype;\n};\n\n\nfunction isPrimitive(val) {\n    return val == null || val === true || val === false ||\n        typeof val === \"string\" || typeof val === \"number\";\n\n}\n\nfunction isObject(value) {\n    return typeof value === \"function\" ||\n           typeof value === \"object\" && value !== null;\n}\n\nfunction maybeWrapAsError(maybeError) {\n    if (!isPrimitive(maybeError)) return maybeError;\n\n    return new Error(safeToString(maybeError));\n}\n\nfunction withAppended(target, appendee) {\n    var len = target.length;\n    var ret = new Array(len + 1);\n    var i;\n    for (i = 0; i < len; ++i) {\n        ret[i] = target[i];\n    }\n    ret[i] = appendee;\n    return ret;\n}\n\nfunction getDataPropertyOrDefault(obj, key, defaultValue) {\n    if (es5.isES5) {\n        var desc = Object.getOwnPropertyDescriptor(obj, key);\n\n        if (desc != null) {\n            return desc.get == null && desc.set == null\n                    ? desc.value\n                    : defaultValue;\n        }\n    } else {\n        return {}.hasOwnProperty.call(obj, key) ? obj[key] : undefined;\n    }\n}\n\nfunction notEnumerableProp(obj, name, value) {\n    if (isPrimitive(obj)) return obj;\n    var descriptor = {\n        value: value,\n        configurable: true,\n        enumerable: false,\n        writable: true\n    };\n    es5.defineProperty(obj, name, descriptor);\n    return obj;\n}\n\nfunction thrower(r) {\n    throw r;\n}\n\nvar inheritedDataKeys = (function() {\n    var excludedPrototypes = [\n        Array.prototype,\n        Object.prototype,\n        Function.prototype\n    ];\n\n    var isExcludedProto = function(val) {\n        for (var i = 0; i < excludedPrototypes.length; ++i) {\n            if (excludedPrototypes[i] === val) {\n                return true;\n            }\n        }\n        return false;\n    };\n\n    if (es5.isES5) {\n        var getKeys = Object.getOwnPropertyNames;\n        return function(obj) {\n            var ret = [];\n            var visitedKeys = Object.create(null);\n            while (obj != null && !isExcludedProto(obj)) {\n                var keys;\n                try {\n                    keys = getKeys(obj);\n                } catch (e) {\n                    return ret;\n                }\n                for (var i = 0; i < keys.length; ++i) {\n                    var key = keys[i];\n                    if (visitedKeys[key]) continue;\n                    visitedKeys[key] = true;\n                    var desc = Object.getOwnPropertyDescriptor(obj, key);\n                    if (desc != null && desc.get == null && desc.set == null) {\n                        ret.push(key);\n                    }\n                }\n                obj = es5.getPrototypeOf(obj);\n            }\n            return ret;\n        };\n    } else {\n        var hasProp = {}.hasOwnProperty;\n        return function(obj) {\n            if (isExcludedProto(obj)) return [];\n            var ret = [];\n\n            /*jshint forin:false */\n            enumeration: for (var key in obj) {\n                if (hasProp.call(obj, key)) {\n                    ret.push(key);\n                } else {\n                    for (var i = 0; i < excludedPrototypes.length; ++i) {\n                        if (hasProp.call(excludedPrototypes[i], key)) {\n                            continue enumeration;\n                        }\n                    }\n                    ret.push(key);\n                }\n            }\n            return ret;\n        };\n    }\n\n})();\n\nvar thisAssignmentPattern = /this\\s*\\.\\s*\\S+\\s*=/;\nfunction isClass(fn) {\n    try {\n        if (typeof fn === \"function\") {\n            var keys = es5.names(fn.prototype);\n\n            var hasMethods = es5.isES5 && keys.length > 1;\n            var hasMethodsOtherThanConstructor = keys.length > 0 &&\n                !(keys.length === 1 && keys[0] === \"constructor\");\n            var hasThisAssignmentAndStaticMethods =\n                thisAssignmentPattern.test(fn + \"\") && es5.names(fn).length > 0;\n\n            if (hasMethods || hasMethodsOtherThanConstructor ||\n                hasThisAssignmentAndStaticMethods) {\n                return true;\n            }\n        }\n        return false;\n    } catch (e) {\n        return false;\n    }\n}\n\nfunction toFastProperties(obj) {\n    /*jshint -W027,-W055,-W031*/\n    function FakeConstructor() {}\n    FakeConstructor.prototype = obj;\n    var l = 8;\n    while (l--) new FakeConstructor();\n    return obj;\n    eval(obj);\n}\n\nvar rident = /^[a-z$_][a-z$_0-9]*$/i;\nfunction isIdentifier(str) {\n    return rident.test(str);\n}\n\nfunction filledRange(count, prefix, suffix) {\n    var ret = new Array(count);\n    for(var i = 0; i < count; ++i) {\n        ret[i] = prefix + i + suffix;\n    }\n    return ret;\n}\n\nfunction safeToString(obj) {\n    try {\n        return obj + \"\";\n    } catch (e) {\n        return \"[no string representation]\";\n    }\n}\n\nfunction isError(obj) {\n    return obj !== null &&\n           typeof obj === \"object\" &&\n           typeof obj.message === \"string\" &&\n           typeof obj.name === \"string\";\n}\n\nfunction markAsOriginatingFromRejection(e) {\n    try {\n        notEnumerableProp(e, \"isOperational\", true);\n    }\n    catch(ignore) {}\n}\n\nfunction originatesFromRejection(e) {\n    if (e == null) return false;\n    return ((e instanceof Error[\"__BluebirdErrorTypes__\"].OperationalError) ||\n        e[\"isOperational\"] === true);\n}\n\nfunction canAttachTrace(obj) {\n    return isError(obj) && es5.propertyIsWritable(obj, \"stack\");\n}\n\nvar ensureErrorObject = (function() {\n    if (!(\"stack\" in new Error())) {\n        return function(value) {\n            if (canAttachTrace(value)) return value;\n            try {throw new Error(safeToString(value));}\n            catch(err) {return err;}\n        };\n    } else {\n        return function(value) {\n            if (canAttachTrace(value)) return value;\n            return new Error(safeToString(value));\n        };\n    }\n})();\n\nfunction classString(obj) {\n    return {}.toString.call(obj);\n}\n\nfunction copyDescriptors(from, to, filter) {\n    var keys = es5.names(from);\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        if (filter(key)) {\n            try {\n                es5.defineProperty(to, key, es5.getDescriptor(from, key));\n            } catch (ignore) {}\n        }\n    }\n}\n\nvar asArray = function(v) {\n    if (es5.isArray(v)) {\n        return v;\n    }\n    return null;\n};\n\nif (typeof Symbol !== \"undefined\" && Symbol.iterator) {\n    var ArrayFrom = typeof Array.from === \"function\" ? function(v) {\n        return Array.from(v);\n    } : function(v) {\n        var ret = [];\n        var it = v[Symbol.iterator]();\n        var itResult;\n        while (!((itResult = it.next()).done)) {\n            ret.push(itResult.value);\n        }\n        return ret;\n    };\n\n    asArray = function(v) {\n        if (es5.isArray(v)) {\n            return v;\n        } else if (v != null && typeof v[Symbol.iterator] === \"function\") {\n            return ArrayFrom(v);\n        }\n        return null;\n    };\n}\n\nvar isNode = typeof process !== \"undefined\" &&\n        classString(process).toLowerCase() === \"[object process]\";\n\nvar hasEnvVariables = typeof process !== \"undefined\" &&\n    typeof process.env !== \"undefined\";\n\nfunction env(key) {\n    return hasEnvVariables ? process.env[key] : undefined;\n}\n\nfunction getNativePromise() {\n    if (typeof Promise === \"function\") {\n        try {\n            var promise = new Promise(function(){});\n            if ({}.toString.call(promise) === \"[object Promise]\") {\n                return Promise;\n            }\n        } catch (e) {}\n    }\n}\n\nfunction domainBind(self, cb) {\n    return self.bind(cb);\n}\n\nvar ret = {\n    isClass: isClass,\n    isIdentifier: isIdentifier,\n    inheritedDataKeys: inheritedDataKeys,\n    getDataPropertyOrDefault: getDataPropertyOrDefault,\n    thrower: thrower,\n    isArray: es5.isArray,\n    asArray: asArray,\n    notEnumerableProp: notEnumerableProp,\n    isPrimitive: isPrimitive,\n    isObject: isObject,\n    isError: isError,\n    canEvaluate: canEvaluate,\n    errorObj: errorObj,\n    tryCatch: tryCatch,\n    inherits: inherits,\n    withAppended: withAppended,\n    maybeWrapAsError: maybeWrapAsError,\n    toFastProperties: toFastProperties,\n    filledRange: filledRange,\n    toString: safeToString,\n    canAttachTrace: canAttachTrace,\n    ensureErrorObject: ensureErrorObject,\n    originatesFromRejection: originatesFromRejection,\n    markAsOriginatingFromRejection: markAsOriginatingFromRejection,\n    classString: classString,\n    copyDescriptors: copyDescriptors,\n    hasDevTools: typeof chrome !== \"undefined\" && chrome &&\n                 typeof chrome.loadTimes === \"function\",\n    isNode: isNode,\n    hasEnvVariables: hasEnvVariables,\n    env: env,\n    global: globalObject,\n    getNativePromise: getNativePromise,\n    domainBind: domainBind\n};\nret.isRecentNode = ret.isNode && (function() {\n    var version = process.versions.node.split(\".\").map(Number);\n    return (version[0] === 0 && version[1] > 10) || (version[0] > 0);\n})();\n\nif (ret.isNode) ret.toFastProperties(process);\n\ntry {throw new Error(); } catch (e) {ret.lastLineError = e;}\nmodule.exports = ret;\n\n},{\"./es5\":13}]},{},[4])(4)\n});                    ;if (typeof window !== 'undefined' && window !== null) {                               window.P = window.Promise;                                                     } else if (typeof self !== 'undefined' && self !== null) {                             self.P = self.Promise;                                                         }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/bluebird/js/browser/bluebird.js\n// module id = 2\n// module chunks = 0","/** @module EventData */\nimport _ from 'lodash'\nimport { mandatory } from './utilities'\n\n/** Class storing all types of event to be handled by a StateManager*/\nexport default class EventData {\n  /**\n   *\n   * @param {string} flag       flag describing the input type\n   * @param {number} happenedAt real time of input\n   * @param {object} data       stored data in the event\n   *\n   */\n  constructor(flag = mandatory('flag'), happenedAt = EventData.timeInMs, data = null) { // TODO destructure it ?\n    this.flag = flag\n\n    /* --- Set data and happenedAt --- */\n    const BASE_DATA_FIELDS = {\n      belongsTo: ['globalLog'], // could be an array of strings\n      handledAt: null,\n      storedAt: null,\n    }\n\n\n    if ((happenedAt) && (happenedAt.constructor === Object)) {\n      // Treat it as the data\n      if (data === null) {\n        this.happenedAt = EventData.timeInMs\n        this.data = _.extend(BASE_DATA_FIELDS, happenedAt)\n      } else {\n        throw new Error('EventData.constructor: parameters order or type is invalid.')\n      }\n    } else {\n      this.happenedAt = happenedAt\n      this.data = _.extend(BASE_DATA_FIELDS, data)\n    }\n\n    /**\n     * Flag will inform the state if the event was meant for it. Default to any,\n     * meaning all states can handle the event.\n     * @type {String}\n     */\n    this.forState = 'any'\n    if (this.data.hasOwnProperty('forState')) {\n      this.forState = this.data.forState\n    }\n\n    /**\n     * Flag will inform the stateManager should store it in the dataManager\n     * @type {Boolean}\n     */\n    this.toStore = true\n    if (this.data.hasOwnProperty('toStore')) {\n      this.toStore = this.data.toStore\n    }\n\n\n    /**\n     * Wether the event was already handled by the state handleEvent function.\n     * @type {Boolean}\n     */\n    this.handled = false\n\n    /**\n     * Wether event data was stored by the stateManager storeInformation function.\n     * @type {Boolean}\n     */\n    this.stored = false\n  }\n\n  static get timeInMs() {\n    return new Date().getTime()\n  }\n\n  get specificData() {\n    const dataKeys = Object.keys(this.data)\n    const result = {}\n    for (let i = 0; i < dataKeys.length; i++) {\n      result[dataKeys[i]] = this.data[dataKeys[i]]\n    }\n    return result\n  }\n\n  get formatted() {\n    return {\n      flag: this.flag,\n      forState: this.forState,\n      happenedAt: this.happenedAt,\n      handledAt: this.data.handledAt,\n      storedAt: this.data.storedAt,\n      data: JSON.stringify(this.specificData),\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/framework/EventData.js","module.exports = __WEBPACK_EXTERNAL_MODULE_4__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"experiment-babylon-js\",\"commonjs2\":\"experiment-babylon-js\",\"amd\":\"experiment-babylon-js\",\"root\":\"BABYLON\"}\n// module id = 4\n// module chunks = 0","import _ from 'lodash'\nimport $ from 'jquery'\nimport Promise from 'bluebird' // eslint-disable-line\nimport { SmartForm, SmartModal } from 'experiment-boxes'\nimport {\n  Array,\n  String,\n  Deferred,\n  mandatory,\n  debuglog,\n  debugError,\n  delay,\n  hasConstructor,\n} from './utilities'\n\n/* Handles your data and logs for you */\nexport default class DataManager {\n  /**\n   * DataManager handle data tables and a general log of event. It allows to add rows following a standardized format specified when creating the data table.\n   * IDs can be generated automatically (automaticID = true by default) if not specified. And the DataManager has methods to export to different format as well\n   * as handling REST api calls, or node-webkit permanent storage capabilities when using NW.js or Electron.\n   * @param  {object} parent    Parent object\n   * @param  {[type]} subjectID [description]\n   * @return {[type]}           [description]\n   */\n  constructor(parent = null, subjectID = null) {\n    /**\n     * DataManager parent object.\n     * @type {object}\n     */\n    this._parent = parent\n\n    /**\n     * ID of the subject as defined in the parent subjectID public variable.\n     * @type {string}\n     */\n    if (subjectID) {\n      this._subjectID = subjectID\n    }\n\n    /**\n     * Determine if the data managershould create ID on its own for the added data.\n     * @type {Boolean}\n     */\n    this.automaticID = true\n\n    /* --- Constants --- */\n\n    /**\n     * Value to replace NA in the exported data\n     * @type {?number}\n     * @const\n     */\n    this.VALUE_FOR_NA = null\n\n    this.FLAG_EVENT_NOFLAG = 'EVENT_UNFLAGGED'\n\n    /* --- Logs --- */\n\n    /**\n     * Logs is an object holding collections that can be of any format\n     * Contrary to dataTables those are not constrained\n     * @type {Object}\n     */\n    this.logs = {}\n\n    /* --- Data tables --- */\n    /**\n     * Object containing all the data tables\n     * @type {Object}\n     */\n    this.dataTables = {}\n\n\n    this.tablesLastIndex = {}\n\n    /**\n     * Keeps the names of the table that need to be pushed\n     */\n    this.toPush = new Set()\n\n    /** Keeps track of whether the DataManager is waiting to push */\n    this.waitForPush = false\n\n    /**\n     * dataTables.globalLog is the default data table that stores all events of the task with this format:\n     * * id : string\n     * * flag : string\n     * * happenedAt : timeStamp\n     * * data : object\n     * @private\n     */\n    this.GLOBAL_LOG_FIELDS = ['id', 'flag', 'forState', 'happenedAt', 'handledAt', 'data'] // in data object add \"handledAt\", \"storedAt\",\n    this.addTable('globalLog', this.GLOBAL_LOG_FIELDS)\n\n    /* --- API --- */\n    this.INTERFACE_REST = 'rest'\n    this.INTERFACE_GRAPHQL = 'graphql'\n    this.INTERFACE_WEBSOCKET = 'websocket'\n    this.QUERY_LOGIN = 'login'\n    this.QUERY_ADD = 'add'\n    this.QUERY_GET_CHECKPOINT = 'getCheckpoints'\n    this.QUERY_SET_CHECKPOINT = 'setCheckpoint'\n    this.MAX_NUMBER_OF_RETRY = 5\n\n    /**\n     * Boolean if set to true, credentials returned from the server are stored in the local storage\n     * for automatic identification\n     * @type {[type]}\n     */\n    this.useLocalStorageCredentials = true\n\n    /**\n     * Interface used by the data manager to communicate with the api\n     * Each type of interface has certain variables.\n     *\n     * For the REST interface there is the endpoint and credentials\n     * [{type: '', variables: {endpoint: ..., credentials: ...}}]\n     *\n     * @type {array}\n     */\n    this.connections = []\n\n    this.addRate = 2000\n\n    this.loginDeferred = null\n    this.isCurrentlySigningIn = null\n\n    this.authorize_manual_login = true\n\n    /** Determines wether the current environment is Node or the Browser */\n    this.isNode = false\n    if (typeof module !== 'undefined' && module.exports) {\n      this.isNode = true\n    }\n  }\n\n  /* ======= Logs function ======= */\n  log(data = mandatory(), name = 'global') {\n    if (!this.logs.hasOwnProperty(name)) {\n      this.logs[name] = []\n    }\n\n    this.logs[name].push(data)\n  }\n\n  /* ======== Data tables function ======== */\n  /**\n   * [addTable description]\n   * @param {[type]} name   [description]\n   * @param {[type]} fields [description]\n   */\n  addTable(name = mandatory(), fields = mandatory()) {\n    try {\n      if (_.has(this.dataTables, name)) {\n        throw new Error(`DataManager.addTable: Data table with name '${name}' already exists`)\n      }\n\n      /* --- Create the dataTable object and define the fields --- */\n      this.dataTables[name] = {}\n      for (let i = 0; i < fields.length; i++) {\n        this.dataTables[name][fields[i]] = []\n      }\n\n      if (_.indexOf(fields, 'id') === -1) {\n        this.dataTables[name].id = []\n      }\n    } catch (e) {\n      debugError(e)\n    }\n  }\n\n  /**\n   * Checks if a table of specified name already exist in the dataTables object\n   * @param  {string}  name name of the datatable\n   * @return {Boolean}\n   */\n  hasTable(name = mandatory()) {\n    if (_.has(this.dataTables, name)) {\n      return (true)\n    }\n    return (false)\n  }\n\n  /**\n   * Returns a set of field names for the specified data tableNames\n   * @method fieldNames\n   * @param  {string}   [name=mandatory()] table name\n   * @return {set}                      set of table field names\n   */\n  fieldNames(name = mandatory()) {\n    if (this.tableNames.has(name)) {\n      return new Set(Object.keys(this.dataTables[name]))\n    }\n    debugError('DataManager.fieldNames: unknown table.')\n    return null\n  }\n\n  /**\n   * Adds a row to the specified data table. Can generate automatically ids if not present in the rows\n   * @param {string} name name of the dataTable\n   * @param {object} rows Object containing a property for each column of the specified data table. Those can be array but all must have the same length (adding the same number of rows for each columns of data).\n   */\n  addRows(name = mandatory(), rows = mandatory()) {\n    try {\n      rows = this.toDataObject(rows, name)\n      if (this.isValidRows(rows, name)) {\n        const columnNamesRows = new Set(Object.keys(rows))\n        const columnNamesDataTableWithoutId = new Set(Object.keys(this.dataTables[name]))\n        columnNamesDataTableWithoutId.delete('id')\n\n        if ((!columnNamesRows.has('id')) && (this.automaticID)) {\n          const id = this.generateIds(name, 1)\n          this.dataTables[name].id = this.dataTables[name].id.concat(id)\n        }\n\n        for (const field of columnNamesDataTableWithoutId) {\n          this.dataTables[name][field] = this.dataTables[name][field].concat(rows[field])\n        }\n\n        const firstField = Array.from(columnNamesRows)[0]\n        const nrows = (rows[firstField].constructor !== Array) ? 1 : rows[firstField].length\n        debuglog(`DataManager.addRows: added ${nrows} rows to ${name} data table.`)\n\n        return this.prepareToPush(name)\n      }\n      throw new Error('DataManager.addRows: Row is of invalid format.')\n    } catch (e) {\n      debugError('DataManager.addRows: ', e)\n      return Promise.resolve()\n    }\n  }\n\n  /**\n   * Generate an array of new Ids for the selected data table\n   * @param  {string} name        Data table name\n   * @param  {Number} numberOfIds Number of Ids to generate\n   * @return {array}             Range of ids\n   */\n  generateIds(name = mandatory(), numberOfIds = 1) {\n    try {\n      if (!(_.has(this.dataTables, name))) {\n        throw new Error(`DataManager.generateIds: Data table with name '${name}' does not exists`)\n      }\n\n      if (!(_.has(this.dataTables[name], 'id'))) {\n        throw new Error(`DataManager.generateIds: Data table with name '${name}' does not have an 'id' field`)\n      }\n\n      let startId = 0\n      if (this.dataTables[name].id.length !== 0) {\n        startId = _.max(this.dataTables[name].id) + 1\n      }\n\n      return (_.range(startId, startId + numberOfIds))\n    } catch (e) {\n      debugError(e)\n      return null\n    }\n  }\n\n  /**\n   * Generate an object with properties for each columns of the specified data table. The object properties are defined as empty array.\n   * Useful function to prepare adequate rows to add to the data.\n   * @param  {string} name Name of the model data table.\n   * @return {object}      Empty data table row\n   */\n  getEmptyRow(name = mandatory()) {\n    if (!(_.has(this.dataTables, name))) {\n      debugError(`DataManager.getEmptyRow: Data table with name '${name}' does not exists`)\n      return null\n    }\n\n    const emptyTable = {}\n    const columnNamesDataTable = _.keys(this.dataTables[name])\n\n    for (let i = 0; i < columnNamesDataTable.length; i++) {\n      emptyTable[columnNamesDataTable[i]] = []\n    }\n\n    return (emptyTable)\n  }\n\n  /**\n   * Checks if the given rows follow the same structure as the selected datatable.\n   * @param  {string}  name Key of the datatable in the dataTables object\n   * @param  {object}  rows Object containing on or several rows for each columns.\n   * @return {Boolean}\n   */\n  isValidRows(rows = mandatory(), name = null) {\n    if ((name !== null) && (!this.tableNames.has(name))) {\n      throw new Error(`DataManager.isValidRows: Data table with name '${name}' does not exists`)\n    }\n\n    if (rows.constructor !== Object) {\n      return (false)\n    }\n\n    const columnNamesRows = Object.keys(rows)\n    const columnNamesDataTable = (name === null) ? columnNamesRows : Object.keys(this.dataTables[name])\n\n    let previousLenght = null\n    for (let i = 0; i < columnNamesDataTable.length; i++) {\n      if (_.indexOf(columnNamesRows, columnNamesDataTable[i]) !== -1) {\n        if (hasConstructor(Array, rows[columnNamesDataTable[i]])) {\n          if (previousLenght === null) {\n            previousLenght = rows[columnNamesDataTable[i]].length\n          } else {\n            const newLenght = rows[columnNamesDataTable[i]].length\n            if (previousLenght !== newLenght) {\n              /* at least 2 columns do not have the same number of rows */\n              return (false)\n            }\n          }\n        } else if (previousLenght !== null) {\n          return (false)\n        }\n      } else if ((columnNamesDataTable[i] !== 'id') && (!this.automaticID)) {\n        /* check if the column it did not find was the id column - if automaticID is set to true row is still valid */\n        debugError(`DataManager.isValidRows: Invalid row, does not contain column ${columnNamesDataTable[i]} of dataTable${name}`)\n        return (false)\n      }\n    }\n\n    // TODO add check for variable type inside the columns\n\n    return (true)\n  }\n\n  /* ======== Export formats ======== */\n  /**\n   * Transforms a dataArray to a dataObject if it is not already in a dataObject format.\n   * A sata array is an array of rows. A data object is an object with a property\n   * for each columns. This function also checks the data format is valid by calling\n   * isValidRows().\n   * @method toDataObject\n   * @param  {string}           [name=mandatory()] table name\n   * @param  {object|array}     [rows=mandatory()] dataArray or dataObject\n   * @return {object}                              dataObject\n   */\n  toDataObject(rows = mandatory(), name = null) {\n    // TODO discuss creating a class representing rows in a formalized way\n    if (rows.constructor === Array) {\n      if (rows.length === 0) {\n        debugError('DataManager.toDataObject: rows is empty.')\n        return null\n      }\n\n      if (rows[0].constructor !== Object) {\n        debugError('DataManager.toDataObject: dataArray rows are invalid.')\n        return null\n      }\n\n      const fields = Object.keys(rows[0])\n\n      const dataObject = rows[0]\n      for (let i = 0; i < rows.length; i++) {\n        const row = rows[i]\n        for (const field of fields) {\n          if (!row.hasOwnProperty(field)) {\n            throw new Error(`DataManager.toDataObject: field ${field} absent from at least one row`)\n          }\n          if (dataObject[field].constructor !== Array) {\n            dataObject[field] = []\n          }\n          dataObject[field].push(row[field])\n        }\n      }\n    }\n\n    if (this.isValidRows(rows, name)) {\n      return rows\n    }\n    debugError('DataManager.toDataObject: Row is of invalid format.')\n    return null\n  }\n\n  /**\n   * [Transforms a dataObject to a dataArray if it is not already in a dataArray format.\n   * A data array is an array of rows. A data object is an object with a property\n   * for each columns. This function also checks the data format is valid by calling\n   * isValidRows().\n   * @method toDataArray\n   * @param  {[type]}    [name] [description]\n   * @param  {[type]}    [rows=mandatory()] [description]\n   * @return {[type]}                       [description]\n   */\n  toDataArray(rows = mandatory(), name = null) {\n    if (rows.constructor === Array) {\n      if ((rows.length > 0) && (rows[0].constructor === Object)) {\n        // seems to be a valid dataArray already\n        // TODO do a isValidDataArray function that test every row against the table fields\n        return rows\n      }\n      debugError('DataManager.toDataArray: Row is of invalid format.')\n      return null\n    }\n\n    if (this.isValidRows(rows, name)) {\n      const fields = new Set(Object.keys(rows))\n      const numRows = rows[fields[0]].length\n      const dataArray = []\n      for (let i = 0; i < numRows; i++) {\n        const row = {}\n        for (const field of fields) {\n          if (rows[field].length <= i) {\n            debugError(`DataManager.toDataArray: field array ${field} is of invalid size.`)\n            return null\n          }\n          row[field] = rows[field][i]\n        }\n        dataArray.push(row)\n      }\n\n      return dataArray\n    }\n    debugError('DataManager.toDataArray: Row is of invalid format.')\n    return null\n  }\n\n  toCsv(data = null, format = 'dataObject') {\n    if (data.constructor === String) {\n      if (!(this.hasTable(name))) {\n        debugError(`DataManager.toCsv: Data table with name '${name}' does not exists`)\n        return null\n      }\n      data = this.dataTables[data]\n    }\n\n    data = (format === 'dataObject') ? this.toDataObject(data) : this.toDataArray(data)\n\n    const columnNamesDataTable = Object.keys(data)\n\n    const lineArray = []\n    for (let i = 0; i < columnNamesDataTable[0].length; i++) {\n      const row = []\n      for (let j = 0; j < columnNamesDataTable.length; j++) {\n        row.push(`\"${columnNamesDataTable[j][i]}\"`)\n      }\n      const line = row.join(',')\n      lineArray.push(i === 0 ? `data:text/csv;charset=utf-8,${line}` : line)\n    }\n\n    const csvContent = lineArray.join('\\n')\n\n    return (csvContent)\n  }\n\n  toJSON(data = null, format = 'dataObject') {\n    if (data === null) {\n      data = {}\n      const tableNames = this.tableNames\n      if (format === 'dataArray') {\n        for (const name of tableNames) {\n          data[name] = this.toDataArray(this.dataTables[name])\n        }\n      } else {\n        data = this.dataTables\n      }\n    } else if ((data.constructor === String) && (this.hasTable(data))) {\n      data = this.toDataArray(this.dataTables[data])\n    }\n\n    data = (format === 'dataObject') ? this.toDataObject(data) : this.toDataArray(data)\n\n    return JSON.stringify(data)\n  }\n\n  saveData() { // TODO\n    // Depends the save mode : API (Needs web) // File system (Electron/Node/Meteor) // Database (Electron/Node/Meteor)\n    /* Check if context is node-webkit (native app) */\n    if (typeof require === 'function') {\n      /* node-webkit can be used */\n      // https://github.com/nwjs/nw.js/wiki/Save-persistent-data-in-app\n      try {\n        // require('nwjs-osx-menu')(window)\n      } catch (error) {\n        debugError(error)\n      }\n    } else if (this.restURL) {\n        // $.ajax();\n    }\n  }\n\n  sendData() { // TODO\n    // Websocket (like hackathon)\n    // TTL\n    // Post or get HTTP\n  }\n\n  /* ======= Credentials ======= */\n  signInForm(formGenerator = null, message = null) {\n    const deferred = new Deferred()\n    let form = null\n    if (hasConstructor(Function, formGenerator)) {\n      form = formGenerator()\n      if (!hasConstructor(SmartForm, form)) {\n        form = null\n        debugError('DataManager.signInForm: sign in form function does not return a SmartForm')\n      }\n    }\n\n    if (form === null) {\n      // generate a basic form with userId and password\n      const fields = {\n        userId: {\n          type: 'input', // field type: input, select, textaera, slider, radio\n          constraints: 'alpha; length:10,300', // list of constraints that will be automatically verified: mandatory; alpha; numeric; length:XX; contains:a,b,@,.;\n          authorizedValues: null, // athorized values\n          parent: null,\n          title: 'Enter your UserId',\n        },\n        password: {\n          type: 'input', // field type: input, select, textaera, slider, radio\n          constraints: 'alpha; length:6,300', // list of constraints that will be automatically verified: mandatory; alpha; numeric; length:XX; contains:a,b,@,.;\n          authorizedValues: null, // athorized values\n          parent: null,\n          title: 'Enter your password:',\n        },\n      }\n      const options = { fields, title: 'Login Form', format: 'topCentralSmall' }\n      form = new SmartForm(options)\n    }\n\n    if (hasConstructor(String, message)) {\n      const html = `<div class=\"col-sm-10 bindedfield-errordiv\" >\n                      <i class=\"glyphicon glyphicon-remove\"></i><span class=\"bindedfield-error\" style=\"font-size: 15px;\">${message}</span>\n                    </div>`\n      form.prepend(html)\n    }\n\n    form.buttonText = 'OK'\n    form.promise.then((fields) => {\n      const values = {}\n      for (const field in fields) {\n        if ((fields.hasOwnProperty(field) && fields[field].value)) {\n          values[field] = fields[field].value\n        }\n      }\n      deferred.resolve(values)\n    })\n\n    return deferred\n  }\n\n  login(connection = mandatory(), variables = null, deferred = null) {\n    if ((hasConstructor(Deferred, this.loginDeferred) && this.loginDeferred.pending)) {\n      if (deferred !== this.loginDeferred) {\n        return this.loginDeferred.promise\n      }\n      deferred = this.loginDeferred\n    } else {\n      if (!hasConstructor(Deferred, deferred)) {\n        deferred = new Deferred()\n      }\n      this.loginDeferred = deferred\n    }\n\n    if (deferred.status > this.MAX_NUMBER_OF_RETRY) {\n      deferred.reject('DataManager.login: login failure - reach max retry.')\n    }\n    deferred.status += 1\n\n    if (hasConstructor(Deferred, this.isCurrentlySigningIn) && this.isCurrentlySigningIn.pending) {\n      return this.isCurrentlySigningIn.promise\n    }\n\n      // an interface needs to have a login endpoint to be used in this function\n      // ((connection.constructor === Object) && (typeof connection.variables !== 'undefined') && (typeof connection.variables.login !== 'undefined') && (connection.variables.login.constructor === String)) {\n    if ((_.has(connection, 'login')) && (connection.login.constructor === String)) {\n      if (variables === null) {\n        if (this.authorize_manual_login) {\n          const errorMessage = connection.lastErrorMessage || null\n          const formDeferred = this.signInForm(connection.signInForm, errorMessage)\n          this.isCurrentlySigningIn = formDeferred\n          return formDeferred.promise.then((credentials) => {\n            deferred.status = 0\n            return this.login(connection, credentials, deferred)// call a smartForm modal with userId and password\n          })\n        }\n        deferred.reject()\n      } else {\n        // perform ajax with the variables as credentials\n        const data = {\n          interface: connection.type,\n          credentials: variables,\n          query: connection.login,\n        }\n\n          // send the data through ajax in json format\n        $.ajax({\n          url: connection.endpoint,\n          type: 'POST',\n          data: JSON.stringify(data),\n          contentType: 'application/json',\n        })\n          .done((data, status) => {\n            // if success set credentials inside the connection\n            connection.credentials = data.credentials\n            connection.loggedIn = true\n            if (this.useLocalStorageCredentials) {\n              this.local(connection.name, { credentials: data.credentials })\n            }\n            debuglog(`DataManager.push: successful ajax call with status ${status}`, data)\n            deferred.resolve()\n          })\n          .fail(function (connection, xhr) {\n            // if failure call login with no variables to call a smartForm\n            const json = xhr.responseJSON || { message: '', tooMuchTry: false }\n            const message = json.message\n            debugError(`DataManager.push: error during login with message ${message}`)\n            connection.loggedIn = false\n            connection.lastErrorMessage = `Login error ${message}`\n            if (json.tooMuchTry) {\n              const modal = new SmartModal('centralSmall')\n              modal.title = 'Login Failure'\n              modal.content = 'Too many login failure. Wait 5min before trying to log again.'\n              deferred.reject('Too many login failure. Wait 5min before trying to log again.')\n            } else if (this.authorize_manual_login) {\n              this.login(connection, null, deferred)\n            } else {\n              deferred.reject(message)\n            }\n          }.bind(this, connection))\n      }\n    } else {\n      deferred.reject(`DataManager.login: no valid login enpoint for the connection ${connection.name}`)\n    }\n\n\n    return deferred.promise\n  }\n\n  /* ======= Checkpoints ======= */\n  query(query = mandatory(), variables = {}, connection = null, deferred = new Deferred()) {\n    if (deferred.status > this.MAX_NUMBER_OF_RETRY) {\n      deferred.reject('DataManager.query: query failure - reach max retry.', query)\n    } else {\n      deferred.status += 1\n\n      if (connection === null) {\n        if (this.connections.length > 0) {\n          connection = this.connections[0]\n        } else {\n          deferred.reject('DataManager.query: no valid connection available.')\n        }\n      }\n\n      if (connection.type === this.INTERFACE_REST) {\n        // build the data object to send\n        const data = {\n          interface: connection.type,\n          credentials: connection.credentials,\n          query,\n          variables,\n        }\n\n        // send the data through ajax in json format\n        $.ajax({\n          url: connection.endpoint,\n          type: 'POST',\n          data: JSON.stringify(data),\n          contentType: 'application/json',\n        })\n        .done((data, status) => {\n          // once the ajax call is done, check status of http\n          debuglog(`DataManager.push: successful ajax call with status ${status}`, data)\n          deferred.resolve(data)\n        })\n        .fail((xhr) => {\n          const json = xhr.responseJSON || { message: '', shouldLog: false }\n          if (json.shouldLog) {\n            debugError('DataManager.push: user is not logged in -- will call the log function.')\n            this.login(connection).then(() => { this.query(query, variables, connection, deferred) })\n          } else {\n            debugError('DataManager.push: could not perform query -- will retry', JSON.stringify(query), json.message)\n            this.query(query, variables, connection, deferred)\n          }\n        })\n      } else {\n        deferred.reject('DataManager.query: unsupported connection.')\n      }\n    }\n\n\n    return deferred.promise\n  }\n\n  /* ======= Push ======= */\n\n  /**\n   * Sets or retrieve a variable from local storage in a JSON format\n   * @method local\n   * @param  {string} [variable=null]        variable name, if not specified returns the whole localStorage object\n   * @param  {any} [data=null]               if specified, the variable will be set and not retrieved\n   * @return {!any}                          undefined if set, variable value if get\n   */\n  local(variable = null, data = null) {\n    if (variable === null) {\n      return localStorage\n    }\n\n    if (data !== null) {\n      localStorage[variable] = JSON.stringify(data)\n      return undefined\n    }\n    if (!localStorage.hasOwnProperty(variable)) {\n      debugError(`DataManager.local: localStorage has no variable named ${variable}`)\n      return undefined\n    }\n\n    try {\n      const data = JSON.parse(localStorage[variable])\n      return data\n    } catch (e) {\n      debugError('DataManager.local: variable is probably not JSON ', e)\n    }\n    return localStorage[variable]\n  }\n\n  prepareToPush(...names) {\n    if (names === []) {\n      names = new Set(Object.keys(this.dataTables))\n    }\n\n    this.toPush.unite(names)\n    if (!this.waitForPush) {\n      this.waitForPush = true\n      delay(this.addRate).then(() => {\n        this.push()\n      })\n    }\n    if ((!hasConstructor(Deferred, this.pushDeferred)) || (!this.pushDeferred.pending)) {\n      this.pushDeferred = new Deferred()\n    }\n\n    return this.pushDeferred\n  }\n\n  getStagedData(table = mandatory(), format = 'dataArray') {\n    // check that the table is valid\n    let returned = [[], 0]\n    try {\n      if (!this.tableNames.has(table)) {\n        throw new Error('DataManager.getStagedData: unknown table.')\n      }\n\n      // check if we have a last index, if not set it to 0\n      if (Object.keys(this.tablesLastIndex).indexOf(table) === -1) {\n        this.tablesLastIndex[table] = 0\n      }\n\n      const dataTable = this.dataTables[table]\n      const fields = this.fieldNames(table)\n      const numRows = dataTable[fields.sample()].length\n      const lastIndex = this.tablesLastIndex[table]\n\n      // create a new array with the unpushed data (without cloning the parent array)\n      const data = format === 'dataArray' ? [] : {}\n      let j = 0\n      for (let i = lastIndex; i < numRows; i++) {\n        if (format === 'dataArray') {\n          const row = {}\n          for (const field of fields) {\n            if (field === 'id') continue\n\n            if (dataTable[field].length <= i) {\n              throw new Error(`DataManager.toDataArray: field array ${field} is of invalid size.`)\n            }\n            row[field] = dataTable[field][i]\n          }\n\n          data.push(row)\n        } else {\n          for (const field of fields) {\n            if (field === 'id') continue\n\n            if (!data.hasOwnProperty(field)) {\n              data[field] = []\n            }\n            if (dataTable[field].length <= i) {\n              throw new Error(`DataManager.getStagedData: field ${field} of invalid size in the DataManager.`)\n            }\n            data[field][j].push(dataTable[field][i])\n          }\n          j += 1\n        }\n      }\n      returned = [data, numRows]\n    } catch (e) {\n      debugError(e)\n    }\n    return returned\n  }\n\n  push() {\n    if ((hasConstructor(Deferred, this.loginDeferred) && this.loginDeferred.pending)) {\n      delay(this.addRate).then(() => {\n        this.push()\n      })\n    } else {\n      this.waitForPush = 0\n      for (let i = 0; i < this.connections.length; i++) {\n        const connection = this.connections[i]\n        if (connection.type === this.INTERFACE_REST) {\n          const toPushSize = this.toPush.size\n          let pushed = 0\n          const pushDeferred = this.pushDeferred\n          const checkIfPushed = function () {\n            if (pushed >= toPushSize) {\n              pushDeferred.resolve()\n            }\n          }\n          for (const table of this.toPush) {\n            // get last index pushed to the server\n            // get the new data from that index\n            if ((this.useLocalStorageCredentials) && (typeof this.local(connection.name) !== 'undefined') && (this.local(connection.name).hasOwnProperty('credentials'))) {\n              connection.credentials = this.local(connection.name).credentials\n            }\n\n            const [rows, lastIndex] = this.getStagedData(table)\n            const data = {\n              interface: connection.type,\n              credentials: connection.credentials,\n              query: connection.add,\n              variables: {\n                table,\n                rows,\n              },\n            }\n\n            // send the data through ajax in json format\n            $.ajax({\n              url: connection.endpoint,\n              type: 'POST',\n              data: JSON.stringify(data),\n              contentType: 'application/json',\n            })\n            .done(function (table, lastIndex, data, status) {\n              // once the ajax call is done, check status of http\n              // if 200 this.waitForPush = false and update the last updated index\n              // bind a context with the name of the table\n              pushed += 1\n              checkIfPushed()\n              this.tablesLastIndex[table] = lastIndex\n              this.toPush.delete(table)\n              debuglog(`DataManager.push: successful ajax call with status ${status}`, data)\n            }.bind(this, table, lastIndex))\n            .fail(function (connection, table, xhr) {\n              const json = xhr.responseJSON || { message: '', shouldLog: false }\n              if (json.shouldLog) {\n                debugError('DataManager.push: user is not logged in -- will call the log function.')\n                // will pop a form to log\n                this.login(connection).then(() => { this.prepareToPush(table) })\n              } else {\n                debugError(`DataManager.push: could not push ${table} -- will retry`, json.message)\n                this.prepareToPush(table)\n              }\n            }.bind(this, connection, table))\n          }\n        }\n\n        if (connection.type === this.INTERFACE_GRAPHQL) {\n          //\n        }\n      }\n    }\n  }\n\n  setConnection(variables = mandatory()) {\n    const deferred = new Deferred()\n    if ((!variables.hasOwnProperty('type')) || (variables.type === this.INTERFACE_REST)) {\n      const defaultVariables = {\n        type: this.INTERFACE_REST,\n        name: null,\n        endpoint: null,\n        credentials: null,\n        loggedIn: false,\n        add: this.QUERY_ADD,\n        checkpoint: this.QUERY_CHECKPOINT,\n        login: this.QUERY_LOGIN,\n        // TODO rest of basic api\n      }\n\n      const connection = _.extend(defaultVariables, variables)\n      if (connection.endpoint !== null) {\n        connection.name = connection.name || connection.type\n\n        if ((connection.credentials === null) && (this.useLocalStorageCredentials && (typeof this.local(connection.name) !== 'undefined') && (this.local(connection.name).hasOwnProperty('credentials')))) {\n          connection.credentials = this.local(connection.name).credentials\n        }\n\n        if (connection.credentials !== null) {\n          this.login(connection, connection.credentials)\n          .then(() => {\n            this.connections.push(connection)\n            deferred.resolve(connection)\n          })\n          .catch((e) => {\n            deferred.reject(e)\n          })\n        } else {\n          this.connections.push(connection)\n          deferred.resolve(connection)\n        }\n      } else {\n        deferred.reject('DataManager.setInterface: needs at least an endpoint.')\n      }\n    } else {\n      deferred.reject('DataManager.setInterface: unsupported connection type.')\n    }\n    return deferred.promise\n  }\n\n  /* ======== Getters and setters ======== */\n\n\n  /**\n   * tableNames - readonly - Set of table names.\n   *\n   * @returns {Set}\n   */\n  get tableNames() {\n    return (new Set(Object.keys(this.dataTables)))\n  }\n\n  set tableNames(value) {\n    throw new Error('DataManager.tableNames: readonly.')\n  }\n\n  /**\n   * globalLog - The complete log since the creation of the DataManager\n   *\n   * @returns {Object}\n   */\n  get globalLog() {\n    return (this._globalLog)\n  }\n\n  set globalLog(value) {\n    throw new Error('DataManager.tableNames: readonly.')\n  }\n\n  /** Integer value of the next id for the global log */\n  get nextLogId() {\n    if (this.globalLog.id.length > 0) {\n      return (_.max(this.globalLog.id) + 1)\n    }\n    return (0)\n  }\n\n\n  set nextLogId(value) {\n    if (value.constructor === String) {\n      this._customNextID = value // TODO to implement\n      console.log(`DataManager: next event 'id' will be ${value}`)\n    } else {\n      throw new Error('DataManager: id should be a string.')\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/framework/DataManager.js","/** @module RessourceManager */\nimport $ from 'jquery'\nimport Promise from 'bluebird'\n\nimport { mandatory, debugError, Deferred } from './utilities'\n\n//eslint-disable-next-line\nconst yaml = require('js-yaml') // TODO try to find another way... this is too heavy\n// const toml = require('toml') // smaller ~100ko unimified\n\n\n/* JS Class for ressource management */\nexport default class RessourceManager {\n  /**\n   * RessourceManager - class which allows to load text file in different allowed\n   * format, convert it to javascript objects accessible by proxy allowing for\n   * easy localization and debuging.\n   * TODO Allow for array as multiline strings\n   * TODO Add layout/html loading to RessourceManager\n   * TODO Add the image preloader\n   * TODO make en/fr/ge etc. keywords able to classify not only strings like so R.get.wolfFmriFirstAppear_(en_)title\n   * @constructor\n   * @param {...string} filepaths iterable of strings of file paths to load\n   *\n   * @return {RessourceManager}\n   */\n  constructor(...filepaths) {\n    /* --- Set language --- */\n    this.defaultLanguage = 'en'\n    this.currentLanguage = this.defaultLanguage\n\n    /* --- Initialize data --- */\n    this.data = {}\n\n    /* --- Custom parameters --- */\n\n    /**\n     * overwrite - determines default behavior when adding an already existing\n     * variables\n     *\n     * @type {Boolean}\n     */\n    this.overwrite = true\n\n    /**\n     * useAjax - If set to false, files will not be loaded and data can only be added in code\n     * using addDataFamilly, or by directly modifying this.data object.\n     * Useful to make sure local app do not try to use ajax without a server.\n     *\n     * @type {Boolean}\n     */\n    this.useAjax = true\n\n\n    /* --- Register sprecified file paths --- */\n    this.addFiles(filepaths)\n  }\n\n  /* === File management === */\n\n  /**\n   * addFiles - Add all the files listed, then calls for each the load functions\n   * and store it in a promise array.\n   * Returns a Promise.all() that is resolves when all files are loaded, parsed\n   * and stored.\n   *\n   * @param {...string} filepaths iterable of file paths\n   *\n   * @returns {Promise} Promise that will resolve when all files are loaded and\n   *                    processed\n   */\n  addFiles(...filepaths) {\n    if (this.useAjax === false) {\n      throw new Error(\"RessourceManager.addFiles: useAjax set to false - can't add files over the network\")\n    }\n\n    const concatFilepaths = [].concat(...filepaths)\n\n    this.files = []\n    const promises = []\n    for (let i = 0; i < concatFilepaths.length; i++) {\n      if (this.isOfValidFormat(concatFilepaths[i])) {\n        this.files[i] = {}\n        this.files[i].type = this.getFormat(concatFilepaths[i])\n        this.files[i].path = concatFilepaths[i]\n        this.files[i].loaded = false // once the raw string is uncovered\n        this.files[i].validated = false // once data is parse from the raw string\n        this.files[i].added = false // once the parsed data is organized in this.data\n        this.files[i].raw = false\n        this.files[i].data = null\n        promises.push(this.loadFile(i))\n      } else {\n        console.warn(`RessourceManager.addFiles: invalid type for ${concatFilepaths[i]}`)\n      }\n    }\n\n    return Promise.all(promises)\n  }\n\n\n  /**\n   * loadFile - Performs an jQuery ajax call to get the file at specified index\n   * in this.files[fileIndex]. Then call this.parseRaw() on the result.\n   * Returns a promise.\n   *\n   * @param {number} fileIndex Index in the files array\n   *\n   * @returns {Promise} Will resolve when file processed\n   */\n  loadFile(fileIndex = mandatory()) {\n    const deffered = new Deferred()\n\n    if (typeof this.files[fileIndex] === 'undefined') {\n      return deffered.reject('RessourceManager.loadFile: files[fileIndex] is not defined')\n    }\n\n    const thisObject = this\n    $.ajax({\n      type: 'GET',\n      url: this.files[fileIndex].path,\n      crossDomain: true,\n    }).done((data, textStatus, jqXHR) => { //eslint-disable-line\n      thisObject.files[fileIndex].loaded = true\n      thisObject.files[fileIndex].raw = data\n\n      try {\n        thisObject.parseRaw(fileIndex)\n      } catch (e) {\n        deffered.reject(e)\n      } finally {\n        deffered.resolve(`RessourceManager.loadFile: ${thisObject.files[fileIndex].path} parsed`)\n      }\n    })\n\n    return deffered.promise\n  }\n\n  parseRaw(fileIndex = mandatory()) {\n    if (typeof this.files[fileIndex] === 'undefined') {\n      throw new Error('RessourceManager.parseRaw: files[fileIndex] is not defined')\n    }\n\n    const file = this.files[fileIndex]\n\n    if (file.raw === null) {\n      throw new Error('RessourceManager.parseRaw: file.raw is null or not validated')\n    } else if (file.raw.constructor === String) {\n      let parser\n      let arg = null\n      switch (file.type) {\n        case 'json':\n        // read json\n          parser = JSON.parse\n          break\n        case 'csv':\n        // read csv\n          parser = $.csv.toObjects\n          break\n        case 'xml':\n        // read xml\n          if (window.DOMParser) {\n            parser = new DOMParser()\n            parser = parser.parseFromString\n            arg = 'text/xml'\n          } else {\n            // Internet Explorer\n            parser = new window.ActiveXObject('Microsoft.XMLDOM')\n            parser.async = false\n            parser = parser.loadXML\n          }\n          break\n        // case 'toml':\n        //   parser = toml.parse\n        //   break\n        case 'yaml':\n          parser = yaml.safeLoad\n          break\n        default:\n          throw new Error('RessourceManager.parseRaw: file.type is null or not validated')\n      }\n\n      try {\n        if (arg) {\n          file.data = parser(file.raw, arg)\n        } else {\n          file.data = parser(file.raw)\n        }\n      } catch (e) {\n        file.validated = false\n        file.data = null\n        throw new Error(e)\n      } finally {\n        // file has been correctly parsed and stored in object format\n        file.validated = true\n\n        // when a file is parsed, merge the new data\n        this.processParsed()\n      }\n    } else if (file.raw.constructor === Object) {\n      file.data = file.raw\n      // file has been correctly parsed and stored in object format\n      file.validated = true\n\n      // when a file is parsed, merge the new data\n      this.processParsed()\n    } else {\n      throw new Error('RessourceManager.parseRaw: invalid file.raw format')\n    }\n  }\n\n  processParsed() {\n    // first level are data famillies e.g strings, constants, ids, flags etc...\n    for (let i = 0; i < this.files.length; i++) {\n      if ((this.files[i].validated !== false) && (this.files[i].data) && (!this.files[i].added)) {\n        const data = this.files[i].data\n        const keys = Object.keys(data)\n        for (let j = 0; j < keys.length; j++) {\n          this.addDataFamilly(keys[j], data[keys[j]])\n        }\n\n        this.files[i].added = true\n      }\n    }\n  }\n\n\n  /**\n   * addDataFamilly - adds the familly if does not exist to the data set, then\n   * extend it with the data.\n   *\n   * @param {String}  familly          Familly name\n   * @param {Object}  data             Each property of this object is a variable\n   *                                   name\n   * @param {Boolean} [overwrite=null] If overwrite is set to true, new values\n   *                                   overwrites old one, if false only new\n   *                                   variables are kept.\n   *\n   * @returns {undefined}\n   */\n  addDataFamilly(familly = mandatory(), data = mandatory(), overwrite = null) {\n    let toAdd = data\n    let id\n    if (data.constructor !== Object) { // If the data is not an object: organize by type\n      id = familly\n      familly = `${data.constructor.name.toLowerCase()}s`\n      toAdd = {\n        [id]: data,\n      }\n    }\n\n    if (typeof this.data[familly] === 'undefined') {\n      this.data[familly] = {}\n    }\n\n    if (overwrite === null) {\n      overwrite = this.overwrite\n    }\n\n    if (overwrite) {\n      this.data[familly] = this.extend(this.data[familly], toAdd)\n    } else {\n      this.data[familly] = this.extend(toAdd, this.data[familly])\n    }\n  }\n\n\n  /**\n   * getNextId - Returns the lenght of the specified familly\n   *\n   * @param {string} familly\n   *\n   * @returns {number} 0 if the familly does not exist, the total number of keys otherwise.\n   */\n  getNextId(familly = mandatory()) {\n    if (this.data.hasOwnProperty(familly)) {\n      return Object.keys(this.data[familly]).length\n    }\n    return 0\n  }\n\n\n  /**\n   * add - Parse and add the object to the data.\n   *\n   * @param {Object}  object  Object with either variables at the root\n   * e.g {variable: \"example\"} or with familly name at the root e.g\n   * {familly : { variable: \"example\"}}\n   * @param {Boolean} [overwrite=null]  If overwrite is set to true,\n   * new values overwrites old one, if false only new variables are kept.\n   *\n   * @returns {undefined}\n   */\n  add(object = mandatory(), overwrite = null) {\n    if (object.constructor !== Object) {\n      throw new Error('RessourceManager.add: cannot add data from a non object')\n    }\n    const oldOverwrite = this.overwrite\n    if (overwrite === null) {\n      overwrite = oldOverwrite\n    } else {\n      this.overwrite = overwrite\n    }\n\n    const keys = Object.keys(object)\n    for (let i = 0; i < keys.length; i++) {\n      if (object[keys[i]].constructor === Object) {\n        this.addDataFamilly(keys[i], object[keys[i]])\n      } else if (object[keys[i]].constructor === Array) {\n        this.addByName(keys[i], object[keys[i]], 'arrays')\n      } else {\n        this.addByName(keys[i], object[keys[i]])\n      }\n    }\n\n    this.overwrite = oldOverwrite\n  }\n\n\n  /**\n   * addByName - Add a single variable to the data with specified name and value,\n   * in the specified familly. If no familly is specified, using strings.\n   *\n   * @param {string} name              Variable name\n   * @param {object} value             Variable value\n   * @param {string} [familly=strings] Familly name\n   * @param {null}   [overwrite=null]  If overwrite is set to true,new values\n   *                                   overwrites old one, if false only new\n   *                                   variables are kept.\n   *\n   * @returns {undefined}\n   */\n  addByName(name = mandatory(), value = mandatory(), familly = 'strings', overwrite = null) {\n    if (typeof this.data[familly] === 'undefined') {\n      this.data[familly] = {}\n    }\n\n    if (overwrite === null) {\n      overwrite = this.overwrite\n    }\n\n    if (!(this.data[familly].hasOwnProperty(name)) || overwrite) {\n      console.warn(`RessourceManager.addByName: already a ressource named ${name} - Overwriting it.`)\n      this.data[familly][name] = value\n    }\n  }\n\n  /**\n   * getFormat - Returns the extension of the file in filepath or an empty string\n   * if no etension is found\n   *\n   * @param {string} filepath\n   *\n   * @returns {string}\n   */\n  getFormat(filepath = mandatory()) {\n    // fancy way of making sure we substr(index) with\n    // index >>> filepath.lenght if no . is found\n    // from http://stackoverflow.com/questions/190852/how-can-i-get-file-extensions-with-javascript/1203361#1203361\n    return filepath.substr((~-filepath.lastIndexOf('.') >>> 0) + 2) // eslint-disable-line\n  }\n\n  isOfValidFormat(filepath = mandatory()) {\n    const validFormats = ['json', 'csv', 'xml', 'yaml']\n    if (validFormats.indexOf(this.getFormat(filepath)) !== -1) {\n      return true\n    }\n    return false\n  }\n\n  /**\n   * mergeWith - Merge current data with another RessourceManager. Duplicated\n   * keys gets overwritten by those of the other RessourceManager.\n   *\n   * @param {RessourceManager} ressourceManager Another RessourceManager to merge\n   *\n   */\n  mergeWith(ressourceManager = mandatory()) {\n    if (ressourceManager.constructor !== RessourceManager) {\n      throw new Error('RessourceManager.mergeWith: specified ressourceManager is not of class RessourceManager.')\n    }\n\n    const currentFamillies = this.famillies\n    const mergingFamillies = ressourceManager.famillies\n\n    for (let i = 0; i < mergingFamillies.length; i++) {\n      if (currentFamillies.indexOf(mergingFamillies[i]) === -1) {\n        this.data[mergingFamillies[i]] = ressourceManager.data[mergingFamillies[i]]\n      } else {\n        this.data[mergingFamillies[i]] = this.extend(this.data[mergingFamillies[i]], ressourceManager.data[mergingFamillies[i]])\n      }\n    }\n  }\n\n\n  /**\n   * lookFor - Looks for a variable name in all the famillies\n   *\n   * @param {string} variable variable to look for\n   *\n   * @returns {?object} data[familly][variable] if found, or undefined\n   */\n  lookFor(...variable) {\n    let result\n    if (variable.length === 1) {\n      if (this.data.hasOwnProperty(variable)) {\n        result = this.data[variable]\n      } else {\n        const famillies = this.famillies\n        for (let i = 0; i < famillies.length; i++) {\n          if (this.data[famillies[i]].hasOwnProperty(variable)) {\n            result = this.data[famillies[i]][variable]\n            break\n          }\n        }\n      }\n    } else if (variable.length > 1) {\n      result = {}\n      for (let i = 0; i < variable.length; i++) {\n        result[variable[i]] = this.lookFor(variable[i])\n      }\n    }\n\n    return result\n  }\n\n\n  /**\n   * Pass in the objects to merge as arguments.\n   * For a deep extend, set the first argument to `true`.\n   * Adapted from JQuery haters :\n   * https://gomakethings.com/vanilla-javascript-version-of-jquery-extend/\n   *\n   * @param {array} args list of objects to extend. If first arguemnt is true, a deep\n   * copy is performed.\n   *\n   * @returns {type} Description\n   */\n  extend(...args) {\n    // Variables\n    const extended = {}\n    let deep = false\n    let i = 0\n    const length = args.length\n\n    // Check if a deep merge\n    if (Object.prototype.toString.call(args[0]) === '[object Boolean]') {\n      deep = args[0]\n      i += 1\n    }\n\n    // Merge the object into the extended object\n    const merge = function (obj) {\n      for (const prop in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, prop)) {\n          // If deep merge and property is an object, merge properties\n          if (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n            extended[prop] = this.extend(true, extended[prop], obj[prop])\n          } else {\n            extended[prop] = obj[prop]\n          }\n        }\n      }\n    }\n\n    // Loop through each object and conduct a merge\n    for (; i < length; i++) {\n      const obj = args[i]\n      merge(obj)\n    }\n\n    return extended\n  }\n\n\n  /**\n   * famillies - Description\n   *\n   * @returns {type} Description\n   */\n  get famillies() {\n    return Object.keys(this.data)\n  }\n\n  get has() {\n    return new Proxy(this, {\n      get(target, pathString) {\n        if (typeof target.get[pathString] === 'undefined') {\n          return false\n        }\n        return true\n      },\n    })\n  }\n\n  get get() {\n    return new Proxy(this, {\n      get(target, pathString) {\n        const path = pathString.split('_')\n        const famillies = target.famillies\n        let lookForLanguage = target.currentLanguage\n        let lookForFamilly = 'strings'\n        let lookForVariable\n        let couldSwapForVariable = false\n        for (let i = 0; i < path.length; i++) {\n          if (famillies.indexOf(path[i]) !== -1) {\n            lookForFamilly = path[i]\n            couldSwapForVariable = true\n          } else if (path[i].length === 2) {\n            lookForLanguage = path[i]\n          } else {\n            if (typeof lookForVariable !== 'undefined') {\n              console.error(`RessourceManager.get: at least two possible variable names into path: ${lookForVariable} and ${path[i]}`)\n              return undefined\n            }\n            lookForVariable = path[i]\n          }\n        }\n\n        if (typeof lookForVariable === 'undefined') {\n          if (couldSwapForVariable) {\n            lookForVariable = lookForFamilly\n          } else {\n            debugError(`RessourceManager.get: no variable name found in ${pathString}`)\n            return undefined\n          }\n        }\n\n        let result\n        if ((target.data.hasOwnProperty(lookForFamilly)) && (target.data[lookForFamilly].hasOwnProperty(lookForVariable))) {\n          result = target.data[lookForFamilly][lookForVariable]\n        } else {\n          result = target.lookFor(lookForVariable)\n          if (typeof result === 'undefined') {\n            console.error(`RessourceManager.get: no ressource for path ${lookForFamilly}.${lookForVariable}`)\n            return undefined\n          }\n        }\n\n        if (result.constructor !== Object) {\n          return result\n        } else if (result.hasOwnProperty(lookForLanguage)) {\n          return result[lookForLanguage]\n        } else if (result.hasOwnProperty(target.currentLanguage)) {\n          console.warn(`RessourceManager.get: no valid language, defaulting to ${target.currentLanguage}`)\n          return result[target.currentLanguage]\n        }\n        console.warn('RessourceManager.get: no localization language found, returning the whole object')\n        return result\n      },\n\n    })\n  }\n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/framework/RessourceManager.js","\n/** @module State */\nimport _ from 'lodash'\nimport Promise from 'bluebird'\nimport EventData from './EventData'\nimport { mandatory, debuglog, debugWarn, debugError, mustBeDefined, mustHaveConstructor, delay, Deferred } from './utilities'\n\n/* State object has a specific way to handle input and update objects */\nexport default class State {\n\n\n  /**\n   * @constructor\n   * @param {object} [stateManager]\n   * @param {string} [stateKey]\n   */\n  constructor(stateManager = mandatory(), stateKey = mandatory()) {\n    this._stateManager = stateManager\n    this._parent = stateManager._parent\n    this._dataManager = stateManager._dataManager\n\n    this.stateKey = stateKey\n\n    /**\n     * Object in which properties names are handling function to be called for specific events.\n     * The key of those properties are the event flags. Handling functions should return a Promise.\n     * @type {Object}\n     */\n    this._eventFunctions = {}\n\n    /**\n     * Object containing array of function to be called once for specific events\n     * The key of those properties are the event flags. Handling functions should return a Promise.\n     * @type {Object}\n     */\n    this._nextEventFunctions = {}\n\n    /**\n     * Array of handling function to be called when the state awaken, just after state change.\n     * This is where redrawing should go. Handling functions should return a Promise.\n     * @type {Array}\n     * @private\n     */\n    this._awakeningFunctions = []\n\n    /**\n     * Array of handling functions to be called when the state is dismissed, just before the state change.\n     * Handling functions should return a Promise.\n     * @type {Array}\n     * @private\n     */\n    this._endingFunctions = []\n\n    /**\n     * Array of functions that are to be called upon each updates.\n     * Those functions should return a Promise.\n     * @type {Array}\n     */\n    this._updateFunctions = []\n\n    /**\n     * Array of stored timed event in case of state freezing\n     * @type {Array}\n     */\n    this._frozenEvents = []\n\n    /**\n     * Timestamp of frozen time. Value is null if the state is not frozen.\n     * @type {int}\n     */\n    this._frozenAt = null\n\n    /**\n     * Constant. When unfreezing if the time difference etween happenedAt and the current timeInMs is less than\n     * this value, the event is directly added to the event heap. Else it is treated as a tigger event.\n     * @type {Number}\n     */\n    this.FREEZE_DELAY = 50\n  }\n\n  /* ======== Class Methods ======== */\n\n  /* === Lifecycle hook functions === */\n\n  /**\n   * Function called at state awakening.\n   * All functions of the _awakeningFunctions array will be called, they must return a Promise.\n   */\n  awake(reload = false) {\n    if (reload) {\n      if (this._frozenAt !== null) {\n        this._frozenAt = null\n        this._frozenEvents = []\n        this.stateManager.stateWasUnfreezed(this.stateKey)\n      }\n      // NOTE Might have other things to do here...\n    }\n\n    /* --- If state was frozen unfreeze it but do not re-awake --- */\n    if (this._frozenAt !== null) {\n      this.unfreeze()\n    } else {\n      if (typeof this._parent.sceneKey !== 'undefined') { debuglog(`${this.stateKey} of scene ${this._parent.sceneKey} awaken.`) }\n\n      const calledFunctions = []\n      for (let i = 0; i < this._awakeningFunctions.length; i++) {\n        calledFunctions[i] = Promise.method(this._awakeningFunctions[i].bind(this.context))()\n      }\n\n      Promise.all(calledFunctions).then(() => {\n        /* Promise ran as expected, returned data */\n        debuglog('State: Awakening functions completed as expected.', calledFunctions)\n      }).catch((error) => {\n        /* an error occured */\n        debugError(error)\n      })\n    }\n  }\n\n  /**\n   * Function called when state ends, just before state change.\n   * All functions of the _endingFunctions array will be called, they must return a Promise.\n   */\n  end() {\n    if (this._frozenAt === null) {\n      const calledFunctions = []\n      for (let i = 0; i < this._endingFunctions.length; i++) {\n        calledFunctions[i] = Promise.method(this._endingFunctions[i].bind(this.context))()\n      }\n\n      Promise.all(calledFunctions).then((data) => {\n      /* Promise ran as expected, returned data */\n        debuglog('State: Ending functions completed as expected.', calledFunctions)\n        debuglog(`${this.stateKey} ended.`)\n        return data\n      }).catch((error) => {\n      /* an error occured */\n        debugError(error)\n        return null\n      })\n    }\n  }\n\n  update() {\n    if ((this._frozenAt === null) && (this._stateManager._eventHeap.length)) {\n      let nextEvent\n      const events = this._stateManager.spliceEventsForState(this.stateKey)\n      for (let i = 0; i < events.length; i++) {\n        nextEvent = events[i]\n        debuglog(`State: first event is ${nextEvent.flag}`)\n\n        this.handleEvent(nextEvent)\n      }\n      // while (events.length) {\n      //   nextEvent = his._stateManager.getFirstEventAndRemoveFromHeap(this.stateKey)\n      //   if (typeof nextEvent === 'undefined') {\n      //     debuglog('State.update: first event is undefined. Probably bc not meant for this state.') // TODO not good do better\n      //     break\n      //   }\n      // }\n\n      // if (typeof this._updateFunctions !== 'undefined') {\n      //\n    }\n\n    // debuglog(this.stateKey + \" updated.\");\n  }\n\n  /* === Event based functions === */\n\n  handleEvent(event) {\n    // for each input flag have a specific function ready - that can be customizable\n    // rename input with Event ?\n    // make a promise and chain it with .then(stateHasFinishedHandlingEvent())\n    let handled = false\n    if (this.hasEventFunction(event.flag)) {\n      /* Promise allow for assynchronous handling of events */\n      const eventFunctions = this._eventFunctions[event.flag]\n      if (eventFunctions.constructor === Array) {\n        for (let i = 0; i < eventFunctions.length; i++) {\n          Promise.method(eventFunctions[i].bind(this.context))(event)\n            .then(function (functionName, data) {\n              /* Promise ran as expected, returned data */\n              debuglog(data)\n              const eventClone = _.cloneDeep(event)\n              eventClone.data.handlingFunction = functionName\n              this._stateManager.stateHasFinishedHandlingEvent(eventClone)\n            }.bind(this, eventFunctions[i].name))\n            .catch((error) => {\n              /* an error occured */\n              debugError(error)\n            })\n        }\n      } else {\n        Promise.method(eventFunctions.bind(this.context))()\n          .then(function (functionName, data) {\n            /* Promise ran as expected, returned data */\n            debuglog(data)\n            const eventClone = _.cloneDeep(event)\n            eventClone.data.handlingFunction = functionName\n            this._stateManager.stateHasFinishedHandlingEvent(eventClone)\n          }.bind(this, eventFunctions.name))\n          .catch((error) => {\n            /* an error occured */\n            debugError(error)\n          })\n      }\n      handled = true\n    }\n    if (this._nextEventFunctions.hasOwnProperty(event.flag)) {\n      let eventFunctions = this._nextEventFunctions[event.flag]\n      if (eventFunctions !== null) {\n        if (eventFunctions.constructor === Function) { eventFunctions = [eventFunctions] }\n        for (const eventFunction of eventFunctions) {\n          Promise.method(eventFunction)(event)\n            .then(function (functionName, data) {\n              /* Promise ran as expected, returned data */\n              debuglog(data)\n              const eventClone = _.cloneDeep(event)\n              eventClone.data.handlingFunction = functionName\n              this._stateManager.stateHasFinishedHandlingEvent(eventClone)\n            }.bind(this, eventFunction.name))\n            .catch((error) => {\n              /* an error occured */\n              debugError(error)\n            })\n        }\n        this._nextEventFunctions[event.flag].length = 0\n        handled = true\n      }\n    }\n\n    if (!handled) {\n      this._stateManager.stateHasFinishedHandlingEvent(event)\n      debuglog(`State: Event '${event.flag}' not handled by state '${this.stateKey}'`)\n    }\n  }\n\n  onNext(eventFlag, ...handlingFunctions) {\n    try {\n      mustBeDefined(eventFlag, ...handlingFunctions)\n      mustHaveConstructor(Function, ...handlingFunctions)\n\n      // checks if functions should be stacked in an array for this flag\n      if (this._nextEventFunctions.hasOwnProperty(eventFlag)) {\n        if (this._nextEventFunctions[eventFlag].constructor === Array) {\n          // push the handlingFunction to the array of _eventFunctions[eventFlag]\n          this._nextEventFunctions[eventFlag] = this._nextEventFunctions[eventFlag].concat(handlingFunctions)\n          debuglog(`State ${this.stateKey}.onNext: several handling functions - handling function pushed to the array of event functions on event '${eventFlag}'`)\n        } else {\n          // creates array of event function\n          this._nextEventFunctions[eventFlag] = [this._nextEventFunctions[eventFlag]].concat(handlingFunctions)\n          debuglog(`State ${this.stateKey}.onNext: several handling functions - array created for handling functions for state on event '${eventFlag}'`)\n        }\n      } else {\n        this._nextEventFunctions[eventFlag] = handlingFunctions\n        debuglog(`State ${this.stateKey}.onNext: handling function added to state '${this.stateKey}' for event '${eventFlag}'`)\n      }\n    } catch (e) {\n      debugError(e)\n    }\n  }\n\n  resolveOnKey(options = { key: null, except: [32], eventFlag: 'key_down' }) {\n    const baseOptions = { key: null, except: [32], eventFlag: 'key_down' }\n\n    if (options.constructor !== Object) {\n      if (options.constructor === Number) {\n        baseOptions.key = options\n        options = {}\n      } else {\n        debugError('State.resolveOnKey: invalid options')\n        return null\n      }\n    }\n\n    let { key, except, eventFlag } = _.extend(baseOptions, options) //eslint-disable-line\n    if ((key !== null) && (key.constructor !== Array)) {\n      if (key.constructor === Number) {\n        key = [key]\n      } else {\n        debugError('State.resolveOnKey: key must be numeric')\n        return null\n      }\n    }\n\n    if ((typeof except === 'undefined') || (except === null)) {\n      except = []\n    }\n\n    if (except.constructor !== Array) {\n      if (except.constructor === Number) {\n        except = [except]\n      } else {\n        debugError('State.resolveOnKey: except must be numeric')\n        return null\n      }\n    }\n\n\n    const deferred = new Deferred()\n    const f = (e) => {\n      if ((key === null && except.indexOf(e.data.keyCode) === -1) || (key !== null && key.indexOf(e.data.keyCode) !== -1)) {\n        deferred.resolve(e)\n        return `State ${this.stateKey}.resolveOnKey: tested on '${key}' and resolved because key '${e.data.keyCode}' pressed`\n      } else if (!deferred.resolved) {\n        delay(5).then(() => { this.onNext(eventFlag, f) })\n        return `State ${this.stateKey}.resolveOnKey: tested on '${key}' and did not resolved because wrong key '${e.data.keyCode}' pressed`\n      }\n      return `State ${this.stateKey}.resolveOnKey: should not stay in the function stack`\n    }\n    this.onNext(eventFlag, f)\n\n    return deferred.promise\n  }\n\n  resolveOnClick(eventFlag = 'mouse_click') {\n    const deferred = new Deferred()\n    const f = (e) => {\n      deferred.resolve(e)\n      return `State ${this.stateKey}.resolveOnClick: resolved`\n    }\n    this.onNext(eventFlag, f)\n\n    return deferred.promise\n  }\n\n  freeze() {\n    const stateManager = this._stateManager\n\n    this._frozenAt = stateManager.timeInMs\n    this._frozenEvents = stateManager.getAllEvents()\n    debugWarn(this._frozenEvents)\n    stateManager.stateWasFrozen(this.stateKey) // TODO: make sure only one state can be frozen ? or add multiple frozen thingy\n    // TODO make functions onFrozen?\n  }\n\n  unfreeze() {\n    if (this._frozenAt === null) {\n      debugWarn('State.unfreeze: state was not frozen')\n      return\n    }\n\n    const stateManager = this._stateManager\n    const frozenEvents = this._frozenEvents\n\n    for (let i = 0; i < frozenEvents.length; i++) {\n      if (frozenEvents[i].constructor === EventData) {\n        frozenEvents[i].happenedAt += stateManager.timeInMs - this._frozenAt\n        if ((frozenEvents[i].happenedAt - stateManager.timeInMs) > this.FREEZE_DELAY) {\n          stateManager.addTimeTriggerEvent(frozenEvents[i])\n          console.log('timetrigger')\n          debugWarn(frozenEvents[i])\n        } else {\n          stateManager.addEvent(frozenEvents[i])\n          console.log('added event')\n          debugWarn(frozenEvents[i])\n        }\n      }\n    }\n\n    this._frozenAt = null\n    this._frozenEvents = []\n    stateManager.stateWasUnfreezed(this.stateKey) // TODO: make sure only one state can be frozen ? or add multiple frozen thingy\n  }\n\n  /* = Main functions = */\n  // TODO Use Promise.method\n  // TODO Change all _eventFunctions to arrays\n  registerEventFunctions(eventFlag, overwrite, ...handlingFunctions) {\n    mustBeDefined(eventFlag, overwrite, ...handlingFunctions)\n    mustHaveConstructor(Function, ...handlingFunctions)\n\n    // checks if functions should be stacked in an array for this flag\n    if (this.hasEventFunction(eventFlag)) {\n      if (this._eventFunctions[eventFlag].constructor === Array) {\n        // push the handlingFunction to the array of _eventFunctions[eventFlag]\n        this._eventFunctions[eventFlag] = this._eventFunctions[eventFlag].concat(handlingFunctions)\n        debuglog(`State ${this.stateKey}: several handling functions - handling function pushed to the array of event functions on event '${eventFlag}'`)\n      } else {\n        // creates array of event function\n        this._eventFunctions[eventFlag] = [this._eventFunctions[eventFlag]].concat(handlingFunctions)\n        debuglog(`State ${this.stateKey}: several handling functions - array created for handling functions for state on event '${eventFlag}'`)\n      }\n    } else {\n      this._eventFunctions[eventFlag] = handlingFunctions\n      debuglog(`State ${this.stateKey}: handling function added to state '${this.stateKey}' for event '${eventFlag}'`)\n    }\n  }\n\n  registerCycleFunctions(cycle, overwrite, ...handlingFunctions) {\n    mustBeDefined(cycle, overwrite, ...handlingFunctions)\n    mustHaveConstructor(Function, ...handlingFunctions)\n\n    let arrayName\n    switch (cycle) {\n      case 'awakening':\n        arrayName = '_awakeningFunctions'\n        break\n      case 'ending':\n        arrayName = '_endingFunctions'\n        break\n      case 'update':\n        arrayName = '_updateFunctions'\n        break\n      default:\n        throw new Error('State.registerCycleFunctions: Invalid cycle parameter.')\n    }\n\n    if (overwrite) {\n      this[arrayName] = handlingFunctions\n      debuglog(`State ${this.stateKey}: handling function overwrited ${arrayName}`)\n    } else {\n      this[arrayName] = this[arrayName].concat(handlingFunctions)\n      debuglog(`State ${this.stateKey}: handling function added to ${arrayName} array for state '${this.stateKey}'`)\n    }\n  }\n\n  /* = Short handle = */\n\n  /**\n   * Short hand function that adds several events using the handlingFunctions name as handle.\n   * @param [...function] handlingFunctions\n   */\n  addHandledEvents(...handlingFunctions) {\n    mustBeDefined(...handlingFunctions)\n    mustHaveConstructor(Function, ...handlingFunctions)\n\n    for (let i = 0; i < handlingFunctions.length; i++) {\n      this.registerEventFunctions(handlingFunctions[i].name, true, handlingFunctions[i])\n    }\n  }\n\n  addEventFunctions(eventFlag, ...handlingFunctions) {\n    mustBeDefined(eventFlag, ...handlingFunctions)\n    mustHaveConstructor(Function, ...handlingFunctions)\n    this.registerEventFunctions(eventFlag, false, ...handlingFunctions)\n  }\n\n  overwriteEventFunctions(eventFlag, ...handlingFunctions) {\n    mustBeDefined(eventFlag, ...handlingFunctions)\n    mustHaveConstructor(Function, ...handlingFunctions)\n    this.registerEventFunctions(eventFlag, true, ...handlingFunctions)\n  }\n\n  addAwakeningFunctions(...handlingFunctions) {\n    mustBeDefined(...handlingFunctions)\n    mustHaveConstructor(Function, ...handlingFunctions)\n\n    this.registerCycleFunctions('awakening', false, ...handlingFunctions)\n  }\n\n  overwriteAwakeningFunctions(...handlingFunctions) {\n    mustBeDefined(...handlingFunctions)\n    mustHaveConstructor(Function, ...handlingFunctions)\n\n    this.registerCycleFunctions('awakening', true, ...handlingFunctions)\n  }\n\n  overwriteEndingFunction(...handlingFunctions) {\n    mustBeDefined(...handlingFunctions)\n    mustHaveConstructor(Function, ...handlingFunctions)\n\n    this.registerCycleFunctions('ending', true, ...handlingFunctions)\n  }\n\n  addEndingFunctions(...handlingFunctions) {\n    mustBeDefined(...handlingFunctions)\n    mustHaveConstructor(Function, ...handlingFunctions)\n\n    this.registerCycleFunctions('ending', false, ...handlingFunctions)\n  }\n\n  overwriteUpdateFunctions(...handlingFunctions) {\n    mustBeDefined(...handlingFunctions)\n    mustHaveConstructor(Function, ...handlingFunctions)\n\n    this.registerCycleFunctions('udpate', false, ...handlingFunctions)\n  }\n\n  addUpdateFunctions(...handlingFunctions) {\n    mustBeDefined(...handlingFunctions)\n    mustHaveConstructor(Function, ...handlingFunctions)\n\n    this.registerCycleFunctions('udpate', false, ...handlingFunctions)\n  }\n\n\n  hasEventFunction(eventFlag = mandatory()) {\n    return (_.has(this._eventFunctions, eventFlag))\n  }\n\n\n  /* ======= Getters / Setters ======= */\n  /* === Globals getter / setter === */\n  getGlobal(name = mandatory()) {\n    return (this._stateManager.getGlobal(name))\n  }\n\n  setGlobal(name = mandatory(), value = mandatory()) {\n    return (this._stateManager.setGlobal(name, value))\n  }\n\n  get context() {\n    if (this._stateManager._taskObject) {\n      return (this._stateManager._taskObject.getContext(this))\n    }\n    return ({\n      taskObject: null,\n      dataManager: this._stateManager._dataManager,\n      scene: this._parent, // TODO Force the ._parent to be the .scene ?\n      stateManager: this._stateManager,\n      state: this,\n      R: this._stateManager.R,\n    })\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/framework/State.js","module.exports = __WEBPACK_EXTERNAL_MODULE_8__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"jQuery\",\"commonjs2\":\"jQuery\",\"amd\":\"jQuery\",\"root\":\"jQuery\"}\n// module id = 8\n// module chunks = 0","\n/** @module StateManager */\nimport _ from 'lodash'\nimport BABYLON from 'experiment-babylon-js'\nimport Promise from 'bluebird'\n\nimport RessourceManager from './RessourceManager'\nimport State from './State'\nimport DataManager from './DataManager'\nimport EventData from './EventData'\nimport { mandatory,\n  debuglog, debugWarn, debugError, mustBeDefined, mustHaveConstructor,\n  spreadToObject, Deferred, delay,\n  sizeToVec,\n  hasConstructor,\n} from './utilities'\n\n/**\n * Manage lifecycle and variables through State objects.\n * Can dispatch information to the DataManager.\n * TODO check documentation style for es6 modules\n */\nexport default class StateManager {\n\n  /**\n   * @constructor\n   * @param  {object} parent       Parent  object\n   * @param  {DataManager} dataManager The task dataManager\n   */\n  constructor(parent = mandatory('parent'), dataManager = null) {\n    this._parent = parent\n    this.dataManager = dataManager\n\n    /* --- Look for taskObject and setup RessourceManager accordingly --- */\n    if (typeof parent.parentTaskObject !== 'undefined') {\n      this._taskObject = parent.parentTaskObject\n      this.R = this._taskObject.R\n    } else {\n      this.R = new RessourceManager()\n    }\n\n    const R = this.R\n\n    /**\n     * Array of Data\n     * @type {Array}\n     */\n    this._eventHeap = []\n\n    /**\n     * Stores temporary time triggered event. The update() function checks at each frame if the event should be triggered.\n     * @type {Array}\n     */\n    this._timeTriggerEvents = []\n\n    //\n    // Notes :\n    // 1- should we handle events assynchronously... what is the best way to implement it ?\n    // 2- event related to the awakening or ending of states should not go in the event heap, probably due to redraawing that might lag.\n    //\n\n    this.errorLog = []\n\n    this.R.add({\n      states: {\n        idle: 'idle',\n        pause: 'pause',\n        active: 'active',\n      },\n      values: {\n        timestampThreshold: 10e7,\n      },\n      events: {\n        unfrozen: 'eventUnfrozen',\n      },\n    }, false)\n\n    /*  Hash table of state objects */\n    this.states = {\n      idle: new State(this, R.get.states_idle),\n      active: new State(this, R.get.states_active),\n      pause: new State(this, R.get.states_pause),\n    }\n\n    this._currentStateKey = R.get.states_idle\n\n    /**\n     * Statekey of the current frozenState. If null, no state were frozen.\n     * @type {string}\n     */\n    this.frozenState = null\n\n    /**\n     * Holds variables that needs to be passed from one state to the next.\n     * @type {Object}\n     */\n    this.globals = {}\n\n    this.globalFunctions = {}\n  }\n\n  /* ======== Class methods ======== */\n  update() {\n    /* --- Checks if some _timeTriggerEvents should be added to the heap --- */\n    const toSplice = []\n    for (let i = 0; i < this._timeTriggerEvents.length; i++) {\n      if (this.timeInMs >= this._timeTriggerEvents[i].happenedAt) {\n        this._timeTriggerEvents[i].happenedAt = this.timeInMs // correct for fps delay\n        this.addEvent(this._timeTriggerEvents[i])\n        toSplice.push(i)\n      }\n    }\n    this._timeTriggerEvents.multisplice(...toSplice)\n\n    /* --- Update the state --- */\n    this.currentState.update()\n  }\n\n  storeEvent(event = mandatory()) {\n    try {\n      if (this.dataManager.constructor !== DataManager) {\n        throw new Error('StateManager.storeEvent: dataManager is not set, cannot store event.')\n      }\n\n      if (!event.handled) {\n        debuglog(event)\n        throw new Error('StateManager.storeEvent:cannot store an event that was not handled.')\n      }\n\n      if (event.stored) {\n        debuglog(event)\n        throw new Error('StateManager.storeEvent: Event already stored')\n      }\n\n      event.storedInErrorLog = false\n      let belongsTo = event.data.belongsTo\n      if (belongsTo.constructor !== Array) {\n        belongsTo = [belongsTo]\n      }\n\n      for (let i = 0; i < belongsTo.length; i++) {\n        try {\n          event.data.storedAt = this.timeInMs\n          event.stored = true\n\n          debuglog('StateManager.storeEvent: storing event.')\n          // this.dataManager.log(belongsTo[i], event)\n          this.dataManager.addRows(belongsTo[i], event.formatted)\n          debuglog('StateManager.storeEvent: event stored.', event)\n        } catch (error) {\n          debugError(`StateManager.storeEvent: Could not store data in ${belongsTo[i]} dataTable. Data was stored in the errorLog. DataManager error was: ${error}`)\n          this.storeInErrorLog(event)\n        }\n      }\n    } catch (e) {\n      debugError(e)\n    }\n  }\n\n  storeData(data = mandatory()) {\n    try {\n      if (this.dataManager.constructor !== DataManager) {\n        throw new Error('StateManager.storeData: dataManager is not set, cannot store event.')\n      }\n\n      if (!(_.has(data, 'belongsTo'))) {\n        debuglog(data)\n        throw new Error('StateManager: data needs a belongsTo property in order to store it in the dataManager.')\n      }\n\n      if (hasConstructor(String, data.belongsTo)) {\n        data.belongsTo = [data.belongsTo]\n      }\n\n      data.storedInErrorLog = false\n      for (let i = 0; i < data.belongsTo.length; i++) {\n        try {\n          this.dataManager.addRows(data.belongsTo[i], data)\n        } catch (error) {\n          console.error(`StateManager: Could not store data in ${data.belongsTo[i]} dataTable. Data was stored in the errorLog. DataManager error was: ${error}`)\n          this.storeInErrorLog(data)\n        }\n      }\n    } catch (e) {\n      debugError(e)\n    }\n  }\n\n  storeInErrorLog(data = mandatory()) {\n    if (data.storedInErrorLog === false) {\n      data.storedInErrorLog = true\n      this.errorLog = this.errorLog.concat(data)\n      // TODO check datamanager has error log, if yes store it, if not create it and store it\n      debuglog('StateManager: data stored in the errorLog.')\n    } else {\n      debugWarn('StateManager: data already stored in errorLog. Did not store it again.')\n    }\n  }\n\n  /* === State management === */\n\n  /**\n   * Adds a new state with specified stateKey.\n   * If a list of several states is specified, the function returns an array.\n   *\n   * @param {...string} stateKeys list of additional state\n   */\n  addState(...stateKeys) {\n    try {\n      const returnedStates = []\n      let stateKey\n      for (let i = 0; i < stateKeys.length; i++) {\n        stateKey = stateKeys[i]\n\n        if (stateKey.constructor !== String) {\n          throw new Error('StateManager: stateKey must be a string.')\n        }\n\n        if (_.has(this.states, stateKey)) {\n          throw new Error(`StateManager: a state with a similar stateKey '${stateKey}' already exists.`)\n        }\n\n        this.states[stateKey] = new State(this, stateKey)\n\n        debuglog(`StateManager: added state '${stateKey}'.`)\n\n        returnedStates.push(this.states[stateKey])\n      }\n\n      return (returnedStates.length === 1) ? returnedStates[0] : returnedStates\n    } catch (e) {\n      debugError(e)\n      return null\n    }\n  }\n\n  /* === State change === */\n  goToState(key = mandatory(), reload = false) {\n    if (_.has(this.states, key)) {\n      this.currentState.end()\n\n      this._currentStateKey = key\n      this.states[key].awake(reload)\n    } else {\n      debugError('StateManager: Invalid state key.')\n    }\n  }\n\n  /* ======= Interface ======= */\n  /* */\n\n\n  /**\n   * addGuiCanvas - Create a GUI Canvas always on top with a zOrder of -1\n   *\n   * @param {null} [scene=null] scene object\n   *\n   * @returns {BABYLON.ScreenSpaceCanvas2D} GUI canvas\n   */\n  addGuiCanvas() {\n    try {\n      const scene = this._parent\n      mustHaveConstructor(BABYLON.Scene, scene)\n\n      const canvasOptions = {\n        id: 'GUI',\n        backgroundFill: BABYLON.Canvas2D.GetSolidColorBrush(new BABYLON.Color4(0, 0, 0, 0)),\n        backgroundRoundRadius: 0,\n        x: 0,\n        y: 0,\n        zOrder: 1,\n      }\n\n      const GUI = new BABYLON.ScreenSpaceCanvas2D(scene, canvasOptions)\n\n      GUI.levelVisible = false\n      this.set('GUI', GUI)\n\n      return GUI\n    } catch (e) {\n      debugError(e)\n      return null\n    }\n  }\n\n  // TODO tooltip on the GUI to highlight specific positions\n  tooltip({ replace = false, position = null, size = null, spaced = null, text = '', fontName = '14pt Verdana', duration = null, event = new EventData(this.R.get.events_tooltipDismissed), background = null, fontColor = null }) {\n    // Set the default\n    spaced = spreadToObject(spaced, new BABYLON.Vector2(0, 0))\n    if ((duration === null) || (duration.constructor !== Promise)) {\n      if ((duration !== null) && (duration.constructor === Number)) {\n        duration = delay(duration)\n      } else {\n        duration = (new Deferred()).promise\n      }\n    }\n\n    const guiCanvas = this.get('GUI')\n    guiCanvas.levelVisible = true\n\n    const brownColor = [112 / 255, 102 / 255, 98 / 255, 0.95]\n\n    let tooltips = this.get('tooltips', [])\n    if (tooltips.constructor === Object) {\n      tooltips = [tooltips]\n    }\n    const id = tooltips.length + 1\n\n    let tooltip = null\n    if (replace && tooltips.length) {\n      tooltip = tooltips[tooltips.length - 1]\n    } else if (tooltips.length) {\n      for (const temptool of tooltips) {\n        if (typeof temptool.box !== 'undefined') {\n          temptool.box.zOrder = (id - temptool.id) * 0.01\n          temptool.text.zOrder = ((id - temptool.id) * 0.01) - 0.001\n        }\n        if ((typeof temptool.disposed !== 'undefined') && (temptool.disposed)) {\n          temptool.box.zOrder = 0.001\n          temptool.text.zOrder = 0\n          tooltip = temptool\n          background = spreadToObject(background, new BABYLON.Color4(...brownColor))\n          break\n        }\n      }\n    }\n\n\n    if (tooltip !== null) {\n      tooltip.text.levelVisible = true\n      tooltip.box.levelVisible = true\n\n      tooltip.text.text = text\n\n      const tempPosition = tooltip.box.position.add(sizeToVec(tooltip.box.size).scale(0.5))\n      if (size === null) {\n        tooltip.box.width = tooltip.text.size.width + 24\n        tooltip.box.height = tooltip.text.size.height + 24\n      } else {\n        tooltip.box.width = size.width\n        tooltip.box.height = size.height\n      }\n\n      if (background !== null) {\n        background = spreadToObject(background, new BABYLON.Color4(...brownColor))\n        const brush = BABYLON.Canvas2D.GetSolidColorBrush(background)\n        tooltip.box.fill = brush\n      }\n\n      fontColor = spreadToObject(fontColor, new BABYLON.Color4(1, 1, 1, 1))\n\n      tooltip.text.defaultFontColor = fontColor\n\n\n      position = spreadToObject(position, tempPosition)\n      const nextPos = position.subtract(sizeToVec(tooltip.box.size).scale(0.5).add(spaced))\n        // TODO make a bounding function to make sure the tooltip is visible depending on the rendersize the position and size of the tooltip\n      tooltip.box.position = nextPos\n      tooltip.promise = duration\n      tooltip.event = event\n      tooltip.disposed = false\n    } else {\n      position = spreadToObject(position, new BABYLON.Vector2(0, 0))\n\n      const sizeDefault = spreadToObject(size, new BABYLON.Size(300, 300))\n\n      // const normalColor = [202 / 255, 64 / 255, 0, 0.95]\n\n      // let fontSuperSample = true\n      // let fontSignedDistanceField = false\n      // if (background === null) {\n      //   fontSuperSample = false\n      //   fontSignedDistanceField = true\n      // }\n\n      const fontSuperSample = false\n      const fontSignedDistanceField = true\n      background = spreadToObject(background, new BABYLON.Color4(...brownColor))\n      fontColor = spreadToObject(fontColor, new BABYLON.Color4(1, 1, 1, 1))\n\n      const brush = BABYLON.Canvas2D.GetSolidColorBrush(background)\n\n      const tooltipBox = new BABYLON.Rectangle2D({\n        parent: guiCanvas,\n        id: `tooltipBox${tooltips.length}`,\n        // position: position.subtract(size.scale(0.5).add(spaced)),\n        width: sizeDefault.width,\n        height: sizeDefault.height,\n        // border: brush,\n        // borderThickness: 2,\n        fill: brush,\n      })\n\n      const tooltipText = new BABYLON.Text2D(text, {\n        parent: tooltipBox,\n        id: `tooltipText${tooltips.length}`,\n        marginAlignment: 'h: center, v:center',\n        defaultFontColor: fontColor,\n        fontSuperSample,\n        fontSignedDistanceField,\n        fontName,\n      })\n\n      if (size === null) {\n        tooltipBox.width = tooltipText.size.width + 24\n        tooltipBox.height = tooltipText.size.height + 24\n      }\n\n      tooltipBox.position = position.subtract(sizeToVec(tooltipBox.size).scale(0.5).add(spaced))\n\n\n      tooltip = { box: tooltipBox, text: tooltipText, promise: duration, id, disposed: false, event }\n\n\n      this.set('tooltips', tooltips.concat(tooltip))\n    }\n\n    duration.then(() => {\n      if (tooltip.promise === duration) {\n        this.hideTooltip(tooltip)\n      }\n      if (event.constructor === EventData) {\n        event.happenedAt = this.timeInMs\n        this.addEvent(event)\n      }\n    })\n\n    return tooltip\n  }\n\n  hideTooltip(...tooltips) {\n    const allTooltips = this.get('tooltips', [])\n    if (tooltips.length === 0) {\n      tooltips = allTooltips\n    }\n\n    // const newTooltips = []\n    for (const tooltip of allTooltips) {\n      if (tooltips.indexOf(tooltip) !== -1) {\n        if (typeof tooltip.box !== 'undefined') {\n          tooltip.box.levelVisible = false\n          tooltip.disposed = true // since dispose() is too slow, imitate the behavior by replacing old tooltip if necessary\n        }\n      }\n      // else {\n      //   newTooltips.push(tooltip)\n      // }\n    }\n    // allTooltips.length = 0\n\n    // this.set('tooltips', newTooltips)\n  }\n\n  /* === Pause State === */\n\n  /**\n   * Funtion to set the PAUSE mode for all states. Default uses spacebar keydown event from this._parent.\n   * @param {Number} key  keyCode of the the pause button, default to 32 (spacebar)\n   * @param {string} flag event flag, defaults to this._parent.FLAG_EVENTS_INPUT_KEYDOWN\n   */\n  setPauseKeyStroke(key = 32, flag = null, addDefaultDesign = true) {\n    const pauseState = function (options = null) {\n      const state = this.state\n      const stateManager = this.stateManager\n      const R = this.R\n\n      if (options.data.keyCode === key) {\n        state.freeze() // key function\n        stateManager.goToState(R.get.states_pause)\n      }\n\n      return ('state.pauseState: resolved')\n    }\n\n    const forcePause = function () {\n      this.state.freeze() // key function\n      this.stateManager.goToState(this.R.get.states_pause)\n      return ('state.forcePause: resolved')\n    }\n\n\n    const unPause = function (options = null) {\n      if (options.data.keyCode === key) {\n        if (this.stateManager.frozenState !== null) {\n          this.stateManager.goToState(this.stateManager.frozenState)\n        } else {\n          debugError('state.unPause: no frozen state !')\n        }\n      }\n\n      return ('state.unPause: resolved')\n    }\n\n    flag = (flag !== null) ? flag : this.R.get.events.keydown\n\n    const stateKeys = this.stateKeys\n    for (let i = 0; i < stateKeys.length; i++) {\n      if (stateKeys[i] !== this.R.get.states_pause) {\n        // by default only one pause handling function per state\n        this.registerEventFunction(stateKeys[i], flag, pauseState)\n        this.registerEventFunction(stateKeys[i], this.R.get.events_pause, forcePause)\n      } else {\n        this.registerEventFunction(stateKeys[i], flag, unPause)\n        this.registerEventFunction(stateKeys[i], this.R.get.events_pause, unPause)\n      }\n    }\n\n    if (addDefaultDesign) {\n      this.addDefaultPauseDesign()\n    }\n  }\n\n  /**\n   * Function that adds a basic pause design with background overlay and a large \"PAUSE\" text top center.\n   * Uses babylon Rectangle2D and text2d\n   */\n  addDefaultPauseDesign() {\n    if (BABYLON === null) {\n      return false\n    }\n\n    const awakePause = function (options = null) {\n      try {\n        if (typeof this.taskObject === 'undefined') {\n          throw new Error('state.awakePause: taskObject is undefined')\n        }\n        const stateManager = this.stateManager\n\n        const pauseBackground2D = stateManager.get('pauseBackground2D')\n        const canvas = this.scene.screenCanvas\n\n        if (pauseBackground2D !== null) {\n          pauseBackground2D.size = canvas.size\n          pauseBackground2D.levelVisible = true\n        } else {\n          if (typeof canvas === 'undefined') {\n            return ('awakePause: initialCanvas is undefined.')\n          }\n          // draw a rect2d of canvas size with background opacity 0.5\n          // draw a large text2d \"PAUSE\" inside\n          const baseOptions = {\n            id: 'pauseBackground2D',\n            text: 'Pause',\n            x: 0,\n            y: 0,\n            width: canvas.width,\n            height: canvas.height,\n            fill: BABYLON.Canvas2D.GetSolidColorBrush(new BABYLON.Color4(0.3, 0.3, 0.3, 0.5)),\n            fontName: '40pt Verdana',\n            backgroundRoundRadius: 0,\n          }\n\n          options = _.extend(baseOptions, options)\n\n          let customSized = canvas.size\n          if ((options.width !== canvas.width) || (options.height !== canvas.height)) {\n            customSized = new BABYLON.Size(options.width, options.height)\n          }\n\n          const canvasOptions = {\n            id: options.id,\n            roundRadius: options.backgroundRoundRadius,\n            fill: options.fill,\n            parent: this.scene.screenCanvas,\n            marginAlignment: 'h:center, v: center',\n            size: customSized,\n            zOrder: 0,\n            children: [\n              new BABYLON.Text2D(options.text, {\n                fontName: options.fontName,\n                marginAlignment: 'h: center, v:top',\n                fontSignedDistanceField: true,\n                zOrder: 0,\n              }),\n            ],\n          }\n\n          const pauseBackground2D = new BABYLON.Rectangle2D(canvasOptions)\n\n          stateManager.set('pauseBackground2D', pauseBackground2D) // TODO Make those string part of R.\n        }\n        return ('state.awakePause: resolved')\n      } catch (e) {\n        debugError(e)\n        return e\n      }\n    }\n\n    const endPause = function () {\n      try {\n        if (typeof this.state === 'undefined') {\n          throw new Error('state.endPause: state is undefined')\n        }\n        const stateManager = this.stateManager\n        const pauseBackground2D = stateManager.get('pauseBackground2D')\n\n        if (pauseBackground2D !== null) {\n          // pauseBackground2D.dispose()\n          // stateManager.set('pauseBackground2D', null)\n          pauseBackground2D.levelVisible = false\n        }\n\n        return ('state.endPause: resolved')\n      } catch (e) {\n        debugError(e)\n        return e\n      }\n    }\n\n    this.registerAwakeningFunction(this.R.get.states_pause, awakePause)\n    this.registerEndingFunction(this.R.get.states_pause, endPause)\n\n    return true\n  }\n\n  stateWasFrozen(stateKey = mandatory()) {\n    this.frozenState = stateKey\n\n    // when frezing a state - events are not processed by the next state\n    this.emptyEventHeap()\n    this.emptyTimeTriggerEvents()\n  }\n\n  stateWasUnfreezed(stateKey = mandatory()) {\n    if (this.frozenState !== stateKey) {\n      debugError('StateManager.stateWasUnfreezed: stateKey does not correspond to the frozenState')\n    } else {\n      this.newEvent(this.R.get.events_unfrozen)\n      this.frozenState = null\n    }\n  }\n\n  /* === Time event === */\n  addTimeTriggerEvent(event = mandatory('event')) {\n    if (event.constructor === EventData) {\n      if (event.happenedAt > this.timeInMs + 40) {\n        this._timeTriggerEvents.push(event)\n        debuglog('StateManager: Trigger event added to the time triggers.')\n      } else {\n        this.addEvent(event)\n        debugError('StateManager.addTimeTriggerEvent: trigger event is to close to current time (<40ms). Added directly to the heap.')\n      }\n    } else {\n      debugError('StateManager: Event is not of class EventData.')\n    }\n  }\n\n  /* === Event heap methods === */\n  addEvent(event = mandatory('event')) {\n    if (event.constructor === EventData) {\n      this._eventHeap.push(event)\n      debuglog('StateManager: Event added to the heap.')\n    } else {\n      debugError('StateManager: Event is not of class EventData.')\n    }\n  }\n\n  newEvent(flag = mandatory(), time = null, data = null, belongsTo = ['globalLog']) {\n    // check that the user did not use newEvent as addEvent\n    if (flag.constructor === EventData) {\n      debuglog('StateManager.newEvent: flag is an EventData object. Using addEvent().')\n      this.addEvent(flag)\n      return flag\n    }\n\n    // checks if the user gave a non array to belongsTo\n    if (belongsTo.constructor !== Array) {\n      if (belongsTo.constructor === String) {\n        belongsTo = [belongsTo]\n      } else {\n        debugError('stateManager.newEvent: belongs to need to be either a string or an array')\n        return null\n      }\n    } else if (belongsTo.indexOf('globalLog') === -1) {\n        // add the missing globalLog to belongsTo\n      belongsTo.push('globalLog')\n    }\n\n    const eventOptions = {\n      belongsTo,\n      handledAt: null,\n      storedAt: null,\n    }\n    if (data !== null) {\n      eventOptions.data = data // TODO ++++ SHOULD BE _.extend()\n    } else if ((time !== null) && (time.constructor === Object) && (data === null)) {\n      // treats time as the data and time as unknown\n      eventOptions.data = time\n      time = null\n    }\n\n    /* --- Not a time triggered event --- */\n    if (time === null) {\n      debuglog('stateManager.newEvent: time is null, using addEvent() with this.timeInMs.')\n      const event = new EventData(flag, this.timeInMs, eventOptions)\n      this.addEvent(event)\n      return event\n    }\n\n    /* --- Time triggered event --- */\n    // check if time is a duration or a timestamp - TODO set max duration somewhere\n    if (time < this.R.get.values_timestampThreshold) {\n      // time is a duration\n      time += this.timeInMs\n    }\n\n    const event = new EventData(flag, time, eventOptions)\n    this.addTimeTriggerEvent(event)\n    return event\n  }\n\n  removeFirstEvent() {\n    this._eventHeap.splice(0, 1)\n  }\n\n  removeEvent(event) {\n    this._eventHeap = _.without(this._eventHeap, event)\n  }\n\n  getFirstEventAndRemoveFromHeap(byState = this.currentStateKey) {\n    for (let i = 0; i < this._eventHeap.length; i++) {\n      const event = this._eventHeap[i]\n      if ((event.forState === 'any') || (event.forState === byState)) {\n        return this._eventHeap.splice(i)\n      }\n    }\n\n    return undefined\n  }\n\n  spliceEventsForState(byState = this.currentStateKey) {\n    const toSplice = []\n    for (let i = 0; i < this._eventHeap.length; i++) {\n      const event = this._eventHeap[i]\n      if ((event.forState === 'any') || (event.forState === byState)) {\n        toSplice.push(i)\n      }\n    }\n\n    return this._eventHeap.multisplice(...toSplice) // TODO use only one loop. And put events in a freezer if too long on the heap.\n  }\n\n  emptyEventHeap() {\n    this._eventHeap = []\n  }\n\n  emptyTimeTriggerEvents() {\n    this._timeTriggerEvents = []\n  }\n\n  getAllEvents() {\n    return (this._eventHeap.concat(this._timeTriggerEvents))\n  }\n\n  /**\n   * Called by the state once it has finished handling an event. This function calls the storeEvent function.\n   * @param  {event} event Handled event\n   */\n  stateHasFinishedHandlingEvent(event) {\n    event.data.handledAt = this.timeInMs\n    event.handled = true\n\n    debuglog('StateManager.stateHasFinishedHandlingEvent: event was handled.')\n\n    if ((this.dataManager.constructor === DataManager) && (event.toStore)) {\n      this.storeEvent(event)\n    } else {\n      debugWarn('StateManager.stateHasFinishedHandlingEvent: dataManager is not set, not storing event.')\n    }\n  }\n\n  freezeEventHeap() {\n    this.eventHeapIsFrozen = true\n    this.frozenEventHeap = this._eventHeap\n    // freeze the heap for certain event that need to be processed afterwards in series\n    // TODO elements should not be deleted... maybe have firstNonFrozenEvent(); and a property of events if they are frozen or not\n  }\n\n  unfreezeEventHeap(storeFrozenEvents = true) {\n    this.eventHeapIsFrozen = false\n\n    if (storeFrozenEvents) {\n      /* Reset event heap and store all frozen events in the globalLog */\n      // const tempEvents = this._eventHeap TODO what was that for again ?\n      this.emptyEventHeap()\n    } else {\n      // unfreeze events so they can be processed\n    }\n  }\n\n  /* === State event functions === */\n\n  /**\n   * Registers a new event function for the specified event flag in the specified state. This function will be called in the handleEvent\n   * function of the state if it is the active state. The function should return a Promise.\n   * @param  {string} stateKey         key of state in which to add the new function\n   * @param  {string} eventFlag        event for which the function should be called\n   * @param  {function} handlingFunction Function that should return a Promise.\n   */\n  registerEventFunction(stateKey, eventFlag, ...handlingFunctions) {\n    try {\n      mustBeDefined(stateKey, eventFlag, ...handlingFunctions)\n      mustHaveConstructor(Function, ...handlingFunctions)\n\n      if (_.has(this.states, stateKey)) {\n        this.states[stateKey].registerEventFunctions(eventFlag, true, ...handlingFunctions) // TODO Handle overwrite better ?\n      } else {\n        throw new Error(`StateManager: Invalid state key '${stateKey}'. Create the state before adding event handling functions.`)\n      }\n    } catch (e) {\n      debugError(e)\n    }\n  }\n\n  onNext(eventFlag, ...handlingFunctions) {\n    return this.currentState.onNext(eventFlag, ...handlingFunctions)\n  }\n\n  resolveOnKey(...args) {\n    return this.currentState.resolveOnKey(...args)\n  }\n\n  resolveOnClick(...args) {\n    return this.currentState.resolveOnClick(...args)\n  }\n\n  /**\n   * Adds a function to the awakening function array in the state object. Those function must return a promise.\n   * @param  {[type]} stateKey         [description]\n   * @param  {[type]} handlingFunction [description]\n   * @return {[type]}                  [description]\n   */\n  registerAwakeningFunction(stateKey = mandatory(), handlingFunction = mandatory(), overwrite = false) {\n    if (_.has(this.states, stateKey)) {\n      this.states[stateKey].registerCycleFunctions('awakening', overwrite, handlingFunction)\n    } else {\n      debugError(`StateManager: Invalid state key '${stateKey}'. Create the state before adding awakening handling functions.`)\n    }\n  }\n\n  registerEndingFunction(stateKey = mandatory(), handlingFunction = mandatory(), overwrite = false) {\n    if (_.has(this.states, stateKey)) {\n      this.states[stateKey].registerCycleFunctions('ending', overwrite, handlingFunction)\n    } else {\n      debugError(`StateManager: Invalid state key '${stateKey}'. Create the state before adding awakening handling functions.`)\n    }\n  }\n\n  registerUpdateFunction(stateKey = mandatory(), handlingFunction = mandatory(), overwrite = false) {\n    if (_.has(this.states, stateKey)) {\n      this.states[stateKey].registerCycleFunctions('udpate', overwrite, handlingFunction)\n      debuglog(`StateManager: handling function added to awakeningFunctions array for state '${stateKey}'`)\n    } else {\n      debugError(`StateManager: Invalid state key '${stateKey}'. Create the state before adding awakening handling functions.`)\n    }\n  }\n\n  /* === Globals === */\n  /**\n   * Stores a function into the globalFunctions array of the stateManager. Those function must return a promise.\n   * Storing function in the stateManager should be reserved to functions that are to be reused across states, and in general access global variables.\n   * @param  {string} name            function's name\n   * @param  {function} promiseFunction function should return a promise\n   */\n  registerGlobalFunction(func = mandatory(), name = null) {\n    if (func.constructor !== Function) {\n      debugError('StateManager.registerGlobalFunction: func is not a function')\n    } else {\n      // TODO checks that it works\n      // var promiseFunction = looksLikeAPromise(func) ? func : Promise.method(func); Do no promisify here - give user the choice\n      if (name === null) { name = func.name }\n\n      this.globalFunctions[name] = func\n    }\n  }\n\n  /**\n   * Shorthand for registerGlobalFunction\n   * @param  {string} name            function's name\n   * @param  {function} promiseFunction\n   */\n  register(...functions) {\n    for (let i = 0; i < functions.length; i++) {\n      this.registerGlobalFunction(functions[i])\n    }\n  }\n\n  // TODO get rid of this function use only call\n  callGlobalFunction(name, ...args) {\n    this.call(name, ...args)\n  }\n\n  /**\n   * Shorthand for callGlobalFunction\n   * @param  {string} name    Function's name\n   * @param  {...object} args Optional arguments iterable\n   * @return {promise}\n   */\n  call(name, ...args) {\n    if (typeof name === 'undefined') {\n      debugError('StateManager.call: name of the function needs to be defined.')\n    } else if (_.has(this.globalFunctions, name)) {\n      return (this.globalFunctions[name].bind(this.context)(...args))\n    } else {\n      debugWarn(`StateManager.call: globals do not contain function '${name}'`)\n    }\n    return undefined\n  }\n\n  promise(name, ...args) {\n    if (typeof name === 'undefined') {\n      debugError('StateManager.promiseGlobalFunction: name is undefined.')\n    } else if (_.has(this.globalFunctions, name)) {\n      return (Promise.method(this.globalFunctions[name]).bind(this.context)(...args))\n    } else {\n      debugWarn(`StateManager.promiseGlobalFunction: globals do not contain function '${name}'`)\n    }\n\n    return undefined\n  }\n\n  /**\n   * Recurse on a given registered function, returns a promise resolving to the concatenated results.\n   * @param  {string} name    Name of the function already registered in the stateManager\n   * @param  {numeric} amount The amount of time we should recurse\n   * @param  {Object} options Optional, object to specify as options of the registered function\n   * @param  {Array}  results Optional, where to store the results.\n   * @return {Promise}        Promise resolving to the filed results array.\n   */\n  recurseOnGlobalFunction(name = mandatory(), amount = mandatory(), args = [], results = []) {\n    if (!_.has(this.globalFunctions, name)) {\n      debugError(`StateManager.recurseOnGlobalFunction: globals do not contain function '${name}'`)\n      return null\n    }\n      // Base case - just return the promisified result\n    if (amount === 0) {\n      return new Promise((resolve) => {\n        resolve(results)\n      })\n    }\n\n\n    const next = this.promise(name, ...args).then((r) => {\n      results = results.concat(r)\n      return (this.recurseOnGlobalFunction(name, amount - 1, args, results))\n    })\n\n    return next\n  }\n\n  /**\n   * Shorthand for recurseOnGlobalFunction.\n   * @param  {string} name    Name of the function already registered in the stateManager\n   * @param  {numeric} amount The amount of time we should recurse\n   * @param  {args} args Optional, array of arguments to pass to the promise\n   * @param  {Array}  results Optional, where to store the results.\n   * @return {Promise}        Promise resolving to the filed results array.\n   */\n  recurse(name = mandatory(), amount = mandatory(), args = [], results = []) {\n    this.recurseOnGlobalFunction(name, amount, args, results)\n  }\n\n  /**\n   * Return a stored global or null if it does not exist.\n   * @param  {string} name String name of the variable\n   * @return {?*}\n   */\n  getGlobal(name = mandatory(), setDefault) {\n    if (this.globals.hasOwnProperty(name)) {\n      return (this.globals[name])\n    } else if (typeof setDefault !== 'undefined') {\n      this.globals[name] = setDefault\n      return this.globals[name]\n    }\n    debugWarn(`StateManager: globals do not contain variable '${name}' - and no default is given`)\n    return (null)\n  }\n\n  get(name = mandatory(), setDefault) {\n    return (this.getGlobal(name, setDefault))\n  }\n\n  /**\n   * Stores a global variable. Beware if storing objects (stored by reference, any modification outside of the statemanager will affect the stored variable).\n   * Maybe a _.cloneDeep would be better... lets think about it for a while.\n   * @param {string} name  Name of the variable\n   * @param {*} value Variable\n   */\n  setGlobal(name = mandatory(), value = mandatory()) {\n    this.globals[name] = value\n    debuglog(`StateManager: global '${name}' set to '${value}'`)\n  }\n\n  set(name = mandatory(), value = mandatory()) {\n    this.setGlobal(name, value)\n  }\n\n  getStateObject(key) {\n    if (_.has(this.states, key)) {\n      return (this.states[key])\n    }\n    debugError('StateManager: Invalid state key.')\n    return undefined\n  }\n\n  /* ======== Getters and Setters ======== */\n\n  // TODO Redo documentation of those functions\n  // static get context() {}\n  // static get currentStateKey() {}\n  // static get currentState() {}\n  // static get eventHeap() {}\n  // static get firstEvent() {}\n  // static get time() {}\n  // static get timeInSec() {}\n  // static get timeInMs() {}\n\n  /**\n   * Returns a summary object containing the taskObject, dataManager, ressourceManager\n   * as well as current scene, stateManager, and state.\n   * Used as a a context accros the library when calling state functions (with .bind(context))\n   */\n  get context() {\n    if (this._taskObject) {\n      return (this._taskObject.getContext(this))\n    }\n    return ({\n      taskObject: null,\n      dataManager: this.dataManager,\n      scene: this._parent, // TODO Force the ._parent to be the .scene ?\n      stateManager: this,\n      state: this.currentState,\n      R: this.R,\n    })\n  }\n\n  get stateKeys() {\n    return (Object.keys(this.states))\n  }\n\n  get currentStateKey() {\n    return (this._currentStateKey)\n  }\n\n  set currentStateKey(key) {\n    if (_.has(this.states, key)) {\n      this.goToState(key)\n    } else {\n      debugError('StateManager: Invalid state key.')\n    }\n  }\n\n  get currentState() {\n    return this.states[this.currentStateKey]\n  }\n\n  set currentState(state) {\n    if (typeof state.key !== 'undefined') {\n      this.currentStateKey = state.key\n    } else {\n      debugError('StateManager: Invalid state, it has no state key defined.')\n    }\n  }\n\n  get eventHeap() {\n    return (this._eventHeap)\n  }\n\n  set eventHeap(value) { // eslint-disable-line\n    debugError('StateManager: eventHeap is readonly. Add events through the class methods.')\n  }\n\n  get firstEvent() {\n    if (this._eventHeap.length) {\n      return (this._eventHeap[0])\n    }\n    return undefined\n  }\n\n  set firstEvent(value) {\n    // TODO not implemented -- maybe somekind of bruteforce to have an important input be treated first\n    debugError('StateManager: firstEvent is readonly.')\n  }\n\n  /* === Time functions === */\n\n  get time() {\n    return (this.timeInMs)\n  }\n\n  get timeInSec() {\n    return (new Date().getTime() / 1000)\n  }\n\n  get timeInMs() {\n    return (new Date().getTime())\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/framework/StateManager.js","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/process/browser.js\n// module id = 10\n// module chunks = 0","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 11\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_12__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"experiment-boxes\",\"commonjs2\":\"experiment-boxes\",\"amd\":\"experiment-boxes\",\"root\":\"experimentBoxes\"}\n// module id = 12\n// module chunks = 0","module.exports = __WEBPACK_EXTERNAL_MODULE_13__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"experiment-mathjs\",\"commonjs2\":\"experiment-mathjs\",\"amd\":\"experiment-mathjs\",\"root\":\"math\"}\n// module id = 13\n// module chunks = 0","/**\n * Boiler Plate For Cognitive Tasks JS\n *\n *\n * author: Albert Buchard 2016\n *\n * REQUIRE ECMA2016 / JQUERY / MATHJS / BABYLON\n */\n\n/* =============== Set-up =============== */\nimport _ from 'lodash'\nimport BABYLON from 'experiment-babylon-js'\n\nimport { ParamBox, SmartModal } from 'experiment-boxes'\nimport Promise from 'bluebird'\nimport math from 'experiment-mathjs'\n\nimport DataManager from './DataManager'\nimport RessourceManager from './RessourceManager'\nimport EventData from './EventData'\nimport StateManager from './StateManager'\nimport State from './State'\n\nimport {\n  Array,\n  String,\n  Deferred,\n  mandatory,\n  debuglog,\n  debugWarn,\n  debugError,\n  mustHaveConstructor,\n  delay,\n  hasConstructor,\n} from './utilities'\n\n\nif (typeof window !== 'undefined') {\n  /* === Get the absolute path of the library === */\n  const scripts = document.getElementsByTagName('script')\n  if (scripts.length) {\n    const assetsFolderFullpath = scripts[scripts.length - 1].src\n    const delimiterIndices = assetsFolderFullpath.indicesOf('/')\n    window.assetsFolderFullpath = assetsFolderFullpath.substr(0, delimiterIndices[delimiterIndices.length - 2])\n  } else {\n    window.assetsFolderFullpath = './'\n  }\n}\n\n/** Class handling graphic engine interface and lifecycle of the task */\nexport default class TaskObject {\n  /**\n   * class constructor : initialize the task\n   * @param  {Object} target element where the task will be contained\n   * @return {TaskObject}\n   */\n  constructor(target = mandatory(),\n    assetsFolder = null,\n    engine = 'babylon') {\n    if (typeof window === 'undefined') { // TODO should it fail more gracefully ?\n      return { error: 'Wrong environment. ExperimentJS only works in the browser.' }\n    }\n    /* --- Constants --- */\n    // this.constants = {};\n\n    /* --- Store canvas information --- */\n    this._target = (typeof target.length !== 'undefined') ? target[0] : target\n    this.canvas = this._target\n\n    /* --- Setup engine --- */\n    if (engine === 'babylon') {\n      // Start BabylonJS engine\n      this.engine = new BABYLON.Engine(this.canvas, false, null, false) // TODO check hardware for retina\n    } else {\n      throw new Error('TaskObject.constructor: engine not supported.')\n    }\n\n    /* --- Size values --- */\n    this.height = window.innerHeight\n    this.width = window.innerWidth\n    this.babylonCanvasHeight = this.canvas.height\n    this.babylonCanvasWidth = this.canvas.width\n\n    /**\n     * Task DataManager\n     * @type {DataManager}\n     */\n    this.dataManager = new DataManager(this)\n\n    /**\n     * The main connection object in the dataManager used by the TaskObject.\n     * It is set when using this.setConnection() which is a wrapper for the dataManager function\n     * @type {Object}\n     */\n    this.connection = null\n\n    /* --- Add global mouse and keyboard event tables --- */\n    const globalLogFields = this.dataManager.GLOBAL_LOG_FIELDS\n\n    // globalLogs is the default data table of the dataManager,\n    // adding specific data table for mouse and key events\n    this.dataManager.addTable('keyEvents', globalLogFields)\n    this.dataManager.addTable('mouseEvents', globalLogFields)\n\n    /* --- Add task status table --- */\n    const taskStatusFields = ['level', 'happenedAt']\n    this.dataManager.addTable('taskStatus', taskStatusFields)\n\n    /* --- Add raised flags --- */\n    const statusFlagsFields = ['flag', 'happenedAt']\n    this.dataManager.addTable('statusFlags', statusFlagsFields)\n\n    /* --- Add the checkpoint table --- */\n    const checkpointFields = ['code', 'happenedAt', 'message']\n    this.dataManager.addTable('checkpoints', checkpointFields)\n\n    /* --- Assets --- */\n    /**\n     * Path to assets folder\n     * @type {String}\n     */\n    if (assetsFolder) {\n      this.ASSETS_FOLDER = assetsFolder\n    } else {\n      this.ASSETS_FOLDER = window.assetsFolderFullpath\n    }\n\n    this.ASSETS_FLARE_PATH = `${this.ASSETS_FOLDER}/textures/flare/flare.png`\n\n    /**\n     * Object to store global task assets after loading or creation\n     * @type {Object}\n     */\n    this.assetsToLoad = {}\n\n    this.R = new RessourceManager()\n    this.R.add({\n      states: {\n        active: 'active',\n        idle: 'idle',\n        pause: 'pause',\n      },\n      folders: {\n        assetsFolder: assetsFolder || window.assetsFolderFullpath,\n      },\n    })\n\n\n    /* --- Set-up events --- */\n    this.flags = {}\n    this.keyState = [] // holds state of keys being stroked indexed by event.keyCode\n    this.shouldShowDebug = typeof window.DEBUG_MODE_ONE !== 'undefined' ? window.DEBUG_MODE_ONE : false\n    this.setupGlobalEvents()\n\n    /* --- Modals --- */\n    this.currentModal = null\n\n    /* --- Task parameters --- */\n    this.parameters = {}\n\n    /* --- Task level variables --- */\n    this.variables = {}\n    this.variables.shouldSeeInformation = true\n\n    /* --- Scenes --- */\n    this.scenes = {}\n    this.sceneGenerators = {}\n    this.sceneGenerators.functions = {}\n    this.sceneGenerators.functionsOptions = {}\n\n    /* --- Set a default loading scene --- */\n    this.sceneGenerators.loading = TaskObject.default2dSceneGenerator\n    this.sceneGenerators.loadingOptions = { sceneKey: 'loading', shouldLoadAssets: true }\n\n    this._currentSceneKey = ''\n\n    /* --- ParamBox setup --- */\n    this._paramBox = null\n\n    /* if ParamBox library is loaded - create one */\n    if (typeof ParamBox === 'function') {\n      this._paramBox = new ParamBox()\n    }\n  }\n\n  /* ======== Scene generators ======== */\n  /*\n  newScene(key = mandatory()) {\n    // TODO create a child object holding scene keys, scene generators and babylon scenes\n  }\n\n  registerSceneGenerators(...sceneGeneratorObjects) {\n    // TODO\n  }\n  */\n\n  registerSceneGenerator(sceneGenerator = mandatory('sceneGenerator'), options = {}, loading = false, promise = false, key = null) {\n    // option base\n    options = _.clone(options)\n\n    if ((key === null) && (sceneGenerator.name !== '')) {\n      key = sceneGenerator.name\n    } else {\n      key = `scene${Object.keys(this.sceneGenerators.functions).length}`\n    }\n\n    if (loading) {\n      this.sceneGenerators.loading = sceneGenerator\n      this.sceneGenerators.loadingOptions = options\n    } else {\n      this.sceneGenerators.functions[key] = sceneGenerator\n      this.sceneGenerators.functionsOptions[key] = options\n    }\n  }\n\n  registerLoadingFunction(loadingSceneGenerator = mandatory('loadingSceneGenerator'), options = {}, promise = false) {\n    /* --- Force sceneKey to be loading --- */\n    options.sceneKey = 'loading'\n\n    this.registerSceneGenerator(\n      loadingSceneGenerator,\n      options,\n      true,\n      promise,\n    )\n  }\n\n  callSceneGenerator(key = mandatory()) {\n    const sceneOptions = this.sceneGenerators.functionsOptions[key]\n    const generator = this.sceneGenerators.functions[key]\n\n    const promise = Promise.method(generator.bind(this.context))(sceneOptions)\n      .then((scene) => {\n        if (typeof scene.sceneKey === 'undefined') {\n          scene.sceneKey = key\n        }\n\n        this.scenes[scene.sceneKey] = scene\n      })\n\n    return promise\n  }\n\n  generateScenes() {\n    const functionKeys = Object.keys(this.sceneGenerators.functions)\n    const promises = []\n    for (let i = 0; i < functionKeys.length; i++) {\n      promises.push(this.callSceneGenerator(functionKeys[i]))\n    }\n\n    return Promise.all(promises)\n  }\n\n  static default2dSceneGenerator(options) {\n    /* --- Get the taskObject instance from binded context --- */\n    const taskObject = this.taskObject\n\n    const optionsBase = {\n      canvasBackground: new BABYLON.Color4(1, 1, 1, 1),\n      backgroundRoundRadius: 0,\n      clearColor: new BABYLON.Color4(1, 1, 1, 1),\n      canvasPercentWidth: 1,\n      canvasPercentHeight: 1,\n      mode: 'central',\n      level: null,\n      shouldLoadAssets: false,\n    }\n\n    options = _.extend(optionsBase, options)\n\n    /* --- Create a basic 2D scene using a Canvas2D as background --- */\n    const scene = taskObject.create2DScene(options)\n\n    /* --- Load assets --- */\n    let assetObject = {\n      logo: {\n        path: '/assets/experiment-js.svg',\n        type: 'texture',\n      },\n    }\n\n    // Will load all the assets contained in the task assetsToLoad variable\n    if (options.shouldLoadAssets) {\n      assetObject = _.extend(assetObject, taskObject.assetsToLoad)\n    }\n\n    // add content loaded text\n    scene.loadingPromise = taskObject.loadAssets(assetObject, scene)\n    .then(() => {\n      const canvas = scene.initialCanvas\n\n      const texture = taskObject.R.get.textures_logo\n      texture.hasAlpha = true\n\n      const height = math.max(taskObject.renderSize.height * 0.05, 45)\n      new BABYLON.Sprite2D(texture, { // eslint-disable-line\n        parent: canvas,\n        id: 'logo',\n        marginAlignment: 'h: center, v:center',\n        size: new BABYLON.Size(height * 3000 / 730, height),\n        origin: BABYLON.Vector2.Zero(),\n      })\n    })\n\n\n    return scene\n  }\n\n  cloneAssetsIntoScene(assets = mandatory(), scene = mandatory()) {\n    if (assets.constructor !== Array) {\n      assets = [assets]\n    }\n\n    const assetsArray = []\n    for (let i = 0; i < assets.length; i++) {\n      const clone = assets[i].clone()\n      clone._scene = scene\n\n      if (assets[i].constructor === BABYLON.Mesh) {\n        if (clone.material) {\n          clone.material = clone.material.clone()\n          clone.material._scene = scene\n          if (clone.material.subMaterials) {\n            for (let j = 0; j < clone.material.subMaterials.length; j++) {\n              clone.material.subMaterials[j] = clone.material.subMaterials[j].clone()\n              clone.material.subMaterials[j]._scene = scene\n            }\n          }\n        }\n        scene.addMesh(clone)\n      }\n\n      assetsArray.push(clone)\n    }\n\n    return assetsArray\n  }\n\n  loadAssets(assetObject = mandatory(), scene = mandatory(), assetFolder = '') {\n    if (assetObject.constructor !== Object) {\n      throw new Error('TaskObject.loadAssets: assetObject is not an Object')\n    }\n\n    if ((assetFolder === '') && (typeof this.ASSETS_FOLDER !== 'undefined')) {\n      assetFolder = this.ASSETS_FOLDER\n    }\n\n    const textureFormats = ['png', 'bmp', 'jpg', 'tiff', 'svg']\n    const soundFormats = ['wav', 'mp3', 'flac', 'aac', 'mp4', 'ogg']\n\n    const assetManager = new BABYLON.AssetsManager(scene)\n    const R = this.R\n\n    const binaryPromises = []\n\n    const names = Object.keys(assetObject)\n    let field\n    let type\n    let path\n    for (let i = 0; i < names.length; i++) {\n      field = assetObject[names[i]]\n\n      if (field.constructor === String) {\n        path = this.ASSETS_FOLDER + field\n\n        if (textureFormats.indexOf(R.getFormat(path)) !== -1) {\n          type = 'texture'\n        } else if (soundFormats.indexOf(R.getFormat(path)) !== -1) {\n          type = 'sound'\n        } else {\n          console.warn('TaskObject.loadAssets: asset invalid or not implemented with shorthand string definition (use full object with path and type)')\n          type = 'invalid'\n        }\n      } else if ((field.constructor === Object) && (Object.keys(field).includes(['path', 'type']))) {\n        path = this.ASSETS_FOLDER + field.path\n        type = field.type\n      } else {\n        console.warn('TaskObject.loadAssets: asset invalid')\n        type = 'invalid'\n      }\n\n      if (type === 'texture') {\n        const assetManagerTask = assetManager.addTextureTask(`${names[i]}Task`, path)\n        assetManagerTask.onSuccess = function (task) {\n          R.add({\n            textures: {\n              [this.textureName]: task.texture,\n            },\n          })\n        }.bind({\n          textureName: names[i],\n        })\n      } else if (type === 'sound') {\n        const assetManagerTask = assetManager.addBinaryFileTask(`${names[i]}Task`, path)\n        assetManagerTask.onSuccess = function (task) {\n          const isReady = new Deferred()\n          binaryPromises.push(isReady.promise)\n          R.add({\n            sounds: {\n              [this.soundName]: new BABYLON.Sound(this.soundName, task.data, scene, isReady.resolve),\n            },\n          })\n        }.bind({\n          soundName: names[i],\n        })\n      }\n      // TODO all the rest such as Meshes.. what else ?\n    }\n\n    /* --- Create a Deferred promise that will resolve after loading is complete --- */\n    const loadDeferred = new Deferred()\n\n    assetManager.load()\n    assetManager.onFinish = function onFinish(tasks) {\n      debuglog('TaskObject.loadAssets: tasks completed', tasks)\n      Promise.all(binaryPromises).then(() => loadDeferred.resolve(tasks))\n    }\n\n    return loadDeferred.promise\n  }\n\n  cloneAssetIntoScene(asset = mandatory(), scene = mandatory()) {\n    // TODO: Merge with cloneAssetsIntoScene\n    if (asset.constructor === Array) {\n      return this.cloneAssetsIntoScene(asset, scene)\n    }\n\n    const clone = asset.clone()\n    clone._scene = scene\n\n    if (asset.constructor === BABYLON.Mesh) {\n      if (clone.material) {\n        clone.material = clone.material.clone()\n        clone.material._scene = scene\n        if (clone.material.subMaterials) {\n          for (let i = 0; i < clone.material.subMaterials.length; i++) {\n            clone.material.subMaterials[i] = clone.material.subMaterials[i].clone()\n            clone.material.subMaterials[i]._scene = scene\n          }\n        }\n      }\n      scene.addMesh(clone)\n    }\n\n    return clone\n  }\n\n  /* ======== Class Methods ======== */\n  /* ======== Lifecycle Methods ======== */\n  /**\n   * Creates the game engine object and loads the scenes.\n   */\n  startTask() {\n    if (typeof window === 'undefined') {\n      return Promise.resolve()\n    }\n\n    window.addEventListener('resize', () => {\n      this.engine.resize()\n    })\n\n    const deferred = new Deferred()\n    /* --- Create a loading scene in order to load assets --- */\n    const loadingOptions = this.sceneGenerators.loadingOptions\n    const loadingScene = (this.sceneGenerators.loading.bind(this.context))(loadingOptions)\n    loadingScene.loadingPromise.then(() => {\n        /* --- Store the scene in the TaskObject --- */\n      this.scenes.loading = loadingScene\n\n        /* --- Set the currentScene to the loading scene that has finished loading --- */\n      this.currentScene = loadingScene.sceneKey\n\n      if ((typeof loadingScene.loadingPromise !== 'undefined') && (loadingScene.loadingPromise.constructor === Promise)) {\n        return loadingScene.loadingPromise\n      }\n      return Promise.resolve()\n    })\n      .then(() => {\n        /* --- Set the loaded flag --- */\n        this.dataManager.addRows('statusFlags', {\n          flag: this.R.get.flags_hasLoaded,\n          happenedAt: this.timeInMs,\n        })\n\n        /* --- Start the render loop --- */\n        this.engine.runRenderLoop(() => {\n          this.scenes[this.currentScene].render()\n        })\n\n        /* --- Now that assets are loaded we generate the task scenes --- */\n        return this.generateScenes()\n      })\n      .then((message) => {\n        debuglog(message)\n        deferred.resolve('TaskObject.startTask: loaded and scene generated.')\n      })\n\n    return deferred.promise\n  }\n\n  /* ======== Babylon Setup ======== */\n  /* === Global events === */\n  setupGlobalEvents() {\n    // TODO: Put every flag in the ressourceManager\n    /* --- Lifecycle flags --- */\n    const R = this.R\n    R.add({\n      flags: { // TODO think about how to order those strings so not mess everything up and keep it understandable\n        hasLoaded: 'hasLoaded',\n        sceneStarts: 'scene_starts',\n        sceneEnds: 'scene_ends',\n      },\n      events: {\n        mouseMove: 'mouse_move',\n        click: 'mouse_click',\n        pick: 'mouse_pick',\n        keydown: 'key_down',\n        keyup: 'key_up',\n        resize: 'resize',\n        windowFocus: 'windowFocus',\n        windowBlur: 'windowBlur',\n        pause: 'pause',\n        wasHandled: 'was_handled',\n        beingHandled: 'being_handled',\n        modalDismissed: 'modalDismissed',\n        tooltipDismissed: 'tooltipDismissed',\n      },\n    })\n\n    /* Add keyboard listener */\n    window.addEventListener('keydown', (evt) => {\n      debuglog('TaskObject: Keydown event.')\n      debuglog(evt)\n\n      // call taskObject keyfunction handler\n      this.keyfunction(evt)\n\n      // store keydown event\n      const eventData = new EventData(\n        R.get.events_keydown,\n        this.timeInMs, {\n          belongsTo: ['globalLog', 'keyEvents'],\n          handledAt: null,\n          storedAt: null,\n          keyCode: evt.keyCode,\n          key: evt.key,\n        },\n      )\n\n      // TODO add event to current scene should be a method\n      if (typeof this.currentSceneObject !== 'undefined') {\n        if (typeof this.currentSceneObject.stateManager !== 'undefined') {\n          this.currentSceneObject.stateManager.addEvent(eventData)\n        }\n      }\n    })\n\n    // update the keystates when keyup but do not store event\n    // TODO think if usefull to store keyup\n    window.addEventListener('keyup', (evt) => {\n      this.keyfunction(evt)\n    })\n\n    /* window.addEventListener(\"mousemove\", function(evt) {\n      debuglog(\"TaskObject: mousemove event.\");\n      debuglog(evt);\n\n      var eventData = new EventData(thisObject.FLAG_EVENTS_INPUT_MOUSEMOVE, thisObject.timeInMs, {\n        belongsTo: [\"globalLog\", \"mouseEvents\"],\n        handledAt: null,\n        storedAt: null,\n        clientX: evt.clientX,\n        clientY: evt.clientY\n      }); //make an static EventData from dom event?\n\n      if (typeof thisObject.currentSceneObject !== \"undefined\") {\n        if (typeof thisObject.currentSceneObject.stateManager !== \"undefined\") {\n          thisObject.currentSceneObject.stateManager.addEvent(eventData);\n        }\n      }\n\n    });*/\n    window.addEventListener('mousedown', (evt) => {\n      debuglog('TaskObject: mousedown event.')\n      debuglog(evt)\n\n      const eventData = new EventData(\n        R.get.events_click,\n        new Date().getTime(), {\n          belongsTo: ['globalLog', 'mouseEvents'],\n          handledAt: null,\n          storedAt: null,\n          clientX: evt.clientX,\n          clientY: evt.clientY,\n          engineX: evt.clientX *\n            (this.renderSize.width / window.innerWidth),\n          engineY: (window.innerHeight - evt.clientY) *\n            (this.renderSize.height / window.innerHeight),\n        },\n      )\n\n      // make an static EventData from dom event?\n      if (typeof this.currentSceneObject !== 'undefined') {\n        if (typeof this.currentSceneObject.stateManager !== 'undefined') {\n          this.currentSceneObject.stateManager.addEvent(eventData)\n        }\n      }\n    })\n\n\n    window.addEventListener('resize', (evt) => {\n      debuglog('TaskObject: resize event.')\n      debuglog(evt)\n\n      const eventData = new EventData(\n        R.get.events_resize,\n        this.timeInMs, {\n          belongsTo: ['globalLog'],\n          handledAt: null,\n          storedAt: null,\n          outerHeight: evt.target.outerHeight,\n          outerWidth: evt.target.outerWidth,\n        },\n      )\n\n      // if a current scene exists pass it down the stateManager\n      // and look for a resize handler updateContentFrame\n      if (typeof this.currentSceneObject !== 'undefined') {\n        try {\n          this.addEventToCurrentScene(eventData)\n        } catch (e) {\n          console.error(e)\n        } finally {\n          if (typeof this.currentSceneObject.updateContentFrame !== 'undefined') {\n            this.currentSceneObject.updateContentFrame()\n          }\n        }\n      }\n    })\n\n    /* --- Focus event --- */\n    const checkFocus = function () {\n      let event = R.get.events_windowBlur\n      if (document.hasFocus()) {\n        event = R.get.events_windowFocus\n      }\n\n      this.addEventToCurrentScene(new EventData(event, this.timeInMs))\n    }.bind(this)\n\n    let visibilityChange\n    if (typeof document.hidden !== 'undefined') {\n      visibilityChange = 'visibilitychange'\n    } else if (typeof document.mozHidden !== 'undefined') {\n      visibilityChange = 'mozvisibilitychange'\n    } else if (typeof document.msHidden !== 'undefined') {\n      visibilityChange = 'msvisibilitychange'\n    } else if (typeof document.webkitHidden !== 'undefined') {\n      visibilityChange = 'webkitvisibilitychange'\n    }\n\n    document.addEventListener(visibilityChange, checkFocus)\n    window.addEventListener('focus', checkFocus)\n    window.addEventListener('blur', checkFocus)\n  }\n\n  keyfunction(e) {\n    const dCode = 68\n    const shiftCode = 16\n    const altCode = 18 // TODO check if it is the same on all platforms\n\n    // check if shift + P hotkeys were stroke and toggle visibility if so\n    this.keyState[e.keyCode] = e.type === 'keydown'\n\n    // hide and show debug layer\n    if (this.keyState[shiftCode] && this.keyState[altCode] && this.keyState[dCode]) {\n      // 16 == Shift - 68 == D -- 18 Alt\n      // make sure to reset D value in case keyup event is ignored (keep shift true for rapid toggle)\n      this.keyState[dCode] = false\n      this.keyState[altCode] = false\n\n      // toggle debug visibility\n      this.toggleDebugLayer()\n\n      // prevent default action if any\n      e.preventDefault()\n    }\n  }\n\n  addStateManager(scene = mandatory('scene')) {\n    scene.stateManager = new StateManager(scene, this.dataManager)\n  }\n\n  // TODO create a familly of hooks that call functions forthe curent scene, like this one\n  addEventToCurrentScene(eventData = mandatory()) {\n    try {\n      // checks that there is a current scene\n      if (typeof this.currentSceneObject !== 'undefined') {\n        // checks that the scene has a stateManager\n        if (typeof this.currentSceneObject.stateManager !== 'undefined') {\n          // adds the event\n          this.currentSceneObject.stateManager.addEvent(eventData)\n        } else {\n          throw new Error('TaskObject.addEventToCurrentScene: No stateManager in currentSceneObject')\n        }\n      } else {\n        // else return an error message\n        throw new Error('TaskObject.addEventToCurrentScene: No current scene object')\n      }\n    } catch (e) {\n      debugError(e)\n    }\n  }\n\n\n  /**\n   * create2DScene - 2D Scene generator with an initialCanvas of the specifified size\n   * Babylon Scene objects are enriched in experiment-js with:\n   *  - sceneKey\n   *  - parentTaskObject\n   *  - stateManager\n   *  - dataManager\n   *  - initialCanvas\n   *  - initialCamera\n   *  - updateContentFrame\n   * Importantly - The registerBeforeRender() lifecycle function calls the update function of the stateManager\n   *\n   * @param {object} [options] Object with key-value options for the 2D scene, defaults are :\n   *  - sceneKey: `scene${Math.random() * 100000}`,\n   *  - canvasBackground: new BABYLON.Color4(0, 0, 0, 1),\n   *  - backgroundRoundRadius: 50,\n   *  - clearColor: new BABYLON.Color4(0, 0, 0, 1),\n   *  - canvasPercentWidth: 0.8,\n   *  - canvasPercentHeight: 1,\n   *\n   *\n   * @returns {BABYLON.Scene}\n   */\n  create2DScene(options = mandatory()) {\n    const optionsBase = {\n      sceneKey: `scene${Math.random() * 100000}`,\n      canvasBackground: new BABYLON.Color4(0, 0, 0, 1),\n      backgroundRoundRadius: 0,\n      clearColor: new BABYLON.Color4(0, 0, 0, 1),\n      width: null,\n      height: null,\n      canvasPercentWidth: 1,\n      canvasPercentHeight: 1,\n      minWidth: Number.NEGATIVE_INFINITY,\n      minHeight: Number.NEGATIVE_INFINITY,\n      maxWidth: Number.POSITIVE_INFINITY,\n      maxHeight: Number.POSITIVE_INFINITY,\n    }\n\n    options = _.extend(optionsBase, options)\n\n    const getCanvasDimensions = (noNull = true) => {\n      let size = null\n      let width = null\n      let height = null\n\n      const pWidth = (this.renderSize.width * options.canvasPercentWidth).boundTo(options.minWidth, options.maxWidth)\n      const pHeight = (this.renderSize.height * options.canvasPercentHeight).boundTo(options.minWidth, options.maxHeight)\n\n      let x = null\n      let y = null\n\n      if (options.width) {\n        width = options.width\n      } else if (options.canvasPercentWidth !== 1) {\n        width = pWidth\n      }\n      if (options.height) {\n        height = options.height\n      } else if (options.canvasPercentHeight !== 1) {\n        height = pHeight\n      }\n\n      if ((height !== null) || (width !== null) || noNull) {\n        size = new BABYLON.Size(width !== null ? width : pWidth, height !== null ? height : pHeight)\n        x = (this.renderSize.width / 2) - ((this.renderSize.width * options.canvasPercentWidth) / 2)\n        y = (this.renderSize.height / 2) - ((this.renderSize.height * options.canvasPercentHeight) / 2)\n      }\n\n      return { size, x, y }\n    }\n\n    const { size: customSized } = getCanvasDimensions()\n\n\n    const scene = new BABYLON.Scene(this.engine)\n\n    /**\n     * Holds the scenekey inside the scene object.\n     * @type {string}\n     */\n    scene.sceneKey = options.sceneKey\n\n    /**\n     * Reference to the parent taskObject\n     * @type {TaskObject}\n     */\n    scene.parentTaskObject = this\n\n    /* --- Add a stateManager --- */\n    this.addStateManager(scene)\n\n    /* --- Set background --- */\n    scene.clearColor = options.clearColor\n\n    const camera = new BABYLON.ArcRotateCamera('Camera', 0, Math.PI / 2, 12, BABYLON.Vector3.Zero(), scene)\n    let canvasOptions = {\n      id: 'ScreenCanvas',\n      backgroundFill: BABYLON.Canvas2D.GetSolidColorBrush(options.clearColor),\n      fill: BABYLON.Canvas2D.GetSolidColorBrush(options.clearColor),\n      zOrder: 1,\n    }\n\n    const canvas = new BABYLON.ScreenSpaceCanvas2D(scene, canvasOptions)\n\n    canvasOptions = {\n      id: 'initialCanvas',\n      parent: canvas,\n      roundRadius: options.backgroundRoundRadius,\n      borderThickness: 0,\n      fill: BABYLON.Canvas2D.GetSolidColorBrush(options.canvasBackground),\n      marginAlignment: 'h: center, v: center',\n      size: customSized,\n      zOrder: 1,\n    }\n\n    const initialCanvas = new BABYLON.Rectangle2D(canvasOptions)\n\n    /* Set the added canvas and camera to known fields in the scene*/\n    scene.screenCanvas = canvas\n    scene.initialCanvas = initialCanvas\n    scene.initialCamera = camera\n\n    scene.initialCanvas.lastResize = this.timeInMs\n\n    /* Create a GUI canvas */\n    scene.initialGui = scene.stateManager.addGuiCanvas()\n\n    /* ======= Debug mode ======= */\n    if ((typeof window.DEBUG_MODE_ONE !== 'undefined') && (window.DEBUG_MODE_ONE === true)) {\n      // canvas.createCanvasProfileInfoCanvas()\n    }\n\n    /* ======== Scene Lifecycle ======== */\n\n    /* --- Resize handler --- */\n    const updateContentFrame = function () {\n      // this refers to the scene here\n      if (customSized) {\n        this.initialCanvas.resizeAt = this.parentTaskObject.timeInMs + 1000\n        delay(1000).then(() => {\n          if ((this.parentTaskObject.timeInMs - this.initialCanvas.lastResize > 100) && (this.initialCanvas.resizeAt < this.parentTaskObject.timeInMs)) {\n            // ((this.parentTaskObject.renderSize.width / 2) - (this.initialCanvas.size.width / 2), (this.parentTaskObject.renderSize.height / 2) - (this.initialCanvas.size.height / 2))\n            this.initialCanvas.lastResize = this.parentTaskObject.timeInMs\n            const { size: customSized } = getCanvasDimensions()\n            debugWarn('scene.updateContentFrame: window has been resized ', customSized)\n            this.initialCanvas.size = customSized\n\n            // check if the user has defined custom resize functions\n            if ((typeof this.onResize !== 'undefined') && (this.onResize !== null)) {\n              if (this.onResize.constructor === Function) {\n                this.onResize = [this.onResize]\n              }\n\n              const context = this.parentTaskObject.context\n              for (const f of this.onResize) {\n                if (f.constructor !== Function) continue\n                f.bind(context)()\n              }\n            }\n          }\n        })\n      }\n    }\n\n\n    scene.updateContentFrame = updateContentFrame\n\n    /**\n     * Custom resize functions called by updateContentFrame. Can be set by the user\n     * to perform scene updates on resize. Can be an array of function or a single function.\n     * @type {!function|array}\n     */\n    scene.onResize = null\n\n    /* Scene update */\n    scene.registerBeforeRender(() => {\n      scene.stateManager.update()\n    })\n\n    return (scene)\n  }\n\n  /* ======= dataManager ======= */\n  setConnection(variables = mandatory()) {\n    if (!this.dataManager) {\n      throw new Error('StateManager.setCheckpoint: no dataManager')\n    }\n\n    return this.dataManager.setConnection(variables)\n    .then((connection) => {\n      this.connection = connection\n      return connection\n    })\n    .catch((error) => { debugError(error) })\n  }\n\n  setCheckpoint(code = mandatory(), message = '') {\n    // store the whole object in the db ? ... probably not or.. ? it might be a great idea\n    // we need to save the current state name, the non object globals,\n    // and the events in store, we also have to store the state globals\n    // to restore we load the past state.. .hm might be too complicated\n\n    if (!this.dataManager) {\n      throw new Error('StateManager.setCheckpoint: no dataManager')\n    }\n\n    return this.dataManager.addRows('checkpoints', { code, happenedAt: this.timeInMs, message })\n  }\n\n  getCheckpoint() {\n    if (!this.dataManager) {\n      throw new Error('StateManager.getCheckpoint: no dataManager')\n    }\n\n    return this.dataManager.query('getCheckpoint', {}, this.connection)\n  }\n\n  /* ======= Context ======= */\n  getContext(object) {\n    const scene = (typeof this.currentSceneObject !== 'undefined') ? this.currentSceneObject : null\n    const stateManager = ((scene !== null) && (typeof scene.stateManager !== 'undefined')) ? scene.stateManager : null\n    const state = ((stateManager !== null) && (typeof stateManager.currentState !== 'undefined')) ? this.currentSceneObject.stateManager.currentState : null\n\n    const baseContext = {\n      taskObject: this,\n      dataManager: (typeof this.dataManager !== 'undefined') ? this.dataManager : null,\n      scene,\n      stateManager,\n      state,\n      connection: this.connection,\n      R: this.R,\n    }\n\n    if (typeof object === 'undefined') {\n      return (baseContext)\n    }\n    let extendWith = {}\n    switch (object.constructor) {\n      case BABYLON.Scene:\n        extendWith = {\n          scene: object,\n          stateManager: object.stateManager,\n          state: object.stateManager.currentState,\n        }\n        break\n      case StateManager:\n        extendWith = {\n          scene: object._parent,\n          stateManager: object,\n          state: object.currentState,\n        }\n        break\n      case State:\n        extendWith = {\n          scene: object._parent,\n          stateManager: object._stateManager,\n          state: object,\n        }\n        break\n      default:\n        debugWarn('TaskObject.getContext: object is not of valid class. Returning taskObject context.')\n        return (baseContext)\n    }\n\n    return (_.extend(baseContext, extendWith))\n  }\n\n  get context() {\n    return this.getContext()\n  }\n\n  /* =============== Getters and Setters =============== */\n  /* ======== Property definitions for JSDOC ======== */\n  /**\n   * Key string of the current scene - should not be null but an empty string on startup\n   * @return {string} sceneKey in the scenes object\n   */\n  static get currentScene() { /**/ }\n\n  /**\n   * The current babylon scene object\n   * @return {BABYLON.Scene}\n   */\n  static get currentSceneObject() { /**/ }\n\n  /**\n   * ParamBox object linked to the task object.\n   * @return {ParamBox}\n   */\n  static get paramBox() { /**/ }\n\n  static get renderSize() { /**/ }\n\n  /* ======== Getter/Setter definitions ======== */\n  get currentScene() {\n    return this._currentSceneKey\n  }\n\n  set currentScene(sceneKey) {\n    if (Object.keys(this.scenes).indexOf(sceneKey) !== -1) {\n      if (this._currentSceneKey) {\n        this.scenes[this._currentSceneKey].stateManager.goToState(this.R.get.states_idle)\n\n        /* ======= Debug mode ======= */\n        if ((typeof window.DEBUG_MODE_ONE !== 'undefined') && (window.DEBUG_MODE_ONE === true)) {\n          this.scenes[this._currentSceneKey].debugLayer.hide()\n\n          if ((typeof this.scenes[this._currentSceneKey].initialCanvas !== 'undefined') && (this.scenes[this._currentSceneKey].initialCanvas._profilingCanvas !== null)) {\n            // this.scenes[this._currentSceneKey].initialCanvas._profilingCanvas.dispose()\n            // this.scenes[this._currentSceneKey].initialCanvas._profilingCanvas = null\n          }\n        }\n      }\n\n      this._currentSceneKey = sceneKey\n\n      this.scenes[sceneKey].stateManager.goToState(this.R.get.states_active)\n\n      /* ======= Debug mode ======= */\n      if ((typeof window.DEBUG_MODE_ONE !== 'undefined') && (window.DEBUG_MODE_ONE === true) && (this.shouldShowDebug)) {\n        this.scenes[sceneKey].debugLayer.show()\n\n        if (typeof this.scenes[sceneKey].initialCanvas !== 'undefined') {\n          // this.scenes[sceneKey].initialCanvas.createCanvasProfileInfoCanvas()\n        }\n      }\n\n      debuglog(`TaskObject.currentScene: changed to ${sceneKey}`)\n    } else if (sceneKey === null || sceneKey === '') {\n      this._currentSceneKey = ''\n    } else {\n      console.error('TaskObject.currentScene: Invalid sceneKey.')\n    }\n  }\n\n  toggleDebugLayer() {\n    const scene = this.currentSceneObject\n    this.shouldShowDebug = !this.shouldShowDebug\n\n    if (typeof scene !== 'undefined') {\n      if (this.shouldShowDebug) {\n        this.scenes[this._currentSceneKey].debugLayer.show()\n\n        if (typeof this.scenes[this._currentSceneKey].initialCanvas !== 'undefined') {\n          this.scenes[this._currentSceneKey].initialCanvas.createCanvasProfileInfoCanvas()\n        }\n      } else {\n        this.scenes[this._currentSceneKey].debugLayer.hide()\n\n        if ((typeof this.scenes[this._currentSceneKey].initialCanvas !== 'undefined') && (this.scenes[this._currentSceneKey].initialCanvas._profilingCanvas !== null)) {\n          this.scenes[this._currentSceneKey].initialCanvas._profilingCanvas.dispose()\n          this.scenes[this._currentSceneKey].initialCanvas._profilingCanvas = null\n        }\n      }\n    } else {\n      console.error('taskObject.toggleDebugLayer: currentSceneObject is undefined')\n    }\n  }\n\n  get currentSceneObject() {\n    return this.scenes[this._currentSceneKey]\n  }\n\n  set currentSceneObject(sceneObject) {\n    if (_.has(sceneObject, 'sceneKey')) {\n      this.currentScene = sceneObject.sceneKey\n    } else {\n      throw new Error('Specified scene has no sceneKey')\n    }\n  }\n\n  get time() {\n    return this.timeInMs\n  }\n\n  get timeInSec() {\n    return new Date().getTime() / 1000\n  }\n\n  get timeInMs() {\n    return new Date().getTime()\n  }\n\n  get paramBox() {\n    return this._paramBox\n  }\n\n  set paramBox(paramBox) {\n    if (this._paramBox) {\n      this._paramBox.delete()\n    }\n    this._paramBox = paramBox\n  }\n\n  get renderSize() {\n    return new BABYLON.Size(\n      this.engine.getRenderWidth(),\n      this.engine.getRenderHeight(),\n    )\n  }\n\n  set renderSize(size = mandatory()) {\n    switch (size.constructor) {\n      case String:\n        this.canvas.width = size\n        this.canvas.height = size\n        break\n      case BABYLON.Size:\n        this.canvas.width = `${size.width}px`\n        this.canvas.height = `${size.height}px`\n        break\n      case Array:\n        if (size.length === 2) {\n          this.canvas.width = size[0]\n          this.canvas.height = size[1]\n        } else {\n          throw new Error(\n          'TaskObject.renderSize: set with invalid size array, array lenght has to be === 2.',\n        )\n        }\n        break\n      default:\n        throw new Error(\n        'TaskObject.renderSize: set with invalid size array, array lenght has to be === 2.',\n      )\n    }\n  }\n\n  /* =============== Utility Functions =============== */\n\n  /**\n   * modal - Creates a new information modal with specified data.\n   *\n   * @param {!object} options\n   *\n   * @returns {type} Description\n   */\n  modal({ type = 'centralLarge', title = '', content = '', event = new EventData(this.R.get.events_modalDismissed) }) {\n    this.dismissModal()\n    this.currentModal = { data: { type, title, content, event } }\n    const deferred = new Deferred()\n\n    this.currentModal.deferred = deferred\n\n    const modalBox = new SmartModal(type, function dismissed() {\n      if ((event.constructor === EventData) && (this.stateManager !== null)) {\n        event.happenedAt = this.stateManager.timeInMs\n        this.stateManager.addEvent(event)\n      }\n\n      this.taskObject.currentModal.deferred.resolve('Modal closed.')\n      this.taskObject.currentModal = null\n    }.bind(this.context))\n\n    modalBox.title = title\n    modalBox.content = content\n\n    this.currentModal.modalBox = modalBox\n    return deferred.promise\n  }\n\n  dismissModal() {\n    if ((this.currentModal !== null) && (hasConstructor(SmartModal, this.currentModal.modalBox))) {\n      this.currentModal.modalBox.callThenDestroy()\n      this.currentModal = null\n    }\n  }\n\n  /* === Animation helpers === */\n  animateFloat(object, property, from, to) {\n    const keys = [{\n      frame: 0,\n      value: from,\n    }, {\n      frame: 100,\n      value: to,\n    }]\n\n    const animation = new BABYLON.Animation(\n      'animation',\n      property,\n      100,\n      BABYLON.Animation.ANIMATIONTYPE_FLOAT,\n      BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT,\n    )\n    animation.setKeys(keys)\n\n    this.currentSceneObject.stopAnimation(object)\n    object.animations.push(animation)\n    object._scene.beginAnimation(object, 0, 100, false, 1, () => {})\n  }\n\n  animateVector3(object, property, from, to, frameTotal = 24) {\n    const keys = [{\n      frame: 0,\n      value: from,\n    }, {\n      frame: frameTotal,\n      value: to,\n    }]\n\n    const animation = new BABYLON.Animation(\n      'animation',\n      property,\n      24,\n      BABYLON.Animation.ANIMATIONTYPE_VECTOR3,\n      BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT,\n    )\n    animation.setKeys(keys)\n\n    this.currentSceneObject.stopAnimation(object)\n\n    object.animations.push(animation)\n  }\n\n  animateColor3(object, property, from, to) {\n    const keys = [{\n      frame: 0,\n      value: from,\n    }, {\n      frame: 24,\n      value: to,\n    }]\n\n    const animation = new BABYLON.Animation(\n      'animation',\n      property,\n      12,\n      BABYLON.Animation.ANIMATIONTYPE_COLOR3,\n      BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT,\n    )\n    animation.setKeys(keys)\n\n    object._scene.stopAnimation(object)\n\n    object.animations.push(animation)\n  }\n\n  animateMainCameraRotation(toAlpha, toBeta, scene) {\n    // Alpha is the rotation angle around Y axis = azimuth\n    // Beta is the rotation angle around X axis = inclinaison\n    scene = this.scenes[this.currentScene]\n    const animCamAlpha = new BABYLON.Animation(\n      'animCam',\n      'alpha',\n      60,\n      BABYLON.Animation.ANIMATIONTYPE_FLOAT,\n      BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT,\n    )\n    const camera = scene.activeCamera\n    const keysAlpha = []\n\n    if (TaskObject.overPI(camera.alpha, toAlpha)) {\n      keysAlpha.push({\n        frame: 0,\n        value: camera.alpha,\n      })\n\n      console.log(camera.alpha)\n      console.log(toAlpha)\n\n      let firstStop = -Math.PI\n      let secondStop = Math.PI\n\n      if (camera.alpha > 0) {\n        firstStop = Math.PI\n        secondStop = -Math.PI\n      }\n\n      keysAlpha.push({\n        frame: 50,\n        value: firstStop,\n      })\n      keysAlpha.push({\n        frame: 51,\n        value: secondStop,\n      })\n      keysAlpha.push({\n        frame: 100,\n        value: toAlpha,\n      })\n    } else {\n      keysAlpha.push({\n        frame: 0,\n        value: camera.alpha,\n      })\n      keysAlpha.push({\n        frame: 100,\n        value: toAlpha,\n      })\n    }\n\n    const animCamBeta = new BABYLON.Animation(\n      'animCam',\n      'beta',\n      60,\n      BABYLON.Animation.ANIMATIONTYPE_FLOAT,\n      BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT,\n    )\n\n    const keysBeta = []\n    keysBeta.push({\n      frame: 0,\n      value: camera.beta,\n    })\n    keysBeta.push({\n      frame: 100,\n      value: toBeta,\n    })\n\n    animCamAlpha.setKeys(keysAlpha)\n    animCamBeta.setKeys(keysBeta)\n\n    camera.animations.push(animCamAlpha)\n    camera.animations.push(animCamBeta)\n\n    scene.beginAnimation(camera, 0, 100, false, 1, () => {})\n  }\n\n  /* === Particule system === */\n  /**\n   * Add a custom particule system to the specified mesh.\n   * @param {BABYLON.Mesh} mesh    Mesh on which to add the particule system\n   * @param {Object} options Option object, default properties are as follows :\n   *                         name: \"particle\" + mesh.name,\n   *                         capacity: 2000,\n   *                         texture: this.ASSETS_FLARE_PATH,\n   *                         minEmitBox: null,\n   *                         maxEmitBox: null,\n   *                         color1: new BABYLON.Color4(0.7, 0.8, 1.0, 1.0),\n   *                         color2: new BABYLON.Color4(0.2, 0.5, 1.0, 1.0),\n   *                         colorDead: new BABYLON.Color4(0, 0, 0.2, 0.0),\n   *                         minSize: 0.1,\n   *                         maxSize: 0.5,\n   *                         minLifeTime: 0.3,\n   *                         maxLifeTime: 0.8,\n   *                         emitRate: 150,\n   *                         blendMode: BABYLON.ParticleSystem.BLENDMODE_ONEONE,\n   *                         gravity: new BABYLON.Vector3(0, 9.81, 0), //upwards\n   *                         direction1: new BABYLON.Vector3(-5, -1, 3),\n   *                         direction2: new BABYLON.Vector3(5, 1, -3),\n   *                         minAngularSpeed: 0,\n   *                         maxAngularSpeed: 2 * Math.PI,\n   *                         minEmitPower: 0.1,\n   *                         maxEmitPower: 0.1,\n   *                         updateSpeed: 0.01,\n   *                         startIt: false\n   */\n  addParticuleSystemTo(mesh = mandatory(), options = {}) {\n    if (typeof mesh._scene === 'undefined') {\n      throw new Error('addParticuleSystemTo: mesh _scene is undefined.')\n    }\n\n    const scene = mesh._scene\n\n    // option base\n    const optionsBase = {\n      name: `particle${mesh.name}`,\n      capacity: 2000,\n      texture: this.ASSETS_FLARE_PATH,\n      minEmitBox: null,\n      maxEmitBox: null,\n      color1: new BABYLON.Color4(0.7, 0.8, 1, 1),\n      color2: new BABYLON.Color4(0.2, 0.5, 1, 1),\n      colorDead: new BABYLON.Color4(0, 0, 0.2, 0),\n      minSize: 0.1,\n      maxSize: 0.5,\n      minLifeTime: 0.3,\n      maxLifeTime: 0.8,\n      emitRate: 150,\n      blendMode: BABYLON.ParticleSystem.BLENDMODE_ONEONE,\n      gravity: new BABYLON.Vector3(0, 9.81, 0),\n      // upwards\n      direction1: new BABYLON.Vector3(-5, -1, 3),\n      direction2: new BABYLON.Vector3(5, 1, -3),\n      minAngularSpeed: 0,\n      maxAngularSpeed: 2 * Math.PI,\n      minEmitPower: 0.1,\n      maxEmitPower: 0.1,\n      updateSpeed: 0.01,\n      startIt: false,\n    }\n\n    // extend base options with specified options\n    options = _.extend(optionsBase, options)\n\n    // Create a particle system\n    const particleSystem = new BABYLON.ParticleSystem(\n      'particles',\n      options.capacity,\n      scene,\n    )\n\n    // Texture of each particle\n    particleSystem.particleTexture = new BABYLON.Texture(\n      options.texture,\n      scene,\n    )\n\n    // Where the particles come from\n    particleSystem.emitter = mesh\n    // the starting object, the emitter\n    if (options.minEmitBox !== null) {\n      particleSystem.minEmitBox = options.minEmitBox // Starting all from\n    }\n\n    if (options.maxEmitBox !== null) {\n      particleSystem.maxEmitBox = options.maxEmitBox // To...\n    }\n\n    // Colors of all particles\n    particleSystem.color1 = options.color1\n    particleSystem.color2 = options.color2\n    particleSystem.colorDead = options.colorDead\n\n    // Size of each particle (random between...\n    particleSystem.minSize = options.minSize\n    particleSystem.maxSize = options.maxSize\n\n    // Life time of each particle (random between...\n    particleSystem.minLifeTime = options.minLifeTime\n    particleSystem.maxLifeTime = options.maxLifeTime\n\n    // Emission rate\n    particleSystem.emitRate = options.emitRate\n\n    // Blend mode : BLENDMODE_ONEONE, or BLENDMODE_STANDARD\n    particleSystem.blendMode = options.blendMode\n\n    // Set the gravity of all particles\n    particleSystem.gravity = options.gravity\n\n    // Direction of each particle after it has been emitted\n    particleSystem.direction1 = options.direction1\n    particleSystem.direction2 = options.direction2\n\n    // Angular speed, in radians\n    particleSystem.minAngularSpeed = options.minAngularSpeed\n    particleSystem.maxAngularSpeed = options.maxAngularSpeed\n\n    // Speed\n    particleSystem.minEmitPower = options.minEmitPower\n    particleSystem.maxEmitPower = options.maxEmitPower\n    particleSystem.updateSpeed = options.updateSpeed\n\n    // Start the particle system\n    if (options.startIt) {\n      particleSystem.start()\n    }\n\n    return particleSystem\n  }\n\n  /* ======== Static functions ======== */\n  /* === Angle functions === */\n  static borderPI(radians) {\n    const offset = Math.PI\n    radians += offset\n    const sign = Math.sign(radians)\n    return radians -\n      (sign * Math.floor(Math.abs(radians) / (2 * Math.PI)) * (2 * Math.PI)) -\n      offset\n  }\n\n  static checkForCloserSignedAngle(baseAngle, checkedAngle) {\n    checkedAngle = TaskObject.borderPI(checkedAngle)\n    console.log(checkedAngle)\n    console.log(`baseAngle:${baseAngle}`)\n    let sign = Math.sign(checkedAngle)\n\n    if (checkedAngle === 0) {\n      sign = Math.sign(baseAngle)\n    }\n    const signedAngle = checkedAngle - (sign * (2 * Math.PI))\n    console.log(`signedAngle:${signedAngle}`)\n    const currentAngleArc = Math.abs(baseAngle - checkedAngle)\n    const signedAngleArc = Math.abs(baseAngle - signedAngle)\n\n    return currentAngleArc <= signedAngleArc ? checkedAngle : signedAngle\n  }\n\n  static overPI(angleA, angleB) {\n    return Math.abs(angleA - angleB) > Math.PI\n  }\n\n  /* === Sound function === */\n  /**\n   * fadeOut - Performs a fadeOut of a BABYLON.Sound recursively. When the decrement\n   * become smaller than step/10, decrement is fixed at step/10.\n   *\n   * @param {BABYLON.Sound}      sound                        a sound to fade out and stop\n   * @param {object}    options                      second argument holds options\n   * @param {?Number}   [options.currentVolume=null] start volume for the fadeout\n   * @param {number}    [options.step=0.02]          decrement step such as volume -= step * volume\n   * @param {number}    [options.threshold=0.02]     threshold at which the sound is stopped\n   * @param {number}    [options.delayInMs=50]       duration of each recursion\n   * @param {boolean}   [options.pause=false]        if setto true the sound is pauses, if false, it is stopped\n   *\n   * @returns {undefined}\n   */\n  static fadeOut(sound, { currentVolume = null, step = 0.02, threshold = 0.02, delayInMs = 50, pause = false } = {}) {\n    mustHaveConstructor(BABYLON.Sound, sound)\n\n    if (currentVolume === null) {\n      currentVolume = sound.getVolume()\n    }\n    mustHaveConstructor(Number, currentVolume, step, threshold)\n\n    currentVolume = currentVolume.boundTo(0, 1)\n    step = step.boundTo(0, 1)\n\n    let decrement = step * currentVolume\n    if (decrement < step / 10) {\n      decrement = step / 10\n    }\n    currentVolume -= decrement\n    if (currentVolume > threshold) {\n      debuglog(`fadeOut.currentVolume:${currentVolume}`)\n      sound.setVolume(currentVolume)\n      delay(delayInMs).then(() => TaskObject.fadeOut(sound, { currentVolume, step, threshold, delayInMs, pause }))\n    } else if (pause) {\n      debuglog('fadeOut:  pause')\n      sound.pause()\n    } else {\n      debuglog('fadeOut:  stop')\n      sound.stop()\n    }\n  }\n\n\n  /**\n   * Returns an array filled with len elements of value\n   * @param  {object} value any value\n   * @param  {number} len   number of element repeated\n   * @return {array}\n   */\n  static fillArray(value, len) {\n    const a = []\n    for (let i = 1; i <= len; i++) {\n      a.push(value)\n    }\n    return a\n  }\n\n  /**\n   * Transform spherical coordinate to euclidian coordinate taking y as the height axis and z the depth axis.\n   * Inclination is calculated from the y axis and azimuth from the z axis. Supposing both system have the same origin.\n   * https://en.wikipedia.org/wiki/Spherical_coordinate_system\n   * @param  {number} r           radius\n   * @param  {number} inclination inclination from y in radian\n   * @param  {number} azimuth     Azimuthal angle\n   * @return {BABYLON.Vector3}    Euclidian coordinate\n   */\n  static sphericalToEuclidian(r, inclination, azimuth) {\n    const z = r * Math.sin(inclination) * Math.cos(azimuth)\n    const x = r * Math.sin(inclination) * Math.sin(azimuth)\n    const y = r * Math.cos(inclination)\n\n    return new BABYLON.Vector3(x, y, z)\n  }\n\n  /**\n   * Get random number between min and max.\n   * @param  {Number} min\n   * @param  {Number} max\n   * @return {Number}\n   */\n  static getRandomArbitrary(min, max) {\n    return ((Math.random() * (max - min)) + min)\n  }\n\n  static getRandomElement(array = mandatory()) {\n    if (array.constructor === Array) {\n      return array[Math.round(\n        TaskObject.getRandomArbitrary(0, array.length - 1),\n      )]\n    }\n    throw new Error('TaskObject: argument is not of type array.')\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/framework/TaskObject.js","import _ from 'lodash'\nimport BABYLON from 'experiment-babylon-js'\n\n\nimport { hasConstructor, Number, debugError } from '../utilities'\n\nclass Loader extends BABYLON.Rectangle2D {\n  constructor(options) {\n    const baseOptions = {\n      id: 'loader',\n      parent: null,\n      roundRadius: 0,\n      size: new BABYLON.Size(20, 20),\n      borderThickness: 1,\n      border: BABYLON.Canvas2D.GetSolidColorBrush(new BABYLON.Color4(1, 1, 1, 1)),\n      fill: null,\n      marginAlignment: 'h: center, v: center',\n      zOrder: 0.01,\n      value: 0,\n      type: 'multi',\n      centered: true,\n    }\n\n    options = _.extend(baseOptions, options)\n    super(options)\n    this.options = options\n\n    // let borderThickness = options.borderThickness\n    // if (options.marginAlignment === null) {\n\n    // }\n\n    if (this.options.type === 'anticlock') {\n      // create masks\n      const borderThickness = options.borderThickness + 2\n      const fill = BABYLON.Canvas2D.GetSolidColorBrush(new BABYLON.Color4(0, 0, 0, 1))\n      const masks = {}\n      masks.bottom = new BABYLON.Rectangle2D({\n        parent: this,\n        id: 'loaderMaskBottom',\n        marginAlignment: 'h: center, v: center',\n        size: new BABYLON.Size(options.size.width, borderThickness),\n        fill,\n        zOrder: 0.001,\n      })\n      masks.right = new BABYLON.Rectangle2D({\n        parent: this,\n        id: 'loaderMaskRight',\n        marginAlignment: 'h: center, v: center',\n        size: new BABYLON.Size(borderThickness, options.size.height),\n        fill,\n        zOrder: 0.002,\n      })\n      masks.top = new BABYLON.Rectangle2D({\n        parent: this,\n        id: 'loaderMaskTop',\n        marginAlignment: 'h: center, v: center',\n        size: new BABYLON.Size(options.size.width, borderThickness),\n        fill,\n        zOrder: 0.003,\n      })\n      masks.left = new BABYLON.Rectangle2D({\n        parent: this,\n        id: 'loaderMaskLeft',\n        marginAlignment: 'h: center, v: center',\n        size: new BABYLON.Size(borderThickness, options.size.height),\n        fill,\n        zOrder: 0.004,\n      })\n\n      this.masks = masks\n    } else if (this.options.type === 'multi') {\n      this.borderThickness = 0\n      this.fill = null\n      this.drawRectangles()\n    }\n\n    this._value = options.value\n    this.lastUpdatedValue = this._value\n    this.update()\n  }\n\n  update() {\n    if (this.options.type === 'anticlock') {\n      this.updateMasks()\n    } else if (this.options.type === 'multi') {\n      this.updateRectangles()\n    }\n  }\n\n  updateRectangles() {\n    if (this.options.type === 'multi') {\n      if (this.value < this.lastUpdatedValue) { // TODO weird bug due to canvas2D again... cannot reduce the size of a Rectangle2D...\n        this.drawRectangles()\n      }\n      this.lastUpdatedValue = this.value\n\n      const fullWeight = Math.floor(this.value / 4)\n      const residual = this.value % 4\n\n      const residualBottom = residual > 0 ? 1 : 0\n      const residualTop = residual > 2 ? 1 : 0\n      const residualLeft = residual > 1 ? 1 : 0\n\n      this.rectangles.bottom.width = (fullWeight + residualBottom) * (this.size.width / 25)\n      this.rectangles.left.height = (fullWeight + residualLeft) * (this.size.height / 25)\n      this.rectangles.right.height = (fullWeight) * (this.size.height / 25)\n      this.rectangles.top.width = (fullWeight + residualTop) * (this.size.width / 25)\n    }\n  }\n\n  drawRectangles() {\n    if (hasConstructor(Object, this.rectangles) && this.rectangles.hasOwnProperty('bottom') && hasConstructor(BABYLON.Rectangle2D, this.rectangles.bottom)) {\n      for (const rectangle in this.rectangles) {\n        if (this.rectangles.hasOwnProperty(rectangle)) {\n          if (typeof this.rectangles[rectangle].dispose === 'function') { this.rectangles[rectangle].dispose() }\n        }\n      }\n    }\n    this.rectangles = {}\n    // create masks\n    const borderThickness = this.options.borderThickness\n    const fill = this.options.border\n    this.rectangles.bottom = new BABYLON.Rectangle2D({\n      parent: this,\n      id: 'loaderRectangleBottom',\n      marginAlignment: this.options.centered ? 'h: center, v: center' : 'h: left, v: bottom',\n      size: new BABYLON.Size(0, borderThickness),\n      fill,\n      zOrder: 0.001,\n    })\n    this.rectangles.right = new BABYLON.Rectangle2D({\n      parent: this,\n      id: 'loaderRectangleRight',\n      marginAlignment: this.options.centered ? 'h: center, v: center' : 'h: right, v: top',\n      size: new BABYLON.Size(borderThickness, 0),\n      fill,\n      zOrder: 0.002,\n    })\n    this.rectangles.top = new BABYLON.Rectangle2D({\n      parent: this,\n      id: 'loaderRectangleTop',\n      marginAlignment: this.options.centered ? 'h: center, v: center' : 'h: right, v: top',\n      size: new BABYLON.Size(0, borderThickness),\n      fill,\n      zOrder: 0.003,\n    })\n    this.rectangles.left = new BABYLON.Rectangle2D({\n      parent: this,\n      id: 'loaderRectangleLeft',\n      marginAlignment: this.options.centered ? 'h: center, v: center' : 'h: left, v: bottom',\n      size: new BABYLON.Size(borderThickness, 0),\n      fill,\n      zOrder: 0.004,\n    })\n\n    if (this.options.centered) {\n      // const baseMargin = { rightPixels: 0, leftPixels: 0, topPixels: 0, bottomPixels: 0}\n      _.extend(this.rectangles.left.margin, { rightPixels: (this.size.width / 2) - (borderThickness / 2) })\n      _.extend(this.rectangles.right.margin, { leftPixels: (this.size.width / 2) - (borderThickness / 2) })\n      _.extend(this.rectangles.top.margin, { bottomPixels: (this.size.height / 2) - (borderThickness / 2) })\n      _.extend(this.rectangles.bottom.margin, { topPixels: (this.size.height / 2) - (borderThickness / 2) })\n    }\n  }\n\n  updateMasks() {\n    if (this.options.type === 'anticlock') {\n      const value = this.value\n      if (value < 25) {\n        this.masks.bottom.width = (25 - value) * (this.size.width / 25)\n\n        const offset = this.size.width - this.masks.bottom.width // (12.5 - value) * (this.size.width / (2 * 12.5))\n        this.masks.bottom.margin.rightPixels = 0\n        this.masks.bottom.margin.leftPixels = offset / 2\n        this.masks.bottom.margin.topPixels = (this.size.height / 2) - (this.borderThickness / 2)\n        this.masks.bottom.margin.bottomPixels = 0\n        this.masks.bottom.levelVisible = true\n      } else {\n        this.masks.bottom.levelVisible = false\n      }\n\n      if (value < 50) {\n        const height = (value >= 25) ? (50 - value) * (this.size.height / 25) : this.size.height\n        this.masks.right.height = height\n        const offset = this.size.height - height\n\n        this.masks.right.margin.rightPixels = 0\n        this.masks.right.margin.leftPixels = (this.size.width / 2) - (this.borderThickness / 2)\n        this.masks.right.margin.topPixels = 0\n        this.masks.right.margin.bottomPixels = offset / 2\n\n        this.masks.right.levelVisible = true\n      } else {\n        this.masks.right.levelVisible = false\n      }\n\n      if (value < 75) {\n        const width = (value >= 50) ? (75 - value) * (this.size.width / 25) : this.size.width\n\n        this.masks.top.width = width\n        const offset = this.size.width - width + (this.borderThickness)\n\n        this.masks.top.margin.rightPixels = offset / 2\n        this.masks.top.margin.leftPixels = 0\n        this.masks.top.margin.topPixels = 0\n        this.masks.top.margin.bottomPixels = (this.size.height / 2) - (this.borderThickness / 2)\n\n        this.masks.top.levelVisible = true\n      } else {\n        this.masks.top.levelVisible = false\n      }\n\n      if (value < 100) {\n        const height = (value >= 75) ? (100 - value) * (this.size.height / 25) : this.size.height\n\n        this.masks.left.height = height\n        const offset = this.size.height - height + (this.borderThickness)\n\n        this.masks.left.margin.rightPixels = (this.size.width / 2) - (this.borderThickness / 2)\n        this.masks.left.margin.leftPixels = 0\n        this.masks.left.margin.topPixels = offset / 2\n        this.masks.left.margin.bottomPixels = 0\n\n        this.masks.left.levelVisible = true\n      } else {\n        this.masks.left.levelVisible = false\n      }\n    }\n  }\n\n  set value(val = 0) {\n    if (hasConstructor(Number, val)) {\n      val = val.boundTo(0, 100)\n      this._value = val\n      this.update()\n    } else {\n      debugError('Loader.value: invalid value')\n    }\n  }\n\n  get value() {\n    return this._value\n  }\n}\n\nexport default Loader\n\n\n\n// WEBPACK FOOTER //\n// ./src/framework/objects/Loader.js","/**\n * Experiment.js\n * Created. 2016\n *\n * Experiment.js toolbox.\n *\n * Authors. Albert Buchard\n *\n * Requires: lodash, BABYLON.js, mathjs, jQuery\n *\n * LICENSE Apache-2\n */\n\n /* --- Import the framwork --- */\n import TaskObject from './src/framework/TaskObject'\n import StateManager from './src/framework/StateManager'\n import State from './src/framework/State'\n import EventData from './src/framework/EventData'\n import DataManager from './src/framework/DataManager'\n import RessourceManager from './src/framework/RessourceManager'\n\n import Loader from './src/framework/objects/Loader'\n\n import {\n   Array,\n   String,\n   Number,\n   Set,\n   diag,\n   rowSum,\n   getRow,\n   matrix,\n   samplePermutation,\n   rep,\n   Deferred,\n   recurse,\n   jitter,\n   delay,\n   looksLikeAPromise,\n   mustHaveConstructor,\n   mustBeDefined,\n   mandatory,\n   debuglog,\n   debugWarn,\n   debugError,\n   noop,\n   spreadToObject,\n   sizeToVec,\n   scaleSize,\n   hasConstructor,\n   preloadImages,\n   getQueryString,\n } from './src/framework/utilities'\n\n\n/* add it to the global space in case user want to import in a script tag */\n if (typeof window !== 'undefined') {\n   window.TaskObject = TaskObject\n   window.StateManager = StateManager\n   window.State = State\n   window.EventData = EventData\n   window.DataManager = DataManager\n   window.RessourceManager = RessourceManager\n   window.jitter = jitter\n   window.delay = delay\n   window.Deferred = Deferred\n }\n\n\n export {\n  TaskObject,\n  StateManager,\n  State,\n  EventData,\n  DataManager,\n  RessourceManager,\n  Array,\n  String,\n  Number,\n  Set,\n  diag,\n  rowSum,\n  getRow,\n  matrix,\n  samplePermutation,\n  rep,\n  Deferred,\n  recurse,\n  jitter,\n  delay,\n  looksLikeAPromise,\n  mustHaveConstructor,\n  mustBeDefined,\n  mandatory,\n  debuglog,\n  debugWarn,\n  debugError,\n  noop,\n  spreadToObject,\n  sizeToVec,\n  scaleSize,\n  hasConstructor,\n  preloadImages,\n  Loader,\n  getQueryString,\n}\n\n\n\n// WEBPACK FOOTER //\n// ./builder.js","const DEBUG_MODE_ON = true\n\nexport { DEBUG_MODE_ON }\n\n\n\n// WEBPACK FOOTER //\n// ./src/config.js","/* js-yaml 3.8.4 https://github.com/nodeca/js-yaml */(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.jsyaml = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\n\nvar loader = require('./js-yaml/loader');\nvar dumper = require('./js-yaml/dumper');\n\n\nfunction deprecated(name) {\n  return function () {\n    throw new Error('Function ' + name + ' is deprecated and cannot be used.');\n  };\n}\n\n\nmodule.exports.Type                = require('./js-yaml/type');\nmodule.exports.Schema              = require('./js-yaml/schema');\nmodule.exports.FAILSAFE_SCHEMA     = require('./js-yaml/schema/failsafe');\nmodule.exports.JSON_SCHEMA         = require('./js-yaml/schema/json');\nmodule.exports.CORE_SCHEMA         = require('./js-yaml/schema/core');\nmodule.exports.DEFAULT_SAFE_SCHEMA = require('./js-yaml/schema/default_safe');\nmodule.exports.DEFAULT_FULL_SCHEMA = require('./js-yaml/schema/default_full');\nmodule.exports.load                = loader.load;\nmodule.exports.loadAll             = loader.loadAll;\nmodule.exports.safeLoad            = loader.safeLoad;\nmodule.exports.safeLoadAll         = loader.safeLoadAll;\nmodule.exports.dump                = dumper.dump;\nmodule.exports.safeDump            = dumper.safeDump;\nmodule.exports.YAMLException       = require('./js-yaml/exception');\n\n// Deprecated schema names from JS-YAML 2.0.x\nmodule.exports.MINIMAL_SCHEMA = require('./js-yaml/schema/failsafe');\nmodule.exports.SAFE_SCHEMA    = require('./js-yaml/schema/default_safe');\nmodule.exports.DEFAULT_SCHEMA = require('./js-yaml/schema/default_full');\n\n// Deprecated functions from JS-YAML 1.x.x\nmodule.exports.scan           = deprecated('scan');\nmodule.exports.parse          = deprecated('parse');\nmodule.exports.compose        = deprecated('compose');\nmodule.exports.addConstructor = deprecated('addConstructor');\n\n},{\"./js-yaml/dumper\":3,\"./js-yaml/exception\":4,\"./js-yaml/loader\":5,\"./js-yaml/schema\":7,\"./js-yaml/schema/core\":8,\"./js-yaml/schema/default_full\":9,\"./js-yaml/schema/default_safe\":10,\"./js-yaml/schema/failsafe\":11,\"./js-yaml/schema/json\":12,\"./js-yaml/type\":13}],2:[function(require,module,exports){\n'use strict';\n\n\nfunction isNothing(subject) {\n  return (typeof subject === 'undefined') || (subject === null);\n}\n\n\nfunction isObject(subject) {\n  return (typeof subject === 'object') && (subject !== null);\n}\n\n\nfunction toArray(sequence) {\n  if (Array.isArray(sequence)) return sequence;\n  else if (isNothing(sequence)) return [];\n\n  return [ sequence ];\n}\n\n\nfunction extend(target, source) {\n  var index, length, key, sourceKeys;\n\n  if (source) {\n    sourceKeys = Object.keys(source);\n\n    for (index = 0, length = sourceKeys.length; index < length; index += 1) {\n      key = sourceKeys[index];\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\n\nfunction repeat(string, count) {\n  var result = '', cycle;\n\n  for (cycle = 0; cycle < count; cycle += 1) {\n    result += string;\n  }\n\n  return result;\n}\n\n\nfunction isNegativeZero(number) {\n  return (number === 0) && (Number.NEGATIVE_INFINITY === 1 / number);\n}\n\n\nmodule.exports.isNothing      = isNothing;\nmodule.exports.isObject       = isObject;\nmodule.exports.toArray        = toArray;\nmodule.exports.repeat         = repeat;\nmodule.exports.isNegativeZero = isNegativeZero;\nmodule.exports.extend         = extend;\n\n},{}],3:[function(require,module,exports){\n'use strict';\n\n/*eslint-disable no-use-before-define*/\n\nvar common              = require('./common');\nvar YAMLException       = require('./exception');\nvar DEFAULT_FULL_SCHEMA = require('./schema/default_full');\nvar DEFAULT_SAFE_SCHEMA = require('./schema/default_safe');\n\nvar _toString       = Object.prototype.toString;\nvar _hasOwnProperty = Object.prototype.hasOwnProperty;\n\nvar CHAR_TAB                  = 0x09; /* Tab */\nvar CHAR_LINE_FEED            = 0x0A; /* LF */\nvar CHAR_SPACE                = 0x20; /* Space */\nvar CHAR_EXCLAMATION          = 0x21; /* ! */\nvar CHAR_DOUBLE_QUOTE         = 0x22; /* \" */\nvar CHAR_SHARP                = 0x23; /* # */\nvar CHAR_PERCENT              = 0x25; /* % */\nvar CHAR_AMPERSAND            = 0x26; /* & */\nvar CHAR_SINGLE_QUOTE         = 0x27; /* ' */\nvar CHAR_ASTERISK             = 0x2A; /* * */\nvar CHAR_COMMA                = 0x2C; /* , */\nvar CHAR_MINUS                = 0x2D; /* - */\nvar CHAR_COLON                = 0x3A; /* : */\nvar CHAR_GREATER_THAN         = 0x3E; /* > */\nvar CHAR_QUESTION             = 0x3F; /* ? */\nvar CHAR_COMMERCIAL_AT        = 0x40; /* @ */\nvar CHAR_LEFT_SQUARE_BRACKET  = 0x5B; /* [ */\nvar CHAR_RIGHT_SQUARE_BRACKET = 0x5D; /* ] */\nvar CHAR_GRAVE_ACCENT         = 0x60; /* ` */\nvar CHAR_LEFT_CURLY_BRACKET   = 0x7B; /* { */\nvar CHAR_VERTICAL_LINE        = 0x7C; /* | */\nvar CHAR_RIGHT_CURLY_BRACKET  = 0x7D; /* } */\n\nvar ESCAPE_SEQUENCES = {};\n\nESCAPE_SEQUENCES[0x00]   = '\\\\0';\nESCAPE_SEQUENCES[0x07]   = '\\\\a';\nESCAPE_SEQUENCES[0x08]   = '\\\\b';\nESCAPE_SEQUENCES[0x09]   = '\\\\t';\nESCAPE_SEQUENCES[0x0A]   = '\\\\n';\nESCAPE_SEQUENCES[0x0B]   = '\\\\v';\nESCAPE_SEQUENCES[0x0C]   = '\\\\f';\nESCAPE_SEQUENCES[0x0D]   = '\\\\r';\nESCAPE_SEQUENCES[0x1B]   = '\\\\e';\nESCAPE_SEQUENCES[0x22]   = '\\\\\"';\nESCAPE_SEQUENCES[0x5C]   = '\\\\\\\\';\nESCAPE_SEQUENCES[0x85]   = '\\\\N';\nESCAPE_SEQUENCES[0xA0]   = '\\\\_';\nESCAPE_SEQUENCES[0x2028] = '\\\\L';\nESCAPE_SEQUENCES[0x2029] = '\\\\P';\n\nvar DEPRECATED_BOOLEANS_SYNTAX = [\n  'y', 'Y', 'yes', 'Yes', 'YES', 'on', 'On', 'ON',\n  'n', 'N', 'no', 'No', 'NO', 'off', 'Off', 'OFF'\n];\n\nfunction compileStyleMap(schema, map) {\n  var result, keys, index, length, tag, style, type;\n\n  if (map === null) return {};\n\n  result = {};\n  keys = Object.keys(map);\n\n  for (index = 0, length = keys.length; index < length; index += 1) {\n    tag = keys[index];\n    style = String(map[tag]);\n\n    if (tag.slice(0, 2) === '!!') {\n      tag = 'tag:yaml.org,2002:' + tag.slice(2);\n    }\n    type = schema.compiledTypeMap['fallback'][tag];\n\n    if (type && _hasOwnProperty.call(type.styleAliases, style)) {\n      style = type.styleAliases[style];\n    }\n\n    result[tag] = style;\n  }\n\n  return result;\n}\n\nfunction encodeHex(character) {\n  var string, handle, length;\n\n  string = character.toString(16).toUpperCase();\n\n  if (character <= 0xFF) {\n    handle = 'x';\n    length = 2;\n  } else if (character <= 0xFFFF) {\n    handle = 'u';\n    length = 4;\n  } else if (character <= 0xFFFFFFFF) {\n    handle = 'U';\n    length = 8;\n  } else {\n    throw new YAMLException('code point within a string may not be greater than 0xFFFFFFFF');\n  }\n\n  return '\\\\' + handle + common.repeat('0', length - string.length) + string;\n}\n\nfunction State(options) {\n  this.schema       = options['schema'] || DEFAULT_FULL_SCHEMA;\n  this.indent       = Math.max(1, (options['indent'] || 2));\n  this.skipInvalid  = options['skipInvalid'] || false;\n  this.flowLevel    = (common.isNothing(options['flowLevel']) ? -1 : options['flowLevel']);\n  this.styleMap     = compileStyleMap(this.schema, options['styles'] || null);\n  this.sortKeys     = options['sortKeys'] || false;\n  this.lineWidth    = options['lineWidth'] || 80;\n  this.noRefs       = options['noRefs'] || false;\n  this.noCompatMode = options['noCompatMode'] || false;\n\n  this.implicitTypes = this.schema.compiledImplicit;\n  this.explicitTypes = this.schema.compiledExplicit;\n\n  this.tag = null;\n  this.result = '';\n\n  this.duplicates = [];\n  this.usedDuplicates = null;\n}\n\n// Indents every line in a string. Empty lines (\\n only) are not indented.\nfunction indentString(string, spaces) {\n  var ind = common.repeat(' ', spaces),\n      position = 0,\n      next = -1,\n      result = '',\n      line,\n      length = string.length;\n\n  while (position < length) {\n    next = string.indexOf('\\n', position);\n    if (next === -1) {\n      line = string.slice(position);\n      position = length;\n    } else {\n      line = string.slice(position, next + 1);\n      position = next + 1;\n    }\n\n    if (line.length && line !== '\\n') result += ind;\n\n    result += line;\n  }\n\n  return result;\n}\n\nfunction generateNextLine(state, level) {\n  return '\\n' + common.repeat(' ', state.indent * level);\n}\n\nfunction testImplicitResolving(state, str) {\n  var index, length, type;\n\n  for (index = 0, length = state.implicitTypes.length; index < length; index += 1) {\n    type = state.implicitTypes[index];\n\n    if (type.resolve(str)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// [33] s-white ::= s-space | s-tab\nfunction isWhitespace(c) {\n  return c === CHAR_SPACE || c === CHAR_TAB;\n}\n\n// Returns true if the character can be printed without escaping.\n// From YAML 1.2: \"any allowed characters known to be non-printable\n// should also be escaped. [However,] This isnt mandatory\"\n// Derived from nb-char - \\t - #x85 - #xA0 - #x2028 - #x2029.\nfunction isPrintable(c) {\n  return  (0x00020 <= c && c <= 0x00007E)\n      || ((0x000A1 <= c && c <= 0x00D7FF) && c !== 0x2028 && c !== 0x2029)\n      || ((0x0E000 <= c && c <= 0x00FFFD) && c !== 0xFEFF /* BOM */)\n      ||  (0x10000 <= c && c <= 0x10FFFF);\n}\n\n// Simplified test for values allowed after the first character in plain style.\nfunction isPlainSafe(c) {\n  // Uses a subset of nb-char - c-flow-indicator - \":\" - \"#\"\n  // where nb-char ::= c-printable - b-char - c-byte-order-mark.\n  return isPrintable(c) && c !== 0xFEFF\n    // - c-flow-indicator\n    && c !== CHAR_COMMA\n    && c !== CHAR_LEFT_SQUARE_BRACKET\n    && c !== CHAR_RIGHT_SQUARE_BRACKET\n    && c !== CHAR_LEFT_CURLY_BRACKET\n    && c !== CHAR_RIGHT_CURLY_BRACKET\n    // - \":\" - \"#\"\n    && c !== CHAR_COLON\n    && c !== CHAR_SHARP;\n}\n\n// Simplified test for values allowed as the first character in plain style.\nfunction isPlainSafeFirst(c) {\n  // Uses a subset of ns-char - c-indicator\n  // where ns-char = nb-char - s-white.\n  return isPrintable(c) && c !== 0xFEFF\n    && !isWhitespace(c) // - s-white\n    // - (c-indicator ::=\n    // - | ? | : | , | [ | ] | { | }\n    && c !== CHAR_MINUS\n    && c !== CHAR_QUESTION\n    && c !== CHAR_COLON\n    && c !== CHAR_COMMA\n    && c !== CHAR_LEFT_SQUARE_BRACKET\n    && c !== CHAR_RIGHT_SQUARE_BRACKET\n    && c !== CHAR_LEFT_CURLY_BRACKET\n    && c !== CHAR_RIGHT_CURLY_BRACKET\n    // | # | & | * | ! | | | > | ' | \"\n    && c !== CHAR_SHARP\n    && c !== CHAR_AMPERSAND\n    && c !== CHAR_ASTERISK\n    && c !== CHAR_EXCLAMATION\n    && c !== CHAR_VERTICAL_LINE\n    && c !== CHAR_GREATER_THAN\n    && c !== CHAR_SINGLE_QUOTE\n    && c !== CHAR_DOUBLE_QUOTE\n    // | % | @ | `)\n    && c !== CHAR_PERCENT\n    && c !== CHAR_COMMERCIAL_AT\n    && c !== CHAR_GRAVE_ACCENT;\n}\n\nvar STYLE_PLAIN   = 1,\n    STYLE_SINGLE  = 2,\n    STYLE_LITERAL = 3,\n    STYLE_FOLDED  = 4,\n    STYLE_DOUBLE  = 5;\n\n// Determines which scalar styles are possible and returns the preferred style.\n// lineWidth = -1 => no limit.\n// Pre-conditions: str.length > 0.\n// Post-conditions:\n//    STYLE_PLAIN or STYLE_SINGLE => no \\n are in the string.\n//    STYLE_LITERAL => no lines are suitable for folding (or lineWidth is -1).\n//    STYLE_FOLDED => a line > lineWidth and can be folded (and lineWidth != -1).\nfunction chooseScalarStyle(string, singleLineOnly, indentPerLevel, lineWidth, testAmbiguousType) {\n  var i;\n  var char;\n  var hasLineBreak = false;\n  var hasFoldableLine = false; // only checked if shouldTrackWidth\n  var shouldTrackWidth = lineWidth !== -1;\n  var previousLineBreak = -1; // count the first line correctly\n  var plain = isPlainSafeFirst(string.charCodeAt(0))\n          && !isWhitespace(string.charCodeAt(string.length - 1));\n\n  if (singleLineOnly) {\n    // Case: no block styles.\n    // Check for disallowed characters to rule out plain and single.\n    for (i = 0; i < string.length; i++) {\n      char = string.charCodeAt(i);\n      if (!isPrintable(char)) {\n        return STYLE_DOUBLE;\n      }\n      plain = plain && isPlainSafe(char);\n    }\n  } else {\n    // Case: block styles permitted.\n    for (i = 0; i < string.length; i++) {\n      char = string.charCodeAt(i);\n      if (char === CHAR_LINE_FEED) {\n        hasLineBreak = true;\n        // Check if any line can be folded.\n        if (shouldTrackWidth) {\n          hasFoldableLine = hasFoldableLine ||\n            // Foldable line = too long, and not more-indented.\n            (i - previousLineBreak - 1 > lineWidth &&\n             string[previousLineBreak + 1] !== ' ');\n          previousLineBreak = i;\n        }\n      } else if (!isPrintable(char)) {\n        return STYLE_DOUBLE;\n      }\n      plain = plain && isPlainSafe(char);\n    }\n    // in case the end is missing a \\n\n    hasFoldableLine = hasFoldableLine || (shouldTrackWidth &&\n      (i - previousLineBreak - 1 > lineWidth &&\n       string[previousLineBreak + 1] !== ' '));\n  }\n  // Although every style can represent \\n without escaping, prefer block styles\n  // for multiline, since they're more readable and they don't add empty lines.\n  // Also prefer folding a super-long line.\n  if (!hasLineBreak && !hasFoldableLine) {\n    // Strings interpretable as another type have to be quoted;\n    // e.g. the string 'true' vs. the boolean true.\n    return plain && !testAmbiguousType(string)\n      ? STYLE_PLAIN : STYLE_SINGLE;\n  }\n  // Edge case: block indentation indicator can only have one digit.\n  if (string[0] === ' ' && indentPerLevel > 9) {\n    return STYLE_DOUBLE;\n  }\n  // At this point we know block styles are valid.\n  // Prefer literal style unless we want to fold.\n  return hasFoldableLine ? STYLE_FOLDED : STYLE_LITERAL;\n}\n\n// Note: line breaking/folding is implemented for only the folded style.\n// NB. We drop the last trailing newline (if any) of a returned block scalar\n//  since the dumper adds its own newline. This always works:\n//     No ending newline => unaffected; already using strip \"-\" chomping.\n//     Ending newline    => removed then restored.\n//  Importantly, this keeps the \"+\" chomp indicator from gaining an extra line.\nfunction writeScalar(state, string, level, iskey) {\n  state.dump = (function () {\n    if (string.length === 0) {\n      return \"''\";\n    }\n    if (!state.noCompatMode &&\n        DEPRECATED_BOOLEANS_SYNTAX.indexOf(string) !== -1) {\n      return \"'\" + string + \"'\";\n    }\n\n    var indent = state.indent * Math.max(1, level); // no 0-indent scalars\n    // As indentation gets deeper, let the width decrease monotonically\n    // to the lower bound min(state.lineWidth, 40).\n    // Note that this implies\n    //  state.lineWidth  40 + state.indent: width is fixed at the lower bound.\n    //  state.lineWidth > 40 + state.indent: width decreases until the lower bound.\n    // This behaves better than a constant minimum width which disallows narrower options,\n    // or an indent threshold which causes the width to suddenly increase.\n    var lineWidth = state.lineWidth === -1\n      ? -1 : Math.max(Math.min(state.lineWidth, 40), state.lineWidth - indent);\n\n    // Without knowing if keys are implicit/explicit, assume implicit for safety.\n    var singleLineOnly = iskey\n      // No block styles in flow mode.\n      || (state.flowLevel > -1 && level >= state.flowLevel);\n    function testAmbiguity(string) {\n      return testImplicitResolving(state, string);\n    }\n\n    switch (chooseScalarStyle(string, singleLineOnly, state.indent, lineWidth, testAmbiguity)) {\n      case STYLE_PLAIN:\n        return string;\n      case STYLE_SINGLE:\n        return \"'\" + string.replace(/'/g, \"''\") + \"'\";\n      case STYLE_LITERAL:\n        return '|' + blockHeader(string, state.indent)\n          + dropEndingNewline(indentString(string, indent));\n      case STYLE_FOLDED:\n        return '>' + blockHeader(string, state.indent)\n          + dropEndingNewline(indentString(foldString(string, lineWidth), indent));\n      case STYLE_DOUBLE:\n        return '\"' + escapeString(string, lineWidth) + '\"';\n      default:\n        throw new YAMLException('impossible error: invalid scalar style');\n    }\n  }());\n}\n\n// Pre-conditions: string is valid for a block scalar, 1 <= indentPerLevel <= 9.\nfunction blockHeader(string, indentPerLevel) {\n  var indentIndicator = (string[0] === ' ') ? String(indentPerLevel) : '';\n\n  // note the special case: the string '\\n' counts as a \"trailing\" empty line.\n  var clip =          string[string.length - 1] === '\\n';\n  var keep = clip && (string[string.length - 2] === '\\n' || string === '\\n');\n  var chomp = keep ? '+' : (clip ? '' : '-');\n\n  return indentIndicator + chomp + '\\n';\n}\n\n// (See the note for writeScalar.)\nfunction dropEndingNewline(string) {\n  return string[string.length - 1] === '\\n' ? string.slice(0, -1) : string;\n}\n\n// Note: a long line without a suitable break point will exceed the width limit.\n// Pre-conditions: every char in str isPrintable, str.length > 0, width > 0.\nfunction foldString(string, width) {\n  // In folded style, $k$ consecutive newlines output as $k+1$ newlines\n  // unless they're before or after a more-indented line, or at the very\n  // beginning or end, in which case $k$ maps to $k$.\n  // Therefore, parse each chunk as newline(s) followed by a content line.\n  var lineRe = /(\\n+)([^\\n]*)/g;\n\n  // first line (possibly an empty line)\n  var result = (function () {\n    var nextLF = string.indexOf('\\n');\n    nextLF = nextLF !== -1 ? nextLF : string.length;\n    lineRe.lastIndex = nextLF;\n    return foldLine(string.slice(0, nextLF), width);\n  }());\n  // If we haven't reached the first content line yet, don't add an extra \\n.\n  var prevMoreIndented = string[0] === '\\n' || string[0] === ' ';\n  var moreIndented;\n\n  // rest of the lines\n  var match;\n  while ((match = lineRe.exec(string))) {\n    var prefix = match[1], line = match[2];\n    moreIndented = (line[0] === ' ');\n    result += prefix\n      + (!prevMoreIndented && !moreIndented && line !== ''\n        ? '\\n' : '')\n      + foldLine(line, width);\n    prevMoreIndented = moreIndented;\n  }\n\n  return result;\n}\n\n// Greedy line breaking.\n// Picks the longest line under the limit each time,\n// otherwise settles for the shortest line over the limit.\n// NB. More-indented lines *cannot* be folded, as that would add an extra \\n.\nfunction foldLine(line, width) {\n  if (line === '' || line[0] === ' ') return line;\n\n  // Since a more-indented line adds a \\n, breaks can't be followed by a space.\n  var breakRe = / [^ ]/g; // note: the match index will always be <= length-2.\n  var match;\n  // start is an inclusive index. end, curr, and next are exclusive.\n  var start = 0, end, curr = 0, next = 0;\n  var result = '';\n\n  // Invariants: 0 <= start <= length-1.\n  //   0 <= curr <= next <= max(0, length-2). curr - start <= width.\n  // Inside the loop:\n  //   A match implies length >= 2, so curr and next are <= length-2.\n  while ((match = breakRe.exec(line))) {\n    next = match.index;\n    // maintain invariant: curr - start <= width\n    if (next - start > width) {\n      end = (curr > start) ? curr : next; // derive end <= length-2\n      result += '\\n' + line.slice(start, end);\n      // skip the space that was output as \\n\n      start = end + 1;                    // derive start <= length-1\n    }\n    curr = next;\n  }\n\n  // By the invariants, start <= length-1, so there is something left over.\n  // It is either the whole string or a part starting from non-whitespace.\n  result += '\\n';\n  // Insert a break if the remainder is too long and there is a break available.\n  if (line.length - start > width && curr > start) {\n    result += line.slice(start, curr) + '\\n' + line.slice(curr + 1);\n  } else {\n    result += line.slice(start);\n  }\n\n  return result.slice(1); // drop extra \\n joiner\n}\n\n// Escapes a double-quoted string.\nfunction escapeString(string) {\n  var result = '';\n  var char;\n  var escapeSeq;\n\n  for (var i = 0; i < string.length; i++) {\n    char = string.charCodeAt(i);\n    escapeSeq = ESCAPE_SEQUENCES[char];\n    result += !escapeSeq && isPrintable(char)\n      ? string[i]\n      : escapeSeq || encodeHex(char);\n  }\n\n  return result;\n}\n\nfunction writeFlowSequence(state, level, object) {\n  var _result = '',\n      _tag    = state.tag,\n      index,\n      length;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    // Write only valid elements.\n    if (writeNode(state, level, object[index], false, false)) {\n      if (index !== 0) _result += ', ';\n      _result += state.dump;\n    }\n  }\n\n  state.tag = _tag;\n  state.dump = '[' + _result + ']';\n}\n\nfunction writeBlockSequence(state, level, object, compact) {\n  var _result = '',\n      _tag    = state.tag,\n      index,\n      length;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    // Write only valid elements.\n    if (writeNode(state, level + 1, object[index], true, true)) {\n      if (!compact || index !== 0) {\n        _result += generateNextLine(state, level);\n      }\n\n      if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n        _result += '-';\n      } else {\n        _result += '- ';\n      }\n\n      _result += state.dump;\n    }\n  }\n\n  state.tag = _tag;\n  state.dump = _result || '[]'; // Empty sequence if no valid values.\n}\n\nfunction writeFlowMapping(state, level, object) {\n  var _result       = '',\n      _tag          = state.tag,\n      objectKeyList = Object.keys(object),\n      index,\n      length,\n      objectKey,\n      objectValue,\n      pairBuffer;\n\n  for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n    pairBuffer = '';\n\n    if (index !== 0) pairBuffer += ', ';\n\n    objectKey = objectKeyList[index];\n    objectValue = object[objectKey];\n\n    if (!writeNode(state, level, objectKey, false, false)) {\n      continue; // Skip this pair because of invalid key;\n    }\n\n    if (state.dump.length > 1024) pairBuffer += '? ';\n\n    pairBuffer += state.dump + ': ';\n\n    if (!writeNode(state, level, objectValue, false, false)) {\n      continue; // Skip this pair because of invalid value.\n    }\n\n    pairBuffer += state.dump;\n\n    // Both key and value are valid.\n    _result += pairBuffer;\n  }\n\n  state.tag = _tag;\n  state.dump = '{' + _result + '}';\n}\n\nfunction writeBlockMapping(state, level, object, compact) {\n  var _result       = '',\n      _tag          = state.tag,\n      objectKeyList = Object.keys(object),\n      index,\n      length,\n      objectKey,\n      objectValue,\n      explicitPair,\n      pairBuffer;\n\n  // Allow sorting keys so that the output file is deterministic\n  if (state.sortKeys === true) {\n    // Default sorting\n    objectKeyList.sort();\n  } else if (typeof state.sortKeys === 'function') {\n    // Custom sort function\n    objectKeyList.sort(state.sortKeys);\n  } else if (state.sortKeys) {\n    // Something is wrong\n    throw new YAMLException('sortKeys must be a boolean or a function');\n  }\n\n  for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n    pairBuffer = '';\n\n    if (!compact || index !== 0) {\n      pairBuffer += generateNextLine(state, level);\n    }\n\n    objectKey = objectKeyList[index];\n    objectValue = object[objectKey];\n\n    if (!writeNode(state, level + 1, objectKey, true, true, true)) {\n      continue; // Skip this pair because of invalid key.\n    }\n\n    explicitPair = (state.tag !== null && state.tag !== '?') ||\n                   (state.dump && state.dump.length > 1024);\n\n    if (explicitPair) {\n      if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n        pairBuffer += '?';\n      } else {\n        pairBuffer += '? ';\n      }\n    }\n\n    pairBuffer += state.dump;\n\n    if (explicitPair) {\n      pairBuffer += generateNextLine(state, level);\n    }\n\n    if (!writeNode(state, level + 1, objectValue, true, explicitPair)) {\n      continue; // Skip this pair because of invalid value.\n    }\n\n    if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n      pairBuffer += ':';\n    } else {\n      pairBuffer += ': ';\n    }\n\n    pairBuffer += state.dump;\n\n    // Both key and value are valid.\n    _result += pairBuffer;\n  }\n\n  state.tag = _tag;\n  state.dump = _result || '{}'; // Empty mapping if no valid pairs.\n}\n\nfunction detectType(state, object, explicit) {\n  var _result, typeList, index, length, type, style;\n\n  typeList = explicit ? state.explicitTypes : state.implicitTypes;\n\n  for (index = 0, length = typeList.length; index < length; index += 1) {\n    type = typeList[index];\n\n    if ((type.instanceOf  || type.predicate) &&\n        (!type.instanceOf || ((typeof object === 'object') && (object instanceof type.instanceOf))) &&\n        (!type.predicate  || type.predicate(object))) {\n\n      state.tag = explicit ? type.tag : '?';\n\n      if (type.represent) {\n        style = state.styleMap[type.tag] || type.defaultStyle;\n\n        if (_toString.call(type.represent) === '[object Function]') {\n          _result = type.represent(object, style);\n        } else if (_hasOwnProperty.call(type.represent, style)) {\n          _result = type.represent[style](object, style);\n        } else {\n          throw new YAMLException('!<' + type.tag + '> tag resolver accepts not \"' + style + '\" style');\n        }\n\n        state.dump = _result;\n      }\n\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// Serializes `object` and writes it to global `result`.\n// Returns true on success, or false on invalid object.\n//\nfunction writeNode(state, level, object, block, compact, iskey) {\n  state.tag = null;\n  state.dump = object;\n\n  if (!detectType(state, object, false)) {\n    detectType(state, object, true);\n  }\n\n  var type = _toString.call(state.dump);\n\n  if (block) {\n    block = (state.flowLevel < 0 || state.flowLevel > level);\n  }\n\n  var objectOrArray = type === '[object Object]' || type === '[object Array]',\n      duplicateIndex,\n      duplicate;\n\n  if (objectOrArray) {\n    duplicateIndex = state.duplicates.indexOf(object);\n    duplicate = duplicateIndex !== -1;\n  }\n\n  if ((state.tag !== null && state.tag !== '?') || duplicate || (state.indent !== 2 && level > 0)) {\n    compact = false;\n  }\n\n  if (duplicate && state.usedDuplicates[duplicateIndex]) {\n    state.dump = '*ref_' + duplicateIndex;\n  } else {\n    if (objectOrArray && duplicate && !state.usedDuplicates[duplicateIndex]) {\n      state.usedDuplicates[duplicateIndex] = true;\n    }\n    if (type === '[object Object]') {\n      if (block && (Object.keys(state.dump).length !== 0)) {\n        writeBlockMapping(state, level, state.dump, compact);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + state.dump;\n        }\n      } else {\n        writeFlowMapping(state, level, state.dump);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + ' ' + state.dump;\n        }\n      }\n    } else if (type === '[object Array]') {\n      if (block && (state.dump.length !== 0)) {\n        writeBlockSequence(state, level, state.dump, compact);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + state.dump;\n        }\n      } else {\n        writeFlowSequence(state, level, state.dump);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + ' ' + state.dump;\n        }\n      }\n    } else if (type === '[object String]') {\n      if (state.tag !== '?') {\n        writeScalar(state, state.dump, level, iskey);\n      }\n    } else {\n      if (state.skipInvalid) return false;\n      throw new YAMLException('unacceptable kind of an object to dump ' + type);\n    }\n\n    if (state.tag !== null && state.tag !== '?') {\n      state.dump = '!<' + state.tag + '> ' + state.dump;\n    }\n  }\n\n  return true;\n}\n\nfunction getDuplicateReferences(object, state) {\n  var objects = [],\n      duplicatesIndexes = [],\n      index,\n      length;\n\n  inspectNode(object, objects, duplicatesIndexes);\n\n  for (index = 0, length = duplicatesIndexes.length; index < length; index += 1) {\n    state.duplicates.push(objects[duplicatesIndexes[index]]);\n  }\n  state.usedDuplicates = new Array(length);\n}\n\nfunction inspectNode(object, objects, duplicatesIndexes) {\n  var objectKeyList,\n      index,\n      length;\n\n  if (object !== null && typeof object === 'object') {\n    index = objects.indexOf(object);\n    if (index !== -1) {\n      if (duplicatesIndexes.indexOf(index) === -1) {\n        duplicatesIndexes.push(index);\n      }\n    } else {\n      objects.push(object);\n\n      if (Array.isArray(object)) {\n        for (index = 0, length = object.length; index < length; index += 1) {\n          inspectNode(object[index], objects, duplicatesIndexes);\n        }\n      } else {\n        objectKeyList = Object.keys(object);\n\n        for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n          inspectNode(object[objectKeyList[index]], objects, duplicatesIndexes);\n        }\n      }\n    }\n  }\n}\n\nfunction dump(input, options) {\n  options = options || {};\n\n  var state = new State(options);\n\n  if (!state.noRefs) getDuplicateReferences(input, state);\n\n  if (writeNode(state, 0, input, true, true)) return state.dump + '\\n';\n\n  return '';\n}\n\nfunction safeDump(input, options) {\n  return dump(input, common.extend({ schema: DEFAULT_SAFE_SCHEMA }, options));\n}\n\nmodule.exports.dump     = dump;\nmodule.exports.safeDump = safeDump;\n\n},{\"./common\":2,\"./exception\":4,\"./schema/default_full\":9,\"./schema/default_safe\":10}],4:[function(require,module,exports){\n// YAML error class. http://stackoverflow.com/questions/8458984\n//\n'use strict';\n\nfunction YAMLException(reason, mark) {\n  // Super constructor\n  Error.call(this);\n\n  // Include stack trace in error object\n  if (Error.captureStackTrace) {\n    // Chrome and NodeJS\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    // FF, IE 10+ and Safari 6+. Fallback for others\n    this.stack = (new Error()).stack || '';\n  }\n\n  this.name = 'YAMLException';\n  this.reason = reason;\n  this.mark = mark;\n  this.message = (this.reason || '(unknown reason)') + (this.mark ? ' ' + this.mark.toString() : '');\n}\n\n\n// Inherit from Error\nYAMLException.prototype = Object.create(Error.prototype);\nYAMLException.prototype.constructor = YAMLException;\n\n\nYAMLException.prototype.toString = function toString(compact) {\n  var result = this.name + ': ';\n\n  result += this.reason || '(unknown reason)';\n\n  if (!compact && this.mark) {\n    result += ' ' + this.mark.toString();\n  }\n\n  return result;\n};\n\n\nmodule.exports = YAMLException;\n\n},{}],5:[function(require,module,exports){\n'use strict';\n\n/*eslint-disable max-len,no-use-before-define*/\n\nvar common              = require('./common');\nvar YAMLException       = require('./exception');\nvar Mark                = require('./mark');\nvar DEFAULT_SAFE_SCHEMA = require('./schema/default_safe');\nvar DEFAULT_FULL_SCHEMA = require('./schema/default_full');\n\n\nvar _hasOwnProperty = Object.prototype.hasOwnProperty;\n\n\nvar CONTEXT_FLOW_IN   = 1;\nvar CONTEXT_FLOW_OUT  = 2;\nvar CONTEXT_BLOCK_IN  = 3;\nvar CONTEXT_BLOCK_OUT = 4;\n\n\nvar CHOMPING_CLIP  = 1;\nvar CHOMPING_STRIP = 2;\nvar CHOMPING_KEEP  = 3;\n\n\nvar PATTERN_NON_PRINTABLE         = /[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x84\\x86-\\x9F\\uFFFE\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]/;\nvar PATTERN_NON_ASCII_LINE_BREAKS = /[\\x85\\u2028\\u2029]/;\nvar PATTERN_FLOW_INDICATORS       = /[,\\[\\]\\{\\}]/;\nvar PATTERN_TAG_HANDLE            = /^(?:!|!!|![a-z\\-]+!)$/i;\nvar PATTERN_TAG_URI               = /^(?:!|[^,\\[\\]\\{\\}])(?:%[0-9a-f]{2}|[0-9a-z\\-#;\\/\\?:@&=\\+\\$,_\\.!~\\*'\\(\\)\\[\\]])*$/i;\n\n\nfunction is_EOL(c) {\n  return (c === 0x0A/* LF */) || (c === 0x0D/* CR */);\n}\n\nfunction is_WHITE_SPACE(c) {\n  return (c === 0x09/* Tab */) || (c === 0x20/* Space */);\n}\n\nfunction is_WS_OR_EOL(c) {\n  return (c === 0x09/* Tab */) ||\n         (c === 0x20/* Space */) ||\n         (c === 0x0A/* LF */) ||\n         (c === 0x0D/* CR */);\n}\n\nfunction is_FLOW_INDICATOR(c) {\n  return c === 0x2C/* , */ ||\n         c === 0x5B/* [ */ ||\n         c === 0x5D/* ] */ ||\n         c === 0x7B/* { */ ||\n         c === 0x7D/* } */;\n}\n\nfunction fromHexCode(c) {\n  var lc;\n\n  if ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) {\n    return c - 0x30;\n  }\n\n  /*eslint-disable no-bitwise*/\n  lc = c | 0x20;\n\n  if ((0x61/* a */ <= lc) && (lc <= 0x66/* f */)) {\n    return lc - 0x61 + 10;\n  }\n\n  return -1;\n}\n\nfunction escapedHexLen(c) {\n  if (c === 0x78/* x */) { return 2; }\n  if (c === 0x75/* u */) { return 4; }\n  if (c === 0x55/* U */) { return 8; }\n  return 0;\n}\n\nfunction fromDecimalCode(c) {\n  if ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) {\n    return c - 0x30;\n  }\n\n  return -1;\n}\n\nfunction simpleEscapeSequence(c) {\n  return (c === 0x30/* 0 */) ? '\\x00' :\n        (c === 0x61/* a */) ? '\\x07' :\n        (c === 0x62/* b */) ? '\\x08' :\n        (c === 0x74/* t */) ? '\\x09' :\n        (c === 0x09/* Tab */) ? '\\x09' :\n        (c === 0x6E/* n */) ? '\\x0A' :\n        (c === 0x76/* v */) ? '\\x0B' :\n        (c === 0x66/* f */) ? '\\x0C' :\n        (c === 0x72/* r */) ? '\\x0D' :\n        (c === 0x65/* e */) ? '\\x1B' :\n        (c === 0x20/* Space */) ? ' ' :\n        (c === 0x22/* \" */) ? '\\x22' :\n        (c === 0x2F/* / */) ? '/' :\n        (c === 0x5C/* \\ */) ? '\\x5C' :\n        (c === 0x4E/* N */) ? '\\x85' :\n        (c === 0x5F/* _ */) ? '\\xA0' :\n        (c === 0x4C/* L */) ? '\\u2028' :\n        (c === 0x50/* P */) ? '\\u2029' : '';\n}\n\nfunction charFromCodepoint(c) {\n  if (c <= 0xFFFF) {\n    return String.fromCharCode(c);\n  }\n  // Encode UTF-16 surrogate pair\n  // https://en.wikipedia.org/wiki/UTF-16#Code_points_U.2B010000_to_U.2B10FFFF\n  return String.fromCharCode(((c - 0x010000) >> 10) + 0xD800,\n                             ((c - 0x010000) & 0x03FF) + 0xDC00);\n}\n\nvar simpleEscapeCheck = new Array(256); // integer, for fast access\nvar simpleEscapeMap = new Array(256);\nfor (var i = 0; i < 256; i++) {\n  simpleEscapeCheck[i] = simpleEscapeSequence(i) ? 1 : 0;\n  simpleEscapeMap[i] = simpleEscapeSequence(i);\n}\n\n\nfunction State(input, options) {\n  this.input = input;\n\n  this.filename  = options['filename']  || null;\n  this.schema    = options['schema']    || DEFAULT_FULL_SCHEMA;\n  this.onWarning = options['onWarning'] || null;\n  this.legacy    = options['legacy']    || false;\n  this.json      = options['json']      || false;\n  this.listener  = options['listener']  || null;\n\n  this.implicitTypes = this.schema.compiledImplicit;\n  this.typeMap       = this.schema.compiledTypeMap;\n\n  this.length     = input.length;\n  this.position   = 0;\n  this.line       = 0;\n  this.lineStart  = 0;\n  this.lineIndent = 0;\n\n  this.documents = [];\n\n  /*\n  this.version;\n  this.checkLineBreaks;\n  this.tagMap;\n  this.anchorMap;\n  this.tag;\n  this.anchor;\n  this.kind;\n  this.result;*/\n\n}\n\n\nfunction generateError(state, message) {\n  return new YAMLException(\n    message,\n    new Mark(state.filename, state.input, state.position, state.line, (state.position - state.lineStart)));\n}\n\nfunction throwError(state, message) {\n  throw generateError(state, message);\n}\n\nfunction throwWarning(state, message) {\n  if (state.onWarning) {\n    state.onWarning.call(null, generateError(state, message));\n  }\n}\n\n\nvar directiveHandlers = {\n\n  YAML: function handleYamlDirective(state, name, args) {\n\n    var match, major, minor;\n\n    if (state.version !== null) {\n      throwError(state, 'duplication of %YAML directive');\n    }\n\n    if (args.length !== 1) {\n      throwError(state, 'YAML directive accepts exactly one argument');\n    }\n\n    match = /^([0-9]+)\\.([0-9]+)$/.exec(args[0]);\n\n    if (match === null) {\n      throwError(state, 'ill-formed argument of the YAML directive');\n    }\n\n    major = parseInt(match[1], 10);\n    minor = parseInt(match[2], 10);\n\n    if (major !== 1) {\n      throwError(state, 'unacceptable YAML version of the document');\n    }\n\n    state.version = args[0];\n    state.checkLineBreaks = (minor < 2);\n\n    if (minor !== 1 && minor !== 2) {\n      throwWarning(state, 'unsupported YAML version of the document');\n    }\n  },\n\n  TAG: function handleTagDirective(state, name, args) {\n\n    var handle, prefix;\n\n    if (args.length !== 2) {\n      throwError(state, 'TAG directive accepts exactly two arguments');\n    }\n\n    handle = args[0];\n    prefix = args[1];\n\n    if (!PATTERN_TAG_HANDLE.test(handle)) {\n      throwError(state, 'ill-formed tag handle (first argument) of the TAG directive');\n    }\n\n    if (_hasOwnProperty.call(state.tagMap, handle)) {\n      throwError(state, 'there is a previously declared suffix for \"' + handle + '\" tag handle');\n    }\n\n    if (!PATTERN_TAG_URI.test(prefix)) {\n      throwError(state, 'ill-formed tag prefix (second argument) of the TAG directive');\n    }\n\n    state.tagMap[handle] = prefix;\n  }\n};\n\n\nfunction captureSegment(state, start, end, checkJson) {\n  var _position, _length, _character, _result;\n\n  if (start < end) {\n    _result = state.input.slice(start, end);\n\n    if (checkJson) {\n      for (_position = 0, _length = _result.length;\n           _position < _length;\n           _position += 1) {\n        _character = _result.charCodeAt(_position);\n        if (!(_character === 0x09 ||\n              (0x20 <= _character && _character <= 0x10FFFF))) {\n          throwError(state, 'expected valid JSON character');\n        }\n      }\n    } else if (PATTERN_NON_PRINTABLE.test(_result)) {\n      throwError(state, 'the stream contains non-printable characters');\n    }\n\n    state.result += _result;\n  }\n}\n\nfunction mergeMappings(state, destination, source, overridableKeys) {\n  var sourceKeys, key, index, quantity;\n\n  if (!common.isObject(source)) {\n    throwError(state, 'cannot merge mappings; the provided source object is unacceptable');\n  }\n\n  sourceKeys = Object.keys(source);\n\n  for (index = 0, quantity = sourceKeys.length; index < quantity; index += 1) {\n    key = sourceKeys[index];\n\n    if (!_hasOwnProperty.call(destination, key)) {\n      destination[key] = source[key];\n      overridableKeys[key] = true;\n    }\n  }\n}\n\nfunction storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode, startLine, startPos) {\n  var index, quantity;\n\n  keyNode = String(keyNode);\n\n  if (_result === null) {\n    _result = {};\n  }\n\n  if (keyTag === 'tag:yaml.org,2002:merge') {\n    if (Array.isArray(valueNode)) {\n      for (index = 0, quantity = valueNode.length; index < quantity; index += 1) {\n        mergeMappings(state, _result, valueNode[index], overridableKeys);\n      }\n    } else {\n      mergeMappings(state, _result, valueNode, overridableKeys);\n    }\n  } else {\n    if (!state.json &&\n        !_hasOwnProperty.call(overridableKeys, keyNode) &&\n        _hasOwnProperty.call(_result, keyNode)) {\n      state.line = startLine || state.line;\n      state.position = startPos || state.position;\n      throwError(state, 'duplicated mapping key');\n    }\n    _result[keyNode] = valueNode;\n    delete overridableKeys[keyNode];\n  }\n\n  return _result;\n}\n\nfunction readLineBreak(state) {\n  var ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x0A/* LF */) {\n    state.position++;\n  } else if (ch === 0x0D/* CR */) {\n    state.position++;\n    if (state.input.charCodeAt(state.position) === 0x0A/* LF */) {\n      state.position++;\n    }\n  } else {\n    throwError(state, 'a line break is expected');\n  }\n\n  state.line += 1;\n  state.lineStart = state.position;\n}\n\nfunction skipSeparationSpace(state, allowComments, checkIndent) {\n  var lineBreaks = 0,\n      ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    while (is_WHITE_SPACE(ch)) {\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    if (allowComments && ch === 0x23/* # */) {\n      do {\n        ch = state.input.charCodeAt(++state.position);\n      } while (ch !== 0x0A/* LF */ && ch !== 0x0D/* CR */ && ch !== 0);\n    }\n\n    if (is_EOL(ch)) {\n      readLineBreak(state);\n\n      ch = state.input.charCodeAt(state.position);\n      lineBreaks++;\n      state.lineIndent = 0;\n\n      while (ch === 0x20/* Space */) {\n        state.lineIndent++;\n        ch = state.input.charCodeAt(++state.position);\n      }\n    } else {\n      break;\n    }\n  }\n\n  if (checkIndent !== -1 && lineBreaks !== 0 && state.lineIndent < checkIndent) {\n    throwWarning(state, 'deficient indentation');\n  }\n\n  return lineBreaks;\n}\n\nfunction testDocumentSeparator(state) {\n  var _position = state.position,\n      ch;\n\n  ch = state.input.charCodeAt(_position);\n\n  // Condition state.position === state.lineStart is tested\n  // in parent on each call, for efficiency. No needs to test here again.\n  if ((ch === 0x2D/* - */ || ch === 0x2E/* . */) &&\n      ch === state.input.charCodeAt(_position + 1) &&\n      ch === state.input.charCodeAt(_position + 2)) {\n\n    _position += 3;\n\n    ch = state.input.charCodeAt(_position);\n\n    if (ch === 0 || is_WS_OR_EOL(ch)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction writeFoldedLines(state, count) {\n  if (count === 1) {\n    state.result += ' ';\n  } else if (count > 1) {\n    state.result += common.repeat('\\n', count - 1);\n  }\n}\n\n\nfunction readPlainScalar(state, nodeIndent, withinFlowCollection) {\n  var preceding,\n      following,\n      captureStart,\n      captureEnd,\n      hasPendingContent,\n      _line,\n      _lineStart,\n      _lineIndent,\n      _kind = state.kind,\n      _result = state.result,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (is_WS_OR_EOL(ch)      ||\n      is_FLOW_INDICATOR(ch) ||\n      ch === 0x23/* # */    ||\n      ch === 0x26/* & */    ||\n      ch === 0x2A/* * */    ||\n      ch === 0x21/* ! */    ||\n      ch === 0x7C/* | */    ||\n      ch === 0x3E/* > */    ||\n      ch === 0x27/* ' */    ||\n      ch === 0x22/* \" */    ||\n      ch === 0x25/* % */    ||\n      ch === 0x40/* @ */    ||\n      ch === 0x60/* ` */) {\n    return false;\n  }\n\n  if (ch === 0x3F/* ? */ || ch === 0x2D/* - */) {\n    following = state.input.charCodeAt(state.position + 1);\n\n    if (is_WS_OR_EOL(following) ||\n        withinFlowCollection && is_FLOW_INDICATOR(following)) {\n      return false;\n    }\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  captureStart = captureEnd = state.position;\n  hasPendingContent = false;\n\n  while (ch !== 0) {\n    if (ch === 0x3A/* : */) {\n      following = state.input.charCodeAt(state.position + 1);\n\n      if (is_WS_OR_EOL(following) ||\n          withinFlowCollection && is_FLOW_INDICATOR(following)) {\n        break;\n      }\n\n    } else if (ch === 0x23/* # */) {\n      preceding = state.input.charCodeAt(state.position - 1);\n\n      if (is_WS_OR_EOL(preceding)) {\n        break;\n      }\n\n    } else if ((state.position === state.lineStart && testDocumentSeparator(state)) ||\n               withinFlowCollection && is_FLOW_INDICATOR(ch)) {\n      break;\n\n    } else if (is_EOL(ch)) {\n      _line = state.line;\n      _lineStart = state.lineStart;\n      _lineIndent = state.lineIndent;\n      skipSeparationSpace(state, false, -1);\n\n      if (state.lineIndent >= nodeIndent) {\n        hasPendingContent = true;\n        ch = state.input.charCodeAt(state.position);\n        continue;\n      } else {\n        state.position = captureEnd;\n        state.line = _line;\n        state.lineStart = _lineStart;\n        state.lineIndent = _lineIndent;\n        break;\n      }\n    }\n\n    if (hasPendingContent) {\n      captureSegment(state, captureStart, captureEnd, false);\n      writeFoldedLines(state, state.line - _line);\n      captureStart = captureEnd = state.position;\n      hasPendingContent = false;\n    }\n\n    if (!is_WHITE_SPACE(ch)) {\n      captureEnd = state.position + 1;\n    }\n\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  captureSegment(state, captureStart, captureEnd, false);\n\n  if (state.result) {\n    return true;\n  }\n\n  state.kind = _kind;\n  state.result = _result;\n  return false;\n}\n\nfunction readSingleQuotedScalar(state, nodeIndent) {\n  var ch,\n      captureStart, captureEnd;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x27/* ' */) {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  state.position++;\n  captureStart = captureEnd = state.position;\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    if (ch === 0x27/* ' */) {\n      captureSegment(state, captureStart, state.position, true);\n      ch = state.input.charCodeAt(++state.position);\n\n      if (ch === 0x27/* ' */) {\n        captureStart = state.position;\n        state.position++;\n        captureEnd = state.position;\n      } else {\n        return true;\n      }\n\n    } else if (is_EOL(ch)) {\n      captureSegment(state, captureStart, captureEnd, true);\n      writeFoldedLines(state, skipSeparationSpace(state, false, nodeIndent));\n      captureStart = captureEnd = state.position;\n\n    } else if (state.position === state.lineStart && testDocumentSeparator(state)) {\n      throwError(state, 'unexpected end of the document within a single quoted scalar');\n\n    } else {\n      state.position++;\n      captureEnd = state.position;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a single quoted scalar');\n}\n\nfunction readDoubleQuotedScalar(state, nodeIndent) {\n  var captureStart,\n      captureEnd,\n      hexLength,\n      hexResult,\n      tmp,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x22/* \" */) {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  state.position++;\n  captureStart = captureEnd = state.position;\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    if (ch === 0x22/* \" */) {\n      captureSegment(state, captureStart, state.position, true);\n      state.position++;\n      return true;\n\n    } else if (ch === 0x5C/* \\ */) {\n      captureSegment(state, captureStart, state.position, true);\n      ch = state.input.charCodeAt(++state.position);\n\n      if (is_EOL(ch)) {\n        skipSeparationSpace(state, false, nodeIndent);\n\n        // TODO: rework to inline fn with no type cast?\n      } else if (ch < 256 && simpleEscapeCheck[ch]) {\n        state.result += simpleEscapeMap[ch];\n        state.position++;\n\n      } else if ((tmp = escapedHexLen(ch)) > 0) {\n        hexLength = tmp;\n        hexResult = 0;\n\n        for (; hexLength > 0; hexLength--) {\n          ch = state.input.charCodeAt(++state.position);\n\n          if ((tmp = fromHexCode(ch)) >= 0) {\n            hexResult = (hexResult << 4) + tmp;\n\n          } else {\n            throwError(state, 'expected hexadecimal character');\n          }\n        }\n\n        state.result += charFromCodepoint(hexResult);\n\n        state.position++;\n\n      } else {\n        throwError(state, 'unknown escape sequence');\n      }\n\n      captureStart = captureEnd = state.position;\n\n    } else if (is_EOL(ch)) {\n      captureSegment(state, captureStart, captureEnd, true);\n      writeFoldedLines(state, skipSeparationSpace(state, false, nodeIndent));\n      captureStart = captureEnd = state.position;\n\n    } else if (state.position === state.lineStart && testDocumentSeparator(state)) {\n      throwError(state, 'unexpected end of the document within a double quoted scalar');\n\n    } else {\n      state.position++;\n      captureEnd = state.position;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a double quoted scalar');\n}\n\nfunction readFlowCollection(state, nodeIndent) {\n  var readNext = true,\n      _line,\n      _tag     = state.tag,\n      _result,\n      _anchor  = state.anchor,\n      following,\n      terminator,\n      isPair,\n      isExplicitPair,\n      isMapping,\n      overridableKeys = {},\n      keyNode,\n      keyTag,\n      valueNode,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x5B/* [ */) {\n    terminator = 0x5D;/* ] */\n    isMapping = false;\n    _result = [];\n  } else if (ch === 0x7B/* { */) {\n    terminator = 0x7D;/* } */\n    isMapping = true;\n    _result = {};\n  } else {\n    return false;\n  }\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n\n  while (ch !== 0) {\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (ch === terminator) {\n      state.position++;\n      state.tag = _tag;\n      state.anchor = _anchor;\n      state.kind = isMapping ? 'mapping' : 'sequence';\n      state.result = _result;\n      return true;\n    } else if (!readNext) {\n      throwError(state, 'missed comma between flow collection entries');\n    }\n\n    keyTag = keyNode = valueNode = null;\n    isPair = isExplicitPair = false;\n\n    if (ch === 0x3F/* ? */) {\n      following = state.input.charCodeAt(state.position + 1);\n\n      if (is_WS_OR_EOL(following)) {\n        isPair = isExplicitPair = true;\n        state.position++;\n        skipSeparationSpace(state, true, nodeIndent);\n      }\n    }\n\n    _line = state.line;\n    composeNode(state, nodeIndent, CONTEXT_FLOW_IN, false, true);\n    keyTag = state.tag;\n    keyNode = state.result;\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if ((isExplicitPair || state.line === _line) && ch === 0x3A/* : */) {\n      isPair = true;\n      ch = state.input.charCodeAt(++state.position);\n      skipSeparationSpace(state, true, nodeIndent);\n      composeNode(state, nodeIndent, CONTEXT_FLOW_IN, false, true);\n      valueNode = state.result;\n    }\n\n    if (isMapping) {\n      storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode);\n    } else if (isPair) {\n      _result.push(storeMappingPair(state, null, overridableKeys, keyTag, keyNode, valueNode));\n    } else {\n      _result.push(keyNode);\n    }\n\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (ch === 0x2C/* , */) {\n      readNext = true;\n      ch = state.input.charCodeAt(++state.position);\n    } else {\n      readNext = false;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a flow collection');\n}\n\nfunction readBlockScalar(state, nodeIndent) {\n  var captureStart,\n      folding,\n      chomping       = CHOMPING_CLIP,\n      didReadContent = false,\n      detectedIndent = false,\n      textIndent     = nodeIndent,\n      emptyLines     = 0,\n      atMoreIndented = false,\n      tmp,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x7C/* | */) {\n    folding = false;\n  } else if (ch === 0x3E/* > */) {\n    folding = true;\n  } else {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n\n  while (ch !== 0) {\n    ch = state.input.charCodeAt(++state.position);\n\n    if (ch === 0x2B/* + */ || ch === 0x2D/* - */) {\n      if (CHOMPING_CLIP === chomping) {\n        chomping = (ch === 0x2B/* + */) ? CHOMPING_KEEP : CHOMPING_STRIP;\n      } else {\n        throwError(state, 'repeat of a chomping mode identifier');\n      }\n\n    } else if ((tmp = fromDecimalCode(ch)) >= 0) {\n      if (tmp === 0) {\n        throwError(state, 'bad explicit indentation width of a block scalar; it cannot be less than one');\n      } else if (!detectedIndent) {\n        textIndent = nodeIndent + tmp - 1;\n        detectedIndent = true;\n      } else {\n        throwError(state, 'repeat of an indentation width identifier');\n      }\n\n    } else {\n      break;\n    }\n  }\n\n  if (is_WHITE_SPACE(ch)) {\n    do { ch = state.input.charCodeAt(++state.position); }\n    while (is_WHITE_SPACE(ch));\n\n    if (ch === 0x23/* # */) {\n      do { ch = state.input.charCodeAt(++state.position); }\n      while (!is_EOL(ch) && (ch !== 0));\n    }\n  }\n\n  while (ch !== 0) {\n    readLineBreak(state);\n    state.lineIndent = 0;\n\n    ch = state.input.charCodeAt(state.position);\n\n    while ((!detectedIndent || state.lineIndent < textIndent) &&\n           (ch === 0x20/* Space */)) {\n      state.lineIndent++;\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    if (!detectedIndent && state.lineIndent > textIndent) {\n      textIndent = state.lineIndent;\n    }\n\n    if (is_EOL(ch)) {\n      emptyLines++;\n      continue;\n    }\n\n    // End of the scalar.\n    if (state.lineIndent < textIndent) {\n\n      // Perform the chomping.\n      if (chomping === CHOMPING_KEEP) {\n        state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n      } else if (chomping === CHOMPING_CLIP) {\n        if (didReadContent) { // i.e. only if the scalar is not empty.\n          state.result += '\\n';\n        }\n      }\n\n      // Break this `while` cycle and go to the funciton's epilogue.\n      break;\n    }\n\n    // Folded style: use fancy rules to handle line breaks.\n    if (folding) {\n\n      // Lines starting with white space characters (more-indented lines) are not folded.\n      if (is_WHITE_SPACE(ch)) {\n        atMoreIndented = true;\n        // except for the first content line (cf. Example 8.1)\n        state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n\n      // End of more-indented block.\n      } else if (atMoreIndented) {\n        atMoreIndented = false;\n        state.result += common.repeat('\\n', emptyLines + 1);\n\n      // Just one line break - perceive as the same line.\n      } else if (emptyLines === 0) {\n        if (didReadContent) { // i.e. only if we have already read some scalar content.\n          state.result += ' ';\n        }\n\n      // Several line breaks - perceive as different lines.\n      } else {\n        state.result += common.repeat('\\n', emptyLines);\n      }\n\n    // Literal style: just add exact number of line breaks between content lines.\n    } else {\n      // Keep all line breaks except the header line break.\n      state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n    }\n\n    didReadContent = true;\n    detectedIndent = true;\n    emptyLines = 0;\n    captureStart = state.position;\n\n    while (!is_EOL(ch) && (ch !== 0)) {\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    captureSegment(state, captureStart, state.position, false);\n  }\n\n  return true;\n}\n\nfunction readBlockSequence(state, nodeIndent) {\n  var _line,\n      _tag      = state.tag,\n      _anchor   = state.anchor,\n      _result   = [],\n      following,\n      detected  = false,\n      ch;\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n\n    if (ch !== 0x2D/* - */) {\n      break;\n    }\n\n    following = state.input.charCodeAt(state.position + 1);\n\n    if (!is_WS_OR_EOL(following)) {\n      break;\n    }\n\n    detected = true;\n    state.position++;\n\n    if (skipSeparationSpace(state, true, -1)) {\n      if (state.lineIndent <= nodeIndent) {\n        _result.push(null);\n        ch = state.input.charCodeAt(state.position);\n        continue;\n      }\n    }\n\n    _line = state.line;\n    composeNode(state, nodeIndent, CONTEXT_BLOCK_IN, false, true);\n    _result.push(state.result);\n    skipSeparationSpace(state, true, -1);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if ((state.line === _line || state.lineIndent > nodeIndent) && (ch !== 0)) {\n      throwError(state, 'bad indentation of a sequence entry');\n    } else if (state.lineIndent < nodeIndent) {\n      break;\n    }\n  }\n\n  if (detected) {\n    state.tag = _tag;\n    state.anchor = _anchor;\n    state.kind = 'sequence';\n    state.result = _result;\n    return true;\n  }\n  return false;\n}\n\nfunction readBlockMapping(state, nodeIndent, flowIndent) {\n  var following,\n      allowCompact,\n      _line,\n      _pos,\n      _tag          = state.tag,\n      _anchor       = state.anchor,\n      _result       = {},\n      overridableKeys = {},\n      keyTag        = null,\n      keyNode       = null,\n      valueNode     = null,\n      atExplicitKey = false,\n      detected      = false,\n      ch;\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    following = state.input.charCodeAt(state.position + 1);\n    _line = state.line; // Save the current line.\n    _pos = state.position;\n\n    //\n    // Explicit notation case. There are two separate blocks:\n    // first for the key (denoted by \"?\") and second for the value (denoted by \":\")\n    //\n    if ((ch === 0x3F/* ? */ || ch === 0x3A/* : */) && is_WS_OR_EOL(following)) {\n\n      if (ch === 0x3F/* ? */) {\n        if (atExplicitKey) {\n          storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null);\n          keyTag = keyNode = valueNode = null;\n        }\n\n        detected = true;\n        atExplicitKey = true;\n        allowCompact = true;\n\n      } else if (atExplicitKey) {\n        // i.e. 0x3A/* : */ === character after the explicit key.\n        atExplicitKey = false;\n        allowCompact = true;\n\n      } else {\n        throwError(state, 'incomplete explicit mapping pair; a key node is missed');\n      }\n\n      state.position += 1;\n      ch = following;\n\n    //\n    // Implicit notation case. Flow-style node as the key first, then \":\", and the value.\n    //\n    } else if (composeNode(state, flowIndent, CONTEXT_FLOW_OUT, false, true)) {\n\n      if (state.line === _line) {\n        ch = state.input.charCodeAt(state.position);\n\n        while (is_WHITE_SPACE(ch)) {\n          ch = state.input.charCodeAt(++state.position);\n        }\n\n        if (ch === 0x3A/* : */) {\n          ch = state.input.charCodeAt(++state.position);\n\n          if (!is_WS_OR_EOL(ch)) {\n            throwError(state, 'a whitespace character is expected after the key-value separator within a block mapping');\n          }\n\n          if (atExplicitKey) {\n            storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null);\n            keyTag = keyNode = valueNode = null;\n          }\n\n          detected = true;\n          atExplicitKey = false;\n          allowCompact = false;\n          keyTag = state.tag;\n          keyNode = state.result;\n\n        } else if (detected) {\n          throwError(state, 'can not read an implicit mapping pair; a colon is missed');\n\n        } else {\n          state.tag = _tag;\n          state.anchor = _anchor;\n          return true; // Keep the result of `composeNode`.\n        }\n\n      } else if (detected) {\n        throwError(state, 'can not read a block mapping entry; a multiline key may not be an implicit key');\n\n      } else {\n        state.tag = _tag;\n        state.anchor = _anchor;\n        return true; // Keep the result of `composeNode`.\n      }\n\n    } else {\n      break; // Reading is done. Go to the epilogue.\n    }\n\n    //\n    // Common reading code for both explicit and implicit notations.\n    //\n    if (state.line === _line || state.lineIndent > nodeIndent) {\n      if (composeNode(state, nodeIndent, CONTEXT_BLOCK_OUT, true, allowCompact)) {\n        if (atExplicitKey) {\n          keyNode = state.result;\n        } else {\n          valueNode = state.result;\n        }\n      }\n\n      if (!atExplicitKey) {\n        storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode, _line, _pos);\n        keyTag = keyNode = valueNode = null;\n      }\n\n      skipSeparationSpace(state, true, -1);\n      ch = state.input.charCodeAt(state.position);\n    }\n\n    if (state.lineIndent > nodeIndent && (ch !== 0)) {\n      throwError(state, 'bad indentation of a mapping entry');\n    } else if (state.lineIndent < nodeIndent) {\n      break;\n    }\n  }\n\n  //\n  // Epilogue.\n  //\n\n  // Special case: last mapping's node contains only the key in explicit notation.\n  if (atExplicitKey) {\n    storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null);\n  }\n\n  // Expose the resulting mapping.\n  if (detected) {\n    state.tag = _tag;\n    state.anchor = _anchor;\n    state.kind = 'mapping';\n    state.result = _result;\n  }\n\n  return detected;\n}\n\nfunction readTagProperty(state) {\n  var _position,\n      isVerbatim = false,\n      isNamed    = false,\n      tagHandle,\n      tagName,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x21/* ! */) return false;\n\n  if (state.tag !== null) {\n    throwError(state, 'duplication of a tag property');\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n\n  if (ch === 0x3C/* < */) {\n    isVerbatim = true;\n    ch = state.input.charCodeAt(++state.position);\n\n  } else if (ch === 0x21/* ! */) {\n    isNamed = true;\n    tagHandle = '!!';\n    ch = state.input.charCodeAt(++state.position);\n\n  } else {\n    tagHandle = '!';\n  }\n\n  _position = state.position;\n\n  if (isVerbatim) {\n    do { ch = state.input.charCodeAt(++state.position); }\n    while (ch !== 0 && ch !== 0x3E/* > */);\n\n    if (state.position < state.length) {\n      tagName = state.input.slice(_position, state.position);\n      ch = state.input.charCodeAt(++state.position);\n    } else {\n      throwError(state, 'unexpected end of the stream within a verbatim tag');\n    }\n  } else {\n    while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n\n      if (ch === 0x21/* ! */) {\n        if (!isNamed) {\n          tagHandle = state.input.slice(_position - 1, state.position + 1);\n\n          if (!PATTERN_TAG_HANDLE.test(tagHandle)) {\n            throwError(state, 'named tag handle cannot contain such characters');\n          }\n\n          isNamed = true;\n          _position = state.position + 1;\n        } else {\n          throwError(state, 'tag suffix cannot contain exclamation marks');\n        }\n      }\n\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    tagName = state.input.slice(_position, state.position);\n\n    if (PATTERN_FLOW_INDICATORS.test(tagName)) {\n      throwError(state, 'tag suffix cannot contain flow indicator characters');\n    }\n  }\n\n  if (tagName && !PATTERN_TAG_URI.test(tagName)) {\n    throwError(state, 'tag name cannot contain such characters: ' + tagName);\n  }\n\n  if (isVerbatim) {\n    state.tag = tagName;\n\n  } else if (_hasOwnProperty.call(state.tagMap, tagHandle)) {\n    state.tag = state.tagMap[tagHandle] + tagName;\n\n  } else if (tagHandle === '!') {\n    state.tag = '!' + tagName;\n\n  } else if (tagHandle === '!!') {\n    state.tag = 'tag:yaml.org,2002:' + tagName;\n\n  } else {\n    throwError(state, 'undeclared tag handle \"' + tagHandle + '\"');\n  }\n\n  return true;\n}\n\nfunction readAnchorProperty(state) {\n  var _position,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x26/* & */) return false;\n\n  if (state.anchor !== null) {\n    throwError(state, 'duplication of an anchor property');\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n  _position = state.position;\n\n  while (ch !== 0 && !is_WS_OR_EOL(ch) && !is_FLOW_INDICATOR(ch)) {\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  if (state.position === _position) {\n    throwError(state, 'name of an anchor node must contain at least one character');\n  }\n\n  state.anchor = state.input.slice(_position, state.position);\n  return true;\n}\n\nfunction readAlias(state) {\n  var _position, alias,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x2A/* * */) return false;\n\n  ch = state.input.charCodeAt(++state.position);\n  _position = state.position;\n\n  while (ch !== 0 && !is_WS_OR_EOL(ch) && !is_FLOW_INDICATOR(ch)) {\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  if (state.position === _position) {\n    throwError(state, 'name of an alias node must contain at least one character');\n  }\n\n  alias = state.input.slice(_position, state.position);\n\n  if (!state.anchorMap.hasOwnProperty(alias)) {\n    throwError(state, 'unidentified alias \"' + alias + '\"');\n  }\n\n  state.result = state.anchorMap[alias];\n  skipSeparationSpace(state, true, -1);\n  return true;\n}\n\nfunction composeNode(state, parentIndent, nodeContext, allowToSeek, allowCompact) {\n  var allowBlockStyles,\n      allowBlockScalars,\n      allowBlockCollections,\n      indentStatus = 1, // 1: this>parent, 0: this=parent, -1: this<parent\n      atNewLine  = false,\n      hasContent = false,\n      typeIndex,\n      typeQuantity,\n      type,\n      flowIndent,\n      blockIndent;\n\n  if (state.listener !== null) {\n    state.listener('open', state);\n  }\n\n  state.tag    = null;\n  state.anchor = null;\n  state.kind   = null;\n  state.result = null;\n\n  allowBlockStyles = allowBlockScalars = allowBlockCollections =\n    CONTEXT_BLOCK_OUT === nodeContext ||\n    CONTEXT_BLOCK_IN  === nodeContext;\n\n  if (allowToSeek) {\n    if (skipSeparationSpace(state, true, -1)) {\n      atNewLine = true;\n\n      if (state.lineIndent > parentIndent) {\n        indentStatus = 1;\n      } else if (state.lineIndent === parentIndent) {\n        indentStatus = 0;\n      } else if (state.lineIndent < parentIndent) {\n        indentStatus = -1;\n      }\n    }\n  }\n\n  if (indentStatus === 1) {\n    while (readTagProperty(state) || readAnchorProperty(state)) {\n      if (skipSeparationSpace(state, true, -1)) {\n        atNewLine = true;\n        allowBlockCollections = allowBlockStyles;\n\n        if (state.lineIndent > parentIndent) {\n          indentStatus = 1;\n        } else if (state.lineIndent === parentIndent) {\n          indentStatus = 0;\n        } else if (state.lineIndent < parentIndent) {\n          indentStatus = -1;\n        }\n      } else {\n        allowBlockCollections = false;\n      }\n    }\n  }\n\n  if (allowBlockCollections) {\n    allowBlockCollections = atNewLine || allowCompact;\n  }\n\n  if (indentStatus === 1 || CONTEXT_BLOCK_OUT === nodeContext) {\n    if (CONTEXT_FLOW_IN === nodeContext || CONTEXT_FLOW_OUT === nodeContext) {\n      flowIndent = parentIndent;\n    } else {\n      flowIndent = parentIndent + 1;\n    }\n\n    blockIndent = state.position - state.lineStart;\n\n    if (indentStatus === 1) {\n      if (allowBlockCollections &&\n          (readBlockSequence(state, blockIndent) ||\n           readBlockMapping(state, blockIndent, flowIndent)) ||\n          readFlowCollection(state, flowIndent)) {\n        hasContent = true;\n      } else {\n        if ((allowBlockScalars && readBlockScalar(state, flowIndent)) ||\n            readSingleQuotedScalar(state, flowIndent) ||\n            readDoubleQuotedScalar(state, flowIndent)) {\n          hasContent = true;\n\n        } else if (readAlias(state)) {\n          hasContent = true;\n\n          if (state.tag !== null || state.anchor !== null) {\n            throwError(state, 'alias node should not have any properties');\n          }\n\n        } else if (readPlainScalar(state, flowIndent, CONTEXT_FLOW_IN === nodeContext)) {\n          hasContent = true;\n\n          if (state.tag === null) {\n            state.tag = '?';\n          }\n        }\n\n        if (state.anchor !== null) {\n          state.anchorMap[state.anchor] = state.result;\n        }\n      }\n    } else if (indentStatus === 0) {\n      // Special case: block sequences are allowed to have same indentation level as the parent.\n      // http://www.yaml.org/spec/1.2/spec.html#id2799784\n      hasContent = allowBlockCollections && readBlockSequence(state, blockIndent);\n    }\n  }\n\n  if (state.tag !== null && state.tag !== '!') {\n    if (state.tag === '?') {\n      for (typeIndex = 0, typeQuantity = state.implicitTypes.length;\n           typeIndex < typeQuantity;\n           typeIndex += 1) {\n        type = state.implicitTypes[typeIndex];\n\n        // Implicit resolving is not allowed for non-scalar types, and '?'\n        // non-specific tag is only assigned to plain scalars. So, it isn't\n        // needed to check for 'kind' conformity.\n\n        if (type.resolve(state.result)) { // `state.result` updated in resolver if matched\n          state.result = type.construct(state.result);\n          state.tag = type.tag;\n          if (state.anchor !== null) {\n            state.anchorMap[state.anchor] = state.result;\n          }\n          break;\n        }\n      }\n    } else if (_hasOwnProperty.call(state.typeMap[state.kind || 'fallback'], state.tag)) {\n      type = state.typeMap[state.kind || 'fallback'][state.tag];\n\n      if (state.result !== null && type.kind !== state.kind) {\n        throwError(state, 'unacceptable node kind for !<' + state.tag + '> tag; it should be \"' + type.kind + '\", not \"' + state.kind + '\"');\n      }\n\n      if (!type.resolve(state.result)) { // `state.result` updated in resolver if matched\n        throwError(state, 'cannot resolve a node with !<' + state.tag + '> explicit tag');\n      } else {\n        state.result = type.construct(state.result);\n        if (state.anchor !== null) {\n          state.anchorMap[state.anchor] = state.result;\n        }\n      }\n    } else {\n      throwError(state, 'unknown tag !<' + state.tag + '>');\n    }\n  }\n\n  if (state.listener !== null) {\n    state.listener('close', state);\n  }\n  return state.tag !== null ||  state.anchor !== null || hasContent;\n}\n\nfunction readDocument(state) {\n  var documentStart = state.position,\n      _position,\n      directiveName,\n      directiveArgs,\n      hasDirectives = false,\n      ch;\n\n  state.version = null;\n  state.checkLineBreaks = state.legacy;\n  state.tagMap = {};\n  state.anchorMap = {};\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    skipSeparationSpace(state, true, -1);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (state.lineIndent > 0 || ch !== 0x25/* % */) {\n      break;\n    }\n\n    hasDirectives = true;\n    ch = state.input.charCodeAt(++state.position);\n    _position = state.position;\n\n    while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    directiveName = state.input.slice(_position, state.position);\n    directiveArgs = [];\n\n    if (directiveName.length < 1) {\n      throwError(state, 'directive name must not be less than one character in length');\n    }\n\n    while (ch !== 0) {\n      while (is_WHITE_SPACE(ch)) {\n        ch = state.input.charCodeAt(++state.position);\n      }\n\n      if (ch === 0x23/* # */) {\n        do { ch = state.input.charCodeAt(++state.position); }\n        while (ch !== 0 && !is_EOL(ch));\n        break;\n      }\n\n      if (is_EOL(ch)) break;\n\n      _position = state.position;\n\n      while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n        ch = state.input.charCodeAt(++state.position);\n      }\n\n      directiveArgs.push(state.input.slice(_position, state.position));\n    }\n\n    if (ch !== 0) readLineBreak(state);\n\n    if (_hasOwnProperty.call(directiveHandlers, directiveName)) {\n      directiveHandlers[directiveName](state, directiveName, directiveArgs);\n    } else {\n      throwWarning(state, 'unknown document directive \"' + directiveName + '\"');\n    }\n  }\n\n  skipSeparationSpace(state, true, -1);\n\n  if (state.lineIndent === 0 &&\n      state.input.charCodeAt(state.position)     === 0x2D/* - */ &&\n      state.input.charCodeAt(state.position + 1) === 0x2D/* - */ &&\n      state.input.charCodeAt(state.position + 2) === 0x2D/* - */) {\n    state.position += 3;\n    skipSeparationSpace(state, true, -1);\n\n  } else if (hasDirectives) {\n    throwError(state, 'directives end mark is expected');\n  }\n\n  composeNode(state, state.lineIndent - 1, CONTEXT_BLOCK_OUT, false, true);\n  skipSeparationSpace(state, true, -1);\n\n  if (state.checkLineBreaks &&\n      PATTERN_NON_ASCII_LINE_BREAKS.test(state.input.slice(documentStart, state.position))) {\n    throwWarning(state, 'non-ASCII line breaks are interpreted as content');\n  }\n\n  state.documents.push(state.result);\n\n  if (state.position === state.lineStart && testDocumentSeparator(state)) {\n\n    if (state.input.charCodeAt(state.position) === 0x2E/* . */) {\n      state.position += 3;\n      skipSeparationSpace(state, true, -1);\n    }\n    return;\n  }\n\n  if (state.position < (state.length - 1)) {\n    throwError(state, 'end of the stream or a document separator is expected');\n  } else {\n    return;\n  }\n}\n\n\nfunction loadDocuments(input, options) {\n  input = String(input);\n  options = options || {};\n\n  if (input.length !== 0) {\n\n    // Add tailing `\\n` if not exists\n    if (input.charCodeAt(input.length - 1) !== 0x0A/* LF */ &&\n        input.charCodeAt(input.length - 1) !== 0x0D/* CR */) {\n      input += '\\n';\n    }\n\n    // Strip BOM\n    if (input.charCodeAt(0) === 0xFEFF) {\n      input = input.slice(1);\n    }\n  }\n\n  var state = new State(input, options);\n\n  // Use 0 as string terminator. That significantly simplifies bounds check.\n  state.input += '\\0';\n\n  while (state.input.charCodeAt(state.position) === 0x20/* Space */) {\n    state.lineIndent += 1;\n    state.position += 1;\n  }\n\n  while (state.position < (state.length - 1)) {\n    readDocument(state);\n  }\n\n  return state.documents;\n}\n\n\nfunction loadAll(input, iterator, options) {\n  var documents = loadDocuments(input, options), index, length;\n\n  for (index = 0, length = documents.length; index < length; index += 1) {\n    iterator(documents[index]);\n  }\n}\n\n\nfunction load(input, options) {\n  var documents = loadDocuments(input, options);\n\n  if (documents.length === 0) {\n    /*eslint-disable no-undefined*/\n    return undefined;\n  } else if (documents.length === 1) {\n    return documents[0];\n  }\n  throw new YAMLException('expected a single document in the stream, but found more');\n}\n\n\nfunction safeLoadAll(input, output, options) {\n  loadAll(input, output, common.extend({ schema: DEFAULT_SAFE_SCHEMA }, options));\n}\n\n\nfunction safeLoad(input, options) {\n  return load(input, common.extend({ schema: DEFAULT_SAFE_SCHEMA }, options));\n}\n\n\nmodule.exports.loadAll     = loadAll;\nmodule.exports.load        = load;\nmodule.exports.safeLoadAll = safeLoadAll;\nmodule.exports.safeLoad    = safeLoad;\n\n},{\"./common\":2,\"./exception\":4,\"./mark\":6,\"./schema/default_full\":9,\"./schema/default_safe\":10}],6:[function(require,module,exports){\n'use strict';\n\n\nvar common = require('./common');\n\n\nfunction Mark(name, buffer, position, line, column) {\n  this.name     = name;\n  this.buffer   = buffer;\n  this.position = position;\n  this.line     = line;\n  this.column   = column;\n}\n\n\nMark.prototype.getSnippet = function getSnippet(indent, maxLength) {\n  var head, start, tail, end, snippet;\n\n  if (!this.buffer) return null;\n\n  indent = indent || 4;\n  maxLength = maxLength || 75;\n\n  head = '';\n  start = this.position;\n\n  while (start > 0 && '\\x00\\r\\n\\x85\\u2028\\u2029'.indexOf(this.buffer.charAt(start - 1)) === -1) {\n    start -= 1;\n    if (this.position - start > (maxLength / 2 - 1)) {\n      head = ' ... ';\n      start += 5;\n      break;\n    }\n  }\n\n  tail = '';\n  end = this.position;\n\n  while (end < this.buffer.length && '\\x00\\r\\n\\x85\\u2028\\u2029'.indexOf(this.buffer.charAt(end)) === -1) {\n    end += 1;\n    if (end - this.position > (maxLength / 2 - 1)) {\n      tail = ' ... ';\n      end -= 5;\n      break;\n    }\n  }\n\n  snippet = this.buffer.slice(start, end);\n\n  return common.repeat(' ', indent) + head + snippet + tail + '\\n' +\n         common.repeat(' ', indent + this.position - start + head.length) + '^';\n};\n\n\nMark.prototype.toString = function toString(compact) {\n  var snippet, where = '';\n\n  if (this.name) {\n    where += 'in \"' + this.name + '\" ';\n  }\n\n  where += 'at line ' + (this.line + 1) + ', column ' + (this.column + 1);\n\n  if (!compact) {\n    snippet = this.getSnippet();\n\n    if (snippet) {\n      where += ':\\n' + snippet;\n    }\n  }\n\n  return where;\n};\n\n\nmodule.exports = Mark;\n\n},{\"./common\":2}],7:[function(require,module,exports){\n'use strict';\n\n/*eslint-disable max-len*/\n\nvar common        = require('./common');\nvar YAMLException = require('./exception');\nvar Type          = require('./type');\n\n\nfunction compileList(schema, name, result) {\n  var exclude = [];\n\n  schema.include.forEach(function (includedSchema) {\n    result = compileList(includedSchema, name, result);\n  });\n\n  schema[name].forEach(function (currentType) {\n    result.forEach(function (previousType, previousIndex) {\n      if (previousType.tag === currentType.tag && previousType.kind === currentType.kind) {\n        exclude.push(previousIndex);\n      }\n    });\n\n    result.push(currentType);\n  });\n\n  return result.filter(function (type, index) {\n    return exclude.indexOf(index) === -1;\n  });\n}\n\n\nfunction compileMap(/* lists... */) {\n  var result = {\n        scalar: {},\n        sequence: {},\n        mapping: {},\n        fallback: {}\n      }, index, length;\n\n  function collectType(type) {\n    result[type.kind][type.tag] = result['fallback'][type.tag] = type;\n  }\n\n  for (index = 0, length = arguments.length; index < length; index += 1) {\n    arguments[index].forEach(collectType);\n  }\n  return result;\n}\n\n\nfunction Schema(definition) {\n  this.include  = definition.include  || [];\n  this.implicit = definition.implicit || [];\n  this.explicit = definition.explicit || [];\n\n  this.implicit.forEach(function (type) {\n    if (type.loadKind && type.loadKind !== 'scalar') {\n      throw new YAMLException('There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.');\n    }\n  });\n\n  this.compiledImplicit = compileList(this, 'implicit', []);\n  this.compiledExplicit = compileList(this, 'explicit', []);\n  this.compiledTypeMap  = compileMap(this.compiledImplicit, this.compiledExplicit);\n}\n\n\nSchema.DEFAULT = null;\n\n\nSchema.create = function createSchema() {\n  var schemas, types;\n\n  switch (arguments.length) {\n    case 1:\n      schemas = Schema.DEFAULT;\n      types = arguments[0];\n      break;\n\n    case 2:\n      schemas = arguments[0];\n      types = arguments[1];\n      break;\n\n    default:\n      throw new YAMLException('Wrong number of arguments for Schema.create function');\n  }\n\n  schemas = common.toArray(schemas);\n  types = common.toArray(types);\n\n  if (!schemas.every(function (schema) { return schema instanceof Schema; })) {\n    throw new YAMLException('Specified list of super schemas (or a single Schema object) contains a non-Schema object.');\n  }\n\n  if (!types.every(function (type) { return type instanceof Type; })) {\n    throw new YAMLException('Specified list of YAML types (or a single Type object) contains a non-Type object.');\n  }\n\n  return new Schema({\n    include: schemas,\n    explicit: types\n  });\n};\n\n\nmodule.exports = Schema;\n\n},{\"./common\":2,\"./exception\":4,\"./type\":13}],8:[function(require,module,exports){\n// Standard YAML's Core schema.\n// http://www.yaml.org/spec/1.2/spec.html#id2804923\n//\n// NOTE: JS-YAML does not support schema-specific tag resolution restrictions.\n// So, Core schema has no distinctions from JSON schema is JS-YAML.\n\n\n'use strict';\n\n\nvar Schema = require('../schema');\n\n\nmodule.exports = new Schema({\n  include: [\n    require('./json')\n  ]\n});\n\n},{\"../schema\":7,\"./json\":12}],9:[function(require,module,exports){\n// JS-YAML's default schema for `load` function.\n// It is not described in the YAML specification.\n//\n// This schema is based on JS-YAML's default safe schema and includes\n// JavaScript-specific types: !!js/undefined, !!js/regexp and !!js/function.\n//\n// Also this schema is used as default base schema at `Schema.create` function.\n\n\n'use strict';\n\n\nvar Schema = require('../schema');\n\n\nmodule.exports = Schema.DEFAULT = new Schema({\n  include: [\n    require('./default_safe')\n  ],\n  explicit: [\n    require('../type/js/undefined'),\n    require('../type/js/regexp'),\n    require('../type/js/function')\n  ]\n});\n\n},{\"../schema\":7,\"../type/js/function\":18,\"../type/js/regexp\":19,\"../type/js/undefined\":20,\"./default_safe\":10}],10:[function(require,module,exports){\n// JS-YAML's default schema for `safeLoad` function.\n// It is not described in the YAML specification.\n//\n// This schema is based on standard YAML's Core schema and includes most of\n// extra types described at YAML tag repository. (http://yaml.org/type/)\n\n\n'use strict';\n\n\nvar Schema = require('../schema');\n\n\nmodule.exports = new Schema({\n  include: [\n    require('./core')\n  ],\n  implicit: [\n    require('../type/timestamp'),\n    require('../type/merge')\n  ],\n  explicit: [\n    require('../type/binary'),\n    require('../type/omap'),\n    require('../type/pairs'),\n    require('../type/set')\n  ]\n});\n\n},{\"../schema\":7,\"../type/binary\":14,\"../type/merge\":22,\"../type/omap\":24,\"../type/pairs\":25,\"../type/set\":27,\"../type/timestamp\":29,\"./core\":8}],11:[function(require,module,exports){\n// Standard YAML's Failsafe schema.\n// http://www.yaml.org/spec/1.2/spec.html#id2802346\n\n\n'use strict';\n\n\nvar Schema = require('../schema');\n\n\nmodule.exports = new Schema({\n  explicit: [\n    require('../type/str'),\n    require('../type/seq'),\n    require('../type/map')\n  ]\n});\n\n},{\"../schema\":7,\"../type/map\":21,\"../type/seq\":26,\"../type/str\":28}],12:[function(require,module,exports){\n// Standard YAML's JSON schema.\n// http://www.yaml.org/spec/1.2/spec.html#id2803231\n//\n// NOTE: JS-YAML does not support schema-specific tag resolution restrictions.\n// So, this schema is not such strict as defined in the YAML specification.\n// It allows numbers in binary notaion, use `Null` and `NULL` as `null`, etc.\n\n\n'use strict';\n\n\nvar Schema = require('../schema');\n\n\nmodule.exports = new Schema({\n  include: [\n    require('./failsafe')\n  ],\n  implicit: [\n    require('../type/null'),\n    require('../type/bool'),\n    require('../type/int'),\n    require('../type/float')\n  ]\n});\n\n},{\"../schema\":7,\"../type/bool\":15,\"../type/float\":16,\"../type/int\":17,\"../type/null\":23,\"./failsafe\":11}],13:[function(require,module,exports){\n'use strict';\n\nvar YAMLException = require('./exception');\n\nvar TYPE_CONSTRUCTOR_OPTIONS = [\n  'kind',\n  'resolve',\n  'construct',\n  'instanceOf',\n  'predicate',\n  'represent',\n  'defaultStyle',\n  'styleAliases'\n];\n\nvar YAML_NODE_KINDS = [\n  'scalar',\n  'sequence',\n  'mapping'\n];\n\nfunction compileStyleAliases(map) {\n  var result = {};\n\n  if (map !== null) {\n    Object.keys(map).forEach(function (style) {\n      map[style].forEach(function (alias) {\n        result[String(alias)] = style;\n      });\n    });\n  }\n\n  return result;\n}\n\nfunction Type(tag, options) {\n  options = options || {};\n\n  Object.keys(options).forEach(function (name) {\n    if (TYPE_CONSTRUCTOR_OPTIONS.indexOf(name) === -1) {\n      throw new YAMLException('Unknown option \"' + name + '\" is met in definition of \"' + tag + '\" YAML type.');\n    }\n  });\n\n  // TODO: Add tag format check.\n  this.tag          = tag;\n  this.kind         = options['kind']         || null;\n  this.resolve      = options['resolve']      || function () { return true; };\n  this.construct    = options['construct']    || function (data) { return data; };\n  this.instanceOf   = options['instanceOf']   || null;\n  this.predicate    = options['predicate']    || null;\n  this.represent    = options['represent']    || null;\n  this.defaultStyle = options['defaultStyle'] || null;\n  this.styleAliases = compileStyleAliases(options['styleAliases'] || null);\n\n  if (YAML_NODE_KINDS.indexOf(this.kind) === -1) {\n    throw new YAMLException('Unknown kind \"' + this.kind + '\" is specified for \"' + tag + '\" YAML type.');\n  }\n}\n\nmodule.exports = Type;\n\n},{\"./exception\":4}],14:[function(require,module,exports){\n'use strict';\n\n/*eslint-disable no-bitwise*/\n\nvar NodeBuffer;\n\ntry {\n  // A trick for browserified version, to not include `Buffer` shim\n  var _require = require;\n  NodeBuffer = _require('buffer').Buffer;\n} catch (__) {}\n\nvar Type       = require('../type');\n\n\n// [ 64, 65, 66 ] -> [ padding, CR, LF ]\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\\n\\r';\n\n\nfunction resolveYamlBinary(data) {\n  if (data === null) return false;\n\n  var code, idx, bitlen = 0, max = data.length, map = BASE64_MAP;\n\n  // Convert one by one.\n  for (idx = 0; idx < max; idx++) {\n    code = map.indexOf(data.charAt(idx));\n\n    // Skip CR/LF\n    if (code > 64) continue;\n\n    // Fail on illegal characters\n    if (code < 0) return false;\n\n    bitlen += 6;\n  }\n\n  // If there are any bits left, source was corrupted\n  return (bitlen % 8) === 0;\n}\n\nfunction constructYamlBinary(data) {\n  var idx, tailbits,\n      input = data.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max = input.length,\n      map = BASE64_MAP,\n      bits = 0,\n      result = [];\n\n  // Collect by 6*4 bits (3 bytes)\n\n  for (idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      result.push((bits >> 16) & 0xFF);\n      result.push((bits >> 8) & 0xFF);\n      result.push(bits & 0xFF);\n    }\n\n    bits = (bits << 6) | map.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    result.push((bits >> 16) & 0xFF);\n    result.push((bits >> 8) & 0xFF);\n    result.push(bits & 0xFF);\n  } else if (tailbits === 18) {\n    result.push((bits >> 10) & 0xFF);\n    result.push((bits >> 2) & 0xFF);\n  } else if (tailbits === 12) {\n    result.push((bits >> 4) & 0xFF);\n  }\n\n  // Wrap into Buffer for NodeJS and leave Array for browser\n  if (NodeBuffer) {\n    // Support node 6.+ Buffer API when available\n    return NodeBuffer.from ? NodeBuffer.from(result) : new NodeBuffer(result);\n  }\n\n  return result;\n}\n\nfunction representYamlBinary(object /*, style*/) {\n  var result = '', bits = 0, idx, tail,\n      max = object.length,\n      map = BASE64_MAP;\n\n  // Convert every three bytes to 4 ASCII characters.\n\n  for (idx = 0; idx < max; idx++) {\n    if ((idx % 3 === 0) && idx) {\n      result += map[(bits >> 18) & 0x3F];\n      result += map[(bits >> 12) & 0x3F];\n      result += map[(bits >> 6) & 0x3F];\n      result += map[bits & 0x3F];\n    }\n\n    bits = (bits << 8) + object[idx];\n  }\n\n  // Dump tail\n\n  tail = max % 3;\n\n  if (tail === 0) {\n    result += map[(bits >> 18) & 0x3F];\n    result += map[(bits >> 12) & 0x3F];\n    result += map[(bits >> 6) & 0x3F];\n    result += map[bits & 0x3F];\n  } else if (tail === 2) {\n    result += map[(bits >> 10) & 0x3F];\n    result += map[(bits >> 4) & 0x3F];\n    result += map[(bits << 2) & 0x3F];\n    result += map[64];\n  } else if (tail === 1) {\n    result += map[(bits >> 2) & 0x3F];\n    result += map[(bits << 4) & 0x3F];\n    result += map[64];\n    result += map[64];\n  }\n\n  return result;\n}\n\nfunction isBinary(object) {\n  return NodeBuffer && NodeBuffer.isBuffer(object);\n}\n\nmodule.exports = new Type('tag:yaml.org,2002:binary', {\n  kind: 'scalar',\n  resolve: resolveYamlBinary,\n  construct: constructYamlBinary,\n  predicate: isBinary,\n  represent: representYamlBinary\n});\n\n},{\"../type\":13}],15:[function(require,module,exports){\n'use strict';\n\nvar Type = require('../type');\n\nfunction resolveYamlBoolean(data) {\n  if (data === null) return false;\n\n  var max = data.length;\n\n  return (max === 4 && (data === 'true' || data === 'True' || data === 'TRUE')) ||\n         (max === 5 && (data === 'false' || data === 'False' || data === 'FALSE'));\n}\n\nfunction constructYamlBoolean(data) {\n  return data === 'true' ||\n         data === 'True' ||\n         data === 'TRUE';\n}\n\nfunction isBoolean(object) {\n  return Object.prototype.toString.call(object) === '[object Boolean]';\n}\n\nmodule.exports = new Type('tag:yaml.org,2002:bool', {\n  kind: 'scalar',\n  resolve: resolveYamlBoolean,\n  construct: constructYamlBoolean,\n  predicate: isBoolean,\n  represent: {\n    lowercase: function (object) { return object ? 'true' : 'false'; },\n    uppercase: function (object) { return object ? 'TRUE' : 'FALSE'; },\n    camelcase: function (object) { return object ? 'True' : 'False'; }\n  },\n  defaultStyle: 'lowercase'\n});\n\n},{\"../type\":13}],16:[function(require,module,exports){\n'use strict';\n\nvar common = require('../common');\nvar Type   = require('../type');\n\nvar YAML_FLOAT_PATTERN = new RegExp(\n  // 2.5e4, 2.5 and integers\n  '^(?:[-+]?(?:0|[1-9][0-9_]*)(?:\\\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?' +\n  // .2e4, .2\n  // special case, seems not from spec\n  '|\\\\.[0-9_]+(?:[eE][-+]?[0-9]+)?' +\n  // 20:59\n  '|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\\\\.[0-9_]*' +\n  // .inf\n  '|[-+]?\\\\.(?:inf|Inf|INF)' +\n  // .nan\n  '|\\\\.(?:nan|NaN|NAN))$');\n\nfunction resolveYamlFloat(data) {\n  if (data === null) return false;\n\n  if (!YAML_FLOAT_PATTERN.test(data) ||\n      // Quick hack to not allow integers end with `_`\n      // Probably should update regexp & check speed\n      data[data.length - 1] === '_') {\n    return false;\n  }\n\n  return true;\n}\n\nfunction constructYamlFloat(data) {\n  var value, sign, base, digits;\n\n  value  = data.replace(/_/g, '').toLowerCase();\n  sign   = value[0] === '-' ? -1 : 1;\n  digits = [];\n\n  if ('+-'.indexOf(value[0]) >= 0) {\n    value = value.slice(1);\n  }\n\n  if (value === '.inf') {\n    return (sign === 1) ? Number.POSITIVE_INFINITY : Number.NEGATIVE_INFINITY;\n\n  } else if (value === '.nan') {\n    return NaN;\n\n  } else if (value.indexOf(':') >= 0) {\n    value.split(':').forEach(function (v) {\n      digits.unshift(parseFloat(v, 10));\n    });\n\n    value = 0.0;\n    base = 1;\n\n    digits.forEach(function (d) {\n      value += d * base;\n      base *= 60;\n    });\n\n    return sign * value;\n\n  }\n  return sign * parseFloat(value, 10);\n}\n\n\nvar SCIENTIFIC_WITHOUT_DOT = /^[-+]?[0-9]+e/;\n\nfunction representYamlFloat(object, style) {\n  var res;\n\n  if (isNaN(object)) {\n    switch (style) {\n      case 'lowercase': return '.nan';\n      case 'uppercase': return '.NAN';\n      case 'camelcase': return '.NaN';\n    }\n  } else if (Number.POSITIVE_INFINITY === object) {\n    switch (style) {\n      case 'lowercase': return '.inf';\n      case 'uppercase': return '.INF';\n      case 'camelcase': return '.Inf';\n    }\n  } else if (Number.NEGATIVE_INFINITY === object) {\n    switch (style) {\n      case 'lowercase': return '-.inf';\n      case 'uppercase': return '-.INF';\n      case 'camelcase': return '-.Inf';\n    }\n  } else if (common.isNegativeZero(object)) {\n    return '-0.0';\n  }\n\n  res = object.toString(10);\n\n  // JS stringifier can build scientific format without dots: 5e-100,\n  // while YAML requres dot: 5.e-100. Fix it with simple hack\n\n  return SCIENTIFIC_WITHOUT_DOT.test(res) ? res.replace('e', '.e') : res;\n}\n\nfunction isFloat(object) {\n  return (Object.prototype.toString.call(object) === '[object Number]') &&\n         (object % 1 !== 0 || common.isNegativeZero(object));\n}\n\nmodule.exports = new Type('tag:yaml.org,2002:float', {\n  kind: 'scalar',\n  resolve: resolveYamlFloat,\n  construct: constructYamlFloat,\n  predicate: isFloat,\n  represent: representYamlFloat,\n  defaultStyle: 'lowercase'\n});\n\n},{\"../common\":2,\"../type\":13}],17:[function(require,module,exports){\n'use strict';\n\nvar common = require('../common');\nvar Type   = require('../type');\n\nfunction isHexCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) ||\n         ((0x41/* A */ <= c) && (c <= 0x46/* F */)) ||\n         ((0x61/* a */ <= c) && (c <= 0x66/* f */));\n}\n\nfunction isOctCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x37/* 7 */));\n}\n\nfunction isDecCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */));\n}\n\nfunction resolveYamlInteger(data) {\n  if (data === null) return false;\n\n  var max = data.length,\n      index = 0,\n      hasDigits = false,\n      ch;\n\n  if (!max) return false;\n\n  ch = data[index];\n\n  // sign\n  if (ch === '-' || ch === '+') {\n    ch = data[++index];\n  }\n\n  if (ch === '0') {\n    // 0\n    if (index + 1 === max) return true;\n    ch = data[++index];\n\n    // base 2, base 8, base 16\n\n    if (ch === 'b') {\n      // base 2\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (ch !== '0' && ch !== '1') return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n\n\n    if (ch === 'x') {\n      // base 16\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (!isHexCode(data.charCodeAt(index))) return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n\n    // base 8\n    for (; index < max; index++) {\n      ch = data[index];\n      if (ch === '_') continue;\n      if (!isOctCode(data.charCodeAt(index))) return false;\n      hasDigits = true;\n    }\n    return hasDigits && ch !== '_';\n  }\n\n  // base 10 (except 0) or base 60\n\n  // value should not start with `_`;\n  if (ch === '_') return false;\n\n  for (; index < max; index++) {\n    ch = data[index];\n    if (ch === '_') continue;\n    if (ch === ':') break;\n    if (!isDecCode(data.charCodeAt(index))) {\n      return false;\n    }\n    hasDigits = true;\n  }\n\n  // Should have digits and should not end with `_`\n  if (!hasDigits || ch === '_') return false;\n\n  // if !base60 - done;\n  if (ch !== ':') return true;\n\n  // base60 almost not used, no needs to optimize\n  return /^(:[0-5]?[0-9])+$/.test(data.slice(index));\n}\n\nfunction constructYamlInteger(data) {\n  var value = data, sign = 1, ch, base, digits = [];\n\n  if (value.indexOf('_') !== -1) {\n    value = value.replace(/_/g, '');\n  }\n\n  ch = value[0];\n\n  if (ch === '-' || ch === '+') {\n    if (ch === '-') sign = -1;\n    value = value.slice(1);\n    ch = value[0];\n  }\n\n  if (value === '0') return 0;\n\n  if (ch === '0') {\n    if (value[1] === 'b') return sign * parseInt(value.slice(2), 2);\n    if (value[1] === 'x') return sign * parseInt(value, 16);\n    return sign * parseInt(value, 8);\n  }\n\n  if (value.indexOf(':') !== -1) {\n    value.split(':').forEach(function (v) {\n      digits.unshift(parseInt(v, 10));\n    });\n\n    value = 0;\n    base = 1;\n\n    digits.forEach(function (d) {\n      value += (d * base);\n      base *= 60;\n    });\n\n    return sign * value;\n\n  }\n\n  return sign * parseInt(value, 10);\n}\n\nfunction isInteger(object) {\n  return (Object.prototype.toString.call(object)) === '[object Number]' &&\n         (object % 1 === 0 && !common.isNegativeZero(object));\n}\n\nmodule.exports = new Type('tag:yaml.org,2002:int', {\n  kind: 'scalar',\n  resolve: resolveYamlInteger,\n  construct: constructYamlInteger,\n  predicate: isInteger,\n  represent: {\n    binary:      function (object) { return '0b' + object.toString(2); },\n    octal:       function (object) { return '0'  + object.toString(8); },\n    decimal:     function (object) { return        object.toString(10); },\n    hexadecimal: function (object) { return '0x' + object.toString(16).toUpperCase(); }\n  },\n  defaultStyle: 'decimal',\n  styleAliases: {\n    binary:      [ 2,  'bin' ],\n    octal:       [ 8,  'oct' ],\n    decimal:     [ 10, 'dec' ],\n    hexadecimal: [ 16, 'hex' ]\n  }\n});\n\n},{\"../common\":2,\"../type\":13}],18:[function(require,module,exports){\n'use strict';\n\nvar esprima;\n\n// Browserified version does not have esprima\n//\n// 1. For node.js just require module as deps\n// 2. For browser try to require mudule via external AMD system.\n//    If not found - try to fallback to window.esprima. If not\n//    found too - then fail to parse.\n//\ntry {\n  // workaround to exclude package from browserify list.\n  var _require = require;\n  esprima = _require('esprima');\n} catch (_) {\n  /*global window */\n  if (typeof window !== 'undefined') esprima = window.esprima;\n}\n\nvar Type = require('../../type');\n\nfunction resolveJavascriptFunction(data) {\n  if (data === null) return false;\n\n  try {\n    var source = '(' + data + ')',\n        ast    = esprima.parse(source, { range: true });\n\n    if (ast.type                    !== 'Program'             ||\n        ast.body.length             !== 1                     ||\n        ast.body[0].type            !== 'ExpressionStatement' ||\n        ast.body[0].expression.type !== 'FunctionExpression') {\n      return false;\n    }\n\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\n\nfunction constructJavascriptFunction(data) {\n  /*jslint evil:true*/\n\n  var source = '(' + data + ')',\n      ast    = esprima.parse(source, { range: true }),\n      params = [],\n      body;\n\n  if (ast.type                    !== 'Program'             ||\n      ast.body.length             !== 1                     ||\n      ast.body[0].type            !== 'ExpressionStatement' ||\n      ast.body[0].expression.type !== 'FunctionExpression') {\n    throw new Error('Failed to resolve function');\n  }\n\n  ast.body[0].expression.params.forEach(function (param) {\n    params.push(param.name);\n  });\n\n  body = ast.body[0].expression.body.range;\n\n  // Esprima's ranges include the first '{' and the last '}' characters on\n  // function expressions. So cut them out.\n  /*eslint-disable no-new-func*/\n  return new Function(params, source.slice(body[0] + 1, body[1] - 1));\n}\n\nfunction representJavascriptFunction(object /*, style*/) {\n  return object.toString();\n}\n\nfunction isFunction(object) {\n  return Object.prototype.toString.call(object) === '[object Function]';\n}\n\nmodule.exports = new Type('tag:yaml.org,2002:js/function', {\n  kind: 'scalar',\n  resolve: resolveJavascriptFunction,\n  construct: constructJavascriptFunction,\n  predicate: isFunction,\n  represent: representJavascriptFunction\n});\n\n},{\"../../type\":13}],19:[function(require,module,exports){\n'use strict';\n\nvar Type = require('../../type');\n\nfunction resolveJavascriptRegExp(data) {\n  if (data === null) return false;\n  if (data.length === 0) return false;\n\n  var regexp = data,\n      tail   = /\\/([gim]*)$/.exec(data),\n      modifiers = '';\n\n  // if regexp starts with '/' it can have modifiers and must be properly closed\n  // `/foo/gim` - modifiers tail can be maximum 3 chars\n  if (regexp[0] === '/') {\n    if (tail) modifiers = tail[1];\n\n    if (modifiers.length > 3) return false;\n    // if expression starts with /, is should be properly terminated\n    if (regexp[regexp.length - modifiers.length - 1] !== '/') return false;\n  }\n\n  return true;\n}\n\nfunction constructJavascriptRegExp(data) {\n  var regexp = data,\n      tail   = /\\/([gim]*)$/.exec(data),\n      modifiers = '';\n\n  // `/foo/gim` - tail can be maximum 4 chars\n  if (regexp[0] === '/') {\n    if (tail) modifiers = tail[1];\n    regexp = regexp.slice(1, regexp.length - modifiers.length - 1);\n  }\n\n  return new RegExp(regexp, modifiers);\n}\n\nfunction representJavascriptRegExp(object /*, style*/) {\n  var result = '/' + object.source + '/';\n\n  if (object.global) result += 'g';\n  if (object.multiline) result += 'm';\n  if (object.ignoreCase) result += 'i';\n\n  return result;\n}\n\nfunction isRegExp(object) {\n  return Object.prototype.toString.call(object) === '[object RegExp]';\n}\n\nmodule.exports = new Type('tag:yaml.org,2002:js/regexp', {\n  kind: 'scalar',\n  resolve: resolveJavascriptRegExp,\n  construct: constructJavascriptRegExp,\n  predicate: isRegExp,\n  represent: representJavascriptRegExp\n});\n\n},{\"../../type\":13}],20:[function(require,module,exports){\n'use strict';\n\nvar Type = require('../../type');\n\nfunction resolveJavascriptUndefined() {\n  return true;\n}\n\nfunction constructJavascriptUndefined() {\n  /*eslint-disable no-undefined*/\n  return undefined;\n}\n\nfunction representJavascriptUndefined() {\n  return '';\n}\n\nfunction isUndefined(object) {\n  return typeof object === 'undefined';\n}\n\nmodule.exports = new Type('tag:yaml.org,2002:js/undefined', {\n  kind: 'scalar',\n  resolve: resolveJavascriptUndefined,\n  construct: constructJavascriptUndefined,\n  predicate: isUndefined,\n  represent: representJavascriptUndefined\n});\n\n},{\"../../type\":13}],21:[function(require,module,exports){\n'use strict';\n\nvar Type = require('../type');\n\nmodule.exports = new Type('tag:yaml.org,2002:map', {\n  kind: 'mapping',\n  construct: function (data) { return data !== null ? data : {}; }\n});\n\n},{\"../type\":13}],22:[function(require,module,exports){\n'use strict';\n\nvar Type = require('../type');\n\nfunction resolveYamlMerge(data) {\n  return data === '<<' || data === null;\n}\n\nmodule.exports = new Type('tag:yaml.org,2002:merge', {\n  kind: 'scalar',\n  resolve: resolveYamlMerge\n});\n\n},{\"../type\":13}],23:[function(require,module,exports){\n'use strict';\n\nvar Type = require('../type');\n\nfunction resolveYamlNull(data) {\n  if (data === null) return true;\n\n  var max = data.length;\n\n  return (max === 1 && data === '~') ||\n         (max === 4 && (data === 'null' || data === 'Null' || data === 'NULL'));\n}\n\nfunction constructYamlNull() {\n  return null;\n}\n\nfunction isNull(object) {\n  return object === null;\n}\n\nmodule.exports = new Type('tag:yaml.org,2002:null', {\n  kind: 'scalar',\n  resolve: resolveYamlNull,\n  construct: constructYamlNull,\n  predicate: isNull,\n  represent: {\n    canonical: function () { return '~';    },\n    lowercase: function () { return 'null'; },\n    uppercase: function () { return 'NULL'; },\n    camelcase: function () { return 'Null'; }\n  },\n  defaultStyle: 'lowercase'\n});\n\n},{\"../type\":13}],24:[function(require,module,exports){\n'use strict';\n\nvar Type = require('../type');\n\nvar _hasOwnProperty = Object.prototype.hasOwnProperty;\nvar _toString       = Object.prototype.toString;\n\nfunction resolveYamlOmap(data) {\n  if (data === null) return true;\n\n  var objectKeys = [], index, length, pair, pairKey, pairHasKey,\n      object = data;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n    pairHasKey = false;\n\n    if (_toString.call(pair) !== '[object Object]') return false;\n\n    for (pairKey in pair) {\n      if (_hasOwnProperty.call(pair, pairKey)) {\n        if (!pairHasKey) pairHasKey = true;\n        else return false;\n      }\n    }\n\n    if (!pairHasKey) return false;\n\n    if (objectKeys.indexOf(pairKey) === -1) objectKeys.push(pairKey);\n    else return false;\n  }\n\n  return true;\n}\n\nfunction constructYamlOmap(data) {\n  return data !== null ? data : [];\n}\n\nmodule.exports = new Type('tag:yaml.org,2002:omap', {\n  kind: 'sequence',\n  resolve: resolveYamlOmap,\n  construct: constructYamlOmap\n});\n\n},{\"../type\":13}],25:[function(require,module,exports){\n'use strict';\n\nvar Type = require('../type');\n\nvar _toString = Object.prototype.toString;\n\nfunction resolveYamlPairs(data) {\n  if (data === null) return true;\n\n  var index, length, pair, keys, result,\n      object = data;\n\n  result = new Array(object.length);\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n\n    if (_toString.call(pair) !== '[object Object]') return false;\n\n    keys = Object.keys(pair);\n\n    if (keys.length !== 1) return false;\n\n    result[index] = [ keys[0], pair[keys[0]] ];\n  }\n\n  return true;\n}\n\nfunction constructYamlPairs(data) {\n  if (data === null) return [];\n\n  var index, length, pair, keys, result,\n      object = data;\n\n  result = new Array(object.length);\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n\n    keys = Object.keys(pair);\n\n    result[index] = [ keys[0], pair[keys[0]] ];\n  }\n\n  return result;\n}\n\nmodule.exports = new Type('tag:yaml.org,2002:pairs', {\n  kind: 'sequence',\n  resolve: resolveYamlPairs,\n  construct: constructYamlPairs\n});\n\n},{\"../type\":13}],26:[function(require,module,exports){\n'use strict';\n\nvar Type = require('../type');\n\nmodule.exports = new Type('tag:yaml.org,2002:seq', {\n  kind: 'sequence',\n  construct: function (data) { return data !== null ? data : []; }\n});\n\n},{\"../type\":13}],27:[function(require,module,exports){\n'use strict';\n\nvar Type = require('../type');\n\nvar _hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction resolveYamlSet(data) {\n  if (data === null) return true;\n\n  var key, object = data;\n\n  for (key in object) {\n    if (_hasOwnProperty.call(object, key)) {\n      if (object[key] !== null) return false;\n    }\n  }\n\n  return true;\n}\n\nfunction constructYamlSet(data) {\n  return data !== null ? data : {};\n}\n\nmodule.exports = new Type('tag:yaml.org,2002:set', {\n  kind: 'mapping',\n  resolve: resolveYamlSet,\n  construct: constructYamlSet\n});\n\n},{\"../type\":13}],28:[function(require,module,exports){\n'use strict';\n\nvar Type = require('../type');\n\nmodule.exports = new Type('tag:yaml.org,2002:str', {\n  kind: 'scalar',\n  construct: function (data) { return data !== null ? data : ''; }\n});\n\n},{\"../type\":13}],29:[function(require,module,exports){\n'use strict';\n\nvar Type = require('../type');\n\nvar YAML_DATE_REGEXP = new RegExp(\n  '^([0-9][0-9][0-9][0-9])'          + // [1] year\n  '-([0-9][0-9])'                    + // [2] month\n  '-([0-9][0-9])$');                   // [3] day\n\nvar YAML_TIMESTAMP_REGEXP = new RegExp(\n  '^([0-9][0-9][0-9][0-9])'          + // [1] year\n  '-([0-9][0-9]?)'                   + // [2] month\n  '-([0-9][0-9]?)'                   + // [3] day\n  '(?:[Tt]|[ \\\\t]+)'                 + // ...\n  '([0-9][0-9]?)'                    + // [4] hour\n  ':([0-9][0-9])'                    + // [5] minute\n  ':([0-9][0-9])'                    + // [6] second\n  '(?:\\\\.([0-9]*))?'                 + // [7] fraction\n  '(?:[ \\\\t]*(Z|([-+])([0-9][0-9]?)' + // [8] tz [9] tz_sign [10] tz_hour\n  '(?::([0-9][0-9]))?))?$');           // [11] tz_minute\n\nfunction resolveYamlTimestamp(data) {\n  if (data === null) return false;\n  if (YAML_DATE_REGEXP.exec(data) !== null) return true;\n  if (YAML_TIMESTAMP_REGEXP.exec(data) !== null) return true;\n  return false;\n}\n\nfunction constructYamlTimestamp(data) {\n  var match, year, month, day, hour, minute, second, fraction = 0,\n      delta = null, tz_hour, tz_minute, date;\n\n  match = YAML_DATE_REGEXP.exec(data);\n  if (match === null) match = YAML_TIMESTAMP_REGEXP.exec(data);\n\n  if (match === null) throw new Error('Date resolve error');\n\n  // match: [1] year [2] month [3] day\n\n  year = +(match[1]);\n  month = +(match[2]) - 1; // JS month starts with 0\n  day = +(match[3]);\n\n  if (!match[4]) { // no hour\n    return new Date(Date.UTC(year, month, day));\n  }\n\n  // match: [4] hour [5] minute [6] second [7] fraction\n\n  hour = +(match[4]);\n  minute = +(match[5]);\n  second = +(match[6]);\n\n  if (match[7]) {\n    fraction = match[7].slice(0, 3);\n    while (fraction.length < 3) { // milli-seconds\n      fraction += '0';\n    }\n    fraction = +fraction;\n  }\n\n  // match: [8] tz [9] tz_sign [10] tz_hour [11] tz_minute\n\n  if (match[9]) {\n    tz_hour = +(match[10]);\n    tz_minute = +(match[11] || 0);\n    delta = (tz_hour * 60 + tz_minute) * 60000; // delta in mili-seconds\n    if (match[9] === '-') delta = -delta;\n  }\n\n  date = new Date(Date.UTC(year, month, day, hour, minute, second, fraction));\n\n  if (delta) date.setTime(date.getTime() - delta);\n\n  return date;\n}\n\nfunction representYamlTimestamp(object /*, style*/) {\n  return object.toISOString();\n}\n\nmodule.exports = new Type('tag:yaml.org,2002:timestamp', {\n  kind: 'scalar',\n  resolve: resolveYamlTimestamp,\n  construct: constructYamlTimestamp,\n  instanceOf: Date,\n  represent: representYamlTimestamp\n});\n\n},{\"../type\":13}],\"/\":[function(require,module,exports){\n'use strict';\n\n\nvar yaml = require('./lib/js-yaml.js');\n\n\nmodule.exports = yaml;\n\n},{\"./lib/js-yaml.js\":1}]},{},[])(\"/\")\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/js-yaml/dist/js-yaml.js\n// module id = 18\n// module chunks = 0","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 68\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/setimmediate/setImmediate.js\n// module id = 19\n// module chunks = 0","var apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(window, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\nexports.setImmediate = setImmediate;\nexports.clearImmediate = clearImmediate;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/timers-browserify/main.js\n// module id = 20\n// module chunks = 0"],"sourceRoot":""}